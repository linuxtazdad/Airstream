var tolConfig=function(e){return{paramTranslation:["make","model","trim","category","type"],nicheSites:{},schemeCodes:{},getRealmId:function(){return 3},getRealmSearchTerm:function(){return"rvs-for-sale"},getRealmDealersTerm:function(){return"rv-dealers"},getOverwriteTypeId:function(){return null},getCriteoTagId:function(){return 30986},getRangeParams:function(){return{price:[{min:1e3,max:10001,increment:1e3,prepend:"$",format:!0},{min:15e3,max:50001,increment:5e3},{min:6e4,max:100001,increment:1e4},{min:125e3,max:500001,increment:25e3},{min:55e4,max:750001,increment:5e4}],mileage:[{min:0,max:5001,increment:1e3,format:!0},{min:1e4,max:25001,increment:5e3},{min:5e4,max:100001,increment:25e3}],year:[{min:1900,max:(new Date).getFullYear()+1,increment:1,reverse:!0,format:!1}],length:[{min:1,max:51,increment:1,format:!0}],grossVehicleWeight:[{min:1,max:2,increment:1e3,format:!0},{min:1e3,max:15001,increment:1e3,format:!0}],sleepingCapacity:[{min:1,max:10,increment:1,format:!0}],slideouts:[{min:0,max:5,increment:1,format:!0}]}},getRefineBlacklist:function(){return[]},typeIconPopover:function(){return{types:{"icon-classa":"Large living space, Luxurious amenities, Sleeps up to six passengers, Average between $58,000 to $400,000 new.","icon-classb":"Also called van campers, Are driven like a van, Sleeps up to four passengers, Average between $41,000 to $74,000 new.","icon-classc":"Luxurious amenities, Sleeping space over the cab, Sleeps up to eight passengers, Average between $48,000 to $140,000 new.","icon-popupcamper":"Folds for light-weight towing, outdoor camping feel with RV comfort, sleeps up to eight passengers, average between $4,000 to $13,000 new.","icon-parkmodel":"A trailer-type RV, often used for seasonal housing or recreation, some models sleep more than 11 people, average between $10,000 to $100,000 new.","icon-traveltrailer":"Many options for floor plans and sizes, affordable with comfortable amenities, sleeps up to ten passengers, average between $8,000 to $65,000 new.","icon-fifthwheel":"Two-level floor plans with plenty of room, pulled behind a pickup truck, sleeps up to six passengers, average between $13,000 to $100,000 new.","icon-toyhauler":"Built-in garage for motorcycle, ATVs, and other equipment. Affordable with comfortable amenities, sleeps up to eight passengers, average between $21,000 to $58,000 new.","icon-toyhauler-traveltrailer":"Built-in garage for motorcycle, ATVs, and other equipment. Pulled behind a towing vehicle, sleeps up to eight passengers, average between $21,000 to $58,000 new.","icon-toyhauler-fifthwheel":"Built-in garage for motorcycle, ATVs, and other equipment. Pulled behind a pickup truck, sleeps up to eight passengers, average between $21,000 to $58,000 new.","icon-truckcamper":"Can go wherever your truck can drive, mounts on a pickup bed or chassis, sleeps up to six passengers, average between $4,000 to $26,000 new."}}},autocompleteKeyword:function(){return{autopopulateLimit:10,keywordLimit:1,specialKeys:[]}},cdnDomain:"cdn.rvtrader.com",vdpSliderPromoThumb:"https://cdn0.commercialtrucktrader.com/MPAA-thumbnail.png"}}(jQuery);
var TOL=function(t){return{Module:{},Tile:{},initialized:!1,init:function(){if(!TOL.initialized){TOL.initialized=!0;for(var e=function(t){"undefined"!=typeof t[0]&&"undefined"!=typeof t[1]&&(TOL.log(t[0]+" was initialized."),"function"==typeof t[1].init&&t[1].init())},i=["Module","Tile"],o=[],n=[],a=0;a<i.length;a++){var s=TOL[i[a]];for(var r in s){var c=i[a]+"::"+r;try{switch(s[r].priority){case"first":case"1":case 1:n.unshift([c,s[r]]);break;case"last":o.push([c,s[r]]);break;default:n.push([c,s[r]])}}catch(l){console.log(r)}}}for(var d=0;d<n.length;d++)e(n[d]);for(var u=0;u<o.length;u++)e(o[u]);t(document).on("focus","input",function(){t(this).val()!=t(this).attr("defaultValue")&&"Near Me"!=t(this).val()||t(this).val("")}),t(document).on("blur","input",function(){""==t(this).val()&&t(this).val(t(this).attr("defaultValue"))}),t("img.lazy").unveil(300),TOL.cookie.set("device_detection",device_detection),t(".menu-toggle").click(function(){t(".hamburger").toggleClass("is-active");var e=t(".hamburger-text").text();t(".hamburger-text").text("More"==e?"Close":"More"),v.find(".collapse.in").collapse("hide"),t(".nav-menu ul li.arrow").removeClass("active")});var f=/Trident.*rv[ :]*11\./.test(navigator.userAgent),h="find-"+tolConfig.getRealmSearchTerm();if(f&&window.location.pathname!=="/"+h){var p=t(".contactBtns, #refine-main").offset().top,w=t(".rezDetailsHdr").offset().top,g=t("#refinePOS").offset().top;t(window).scroll(function(){t(window).scrollTop()>g?(t(".contactBtns").css({position:"fixed",top:"0px",width:"100%"}),t("#refine-main").css({position:"fixed",top:"0px",width:"330px"})):t(".contactBtns, #refine-main").css({position:"static",top:p+"px"}),t(window).scrollTop()>w?t(".rezDetailsHdr").css({position:"fixed",top:"0px",width:"987px"}):t(".rezDetailsHdr").css({position:"static",top:w+"px"})})}t(".nav-menu ul li.arrow").click(function(){t(this).hasClass("active")?t(this).removeClass("active"):(t(".nav-menu ul li.arrow").removeClass("active"),t(this).addClass("active"))}),t(".scroll-anchor").on("click",function(e){"mobile"==device_detection&&t("html, body").animate({scrollTop:t(this).offset().top-20},"slow")}),t(".nav-close-btn").click(function(){v.find(".collapse.in").collapse("hide"),t(".nav-menu ul li.arrow").removeClass("active")});var v=t("#nav-secondary");v.on("show.bs.collapse",".collapse",function(){v.find(".collapse.in").collapse("hide")})}},log:function(t){},extractTargetId:function(e,i){for(var o=t(e).attr("class").split(" "),n=arguments.length>2?arguments[2]:"-",a=0;a<o.length;a++)if(o[a].search(i)!=-1)return o[a].split(n)[1]},updateParameters:function(e){var i=window.location.href;for(var o in e){var n=e[o];if(""==t.trim(n))return;currentValue=window.location.href.match(o+"=.*?(&|$)"),newValue=o+"="+n+"&",currentValue?currentValue=currentValue[0]:(currentValue="?",newValue="?"+newValue),i=i.replace(currentValue,newValue)}window.location=i},getGet:function(t){var e=window.location.search.match(t+"=(.*?)(&|$)");if(e)return e[1]},numberFormat:function(t){t+="";for(var e=t.split("."),i=e[0],o=e.length>1?"."+e[1]:"",n=/(\d+)(\d{3})/;n.test(i);)i=i.replace(n,"$1,$2");return i+o}}}(jQuery);TOL.Module.Mask=function(t){var e,i="tolMask",o=6,n=20;return{init:function(){var a=(t(document).width(),1.25*t(document).height());e=t(document.createElement("div")),e.attr("id",i),e.css("position","fixed").css("z-index",n).css("overflow","hidden"),e.css("top","0").css("left","0"),window.location==window.parent.location?e.css("background","#000000").css("filter","alpha(opacity="+10*o+")").css("opacity",o/10):e.css("background","#FFFFFF").css("filter","alpha(opacity=80)").css("opacity",.8),e.css("width","100%").css("height",a+"px"),e.hide(),t(document.body).append(e)},show:function(){var i=(t(document).width(),1.25*t(document).height());e.css("width","100%").css("height",i+"px"),e.show()},hide:function(){e.hide()},toggle:function(){var i=(t(document).width(),1.25*t(document).height());e.css("width","100%").css("height",i+"px"),e.toggle()},isVisible:function(){return"none"!=e.css("display")}}}(jQuery),TOL.Module.ModalWindow=function(t){var e,i,o="modalWindow",n="modalWindowControl",a=!1;return{toggle:function(i){return a=!1,e.filter("#"+i).each(function(o){if(this.id==i)if("none"!=t(this).css("display"))TOL.Module.Mask.hide(),t(this).hide();else{var n=t(this).height(),s=window.location==window.parent.location?(t(window).height()-n)/4:20;t(this).css("top",t(this).scrollTop()+s+"px"),jQuery.support.boxModel?t(this).css("position","fixed"):e.css("top",t(window).scrollTop()+s+"px"),t(this).fadeIn(),TOL.Module.Mask.show(),a=!0,t(this).css("top","75px").css("left",(t(document.body).width()-t(this).width())/2+"px")}else TOL.Module.Mask.hide(),t(this).hide()}),!1},show:function(e){t("#"+e).is(":hidden")&&TOL.Module.ModalWindow.toggle(e),offset=t(document).scrollTop(),t("#"+e).css("top",offset+50+"px")},hide:function(e){t("#"+e).is(":hidden")||TOL.Module.ModalWindow.toggle(e)},hideAll:function(){TOL.Module.Mask.hide(),e.hide()},registerModalWindow:function(n){var a=t(n);a.css("position","absolute").css("z-index","100"),a.css("top","75px").css("left",(t(document.body).width()-a.width())/2+"px").css("-webkit-overflow-scrolling","touch");for(var s=document.getElementById("modalWindowsContainer").getElementsByTagName("div"),r=!1,c=0;c<s.length;c++)if(s[c].id==a.attr("id")){r=!0;break}r||i.append(a),e=i.find("div."+o)},registerModalWindowControl:function(e){if(t(e).attr("class")&&t(e).attr("class").search(n)!=-1){var i=TOL.extractTargetId(e,n);t(e).unbind("click.modalWindow").bind("click.modalWindow",function(){return TOL.Module.ModalWindow.toggle(i)})}},init:function(){t("#modalWindowsContainer").length<1?(i=t(document.createElement("div")),i.attr("id","modalWindowsContainer"),t(document.body).append(i)):i=t("#modalWindowsContainer"),t("div."+o).each(function(t){TOL.Module.ModalWindow.registerModalWindow(this)}),t("*").each(function(t){TOL.Module.ModalWindow.registerModalWindowControl(this)}),t(document).bind("keypress.modalWindow",function(e){"27"==e.keyCode&&a&&t(".modalhdrclose").is(":visible")&&TOL.Module.ModalWindow.hideAll()})}}}(jQuery),TOL.cookie=function(){return{get:function(t){for(var e=t+"=",i=document.cookie.split(";"),o=0;o<i.length;++o){for(var n=i[o];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(e))return unescape(n.substring(e.length,n.length))}},set:function(t,e,i,o){o||(o="/");var n="";if(i){var a=new Date;a.setTime(a.getTime()+24*i*60*60*1e3),n="; expires="+a.toGMTString()}document.cookie=t+"="+e+n+"; path="+o}}}(),TOL.Module.Mobile=function(t){var e=function(){i()},i=function(){return""===document.referrer?void t(".backButton").remove():void t(".backButton").click(function(){window.history.back()})},o=function(){try{var t=localStorage.history,e=5,i=location.href.replace(n(),"/"),o=[];for(t&&(o=t.split(",")),o.indexOf(i)===-1&&o.push(i);o.length>e;)o.shift();localStorage.history=o.join(",")}catch(a){try{localStorage.clear()}catch(s){}}},n=function(){var t=location.href,e=t.substring(0,t.search("//")+2);return t=t.substring(t.search("//")+2),e+t.substring(0,t.search("/")+1)};return{init:e,priority:"first",storeHref:function(){o(location.href)}}}(jQuery),TOL.Module.relocate=function(t){return{set:function(){var e=t("#navchoice").val();e.length>0&&0!=e&&(window.location=e)}}}(jQuery),TOL.Module.sendSilverPopLeadInfo=function(t){ewt.trackLink({name:t,type:"email-lead-type"});var e=new Date,i=e.getDate(),o=e.getMonth()+1,n=e.getFullYear();i<10&&(i="0"+i),o<10&&(o="0"+o),e=o+"/"+i+"/"+n,ewt.trackLink({name:e,type:"email-lead-date"})},TOL.Module.spinnerButton=function(t){function e(){t(".btn-spinner").click(function(){t(this).animate({width:"33%"},800,"easeOutExpo").html('<i class="fa fa-cog fa-spin"></i>')})}return{init:e}}(jQuery),$(document).ready(function(){TOL.init()});
!function(e,t){"use strict";function n(e,t){for(var n,i=[],o=0;o<e.length;++o){if(n=a[e[o]]||r(e[o]),!n)throw"module definition dependecy not found: "+e[o];i.push(n)}t.apply(null,i)}function i(e,i,r){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(i===t)throw"invalid module definition, dependencies must be specified";if(r===t)throw"invalid module definition, definition function must be specified";n(i,function(){a[e]=r.apply(null,arguments)})}function r(t){for(var n=e,i=t.split(/[.\/]/),r=0;r<i.length;++r){if(!n[i[r]])return;n=n[i[r]]}return n}function o(n){for(var i=0;i<n.length;i++){for(var r=e,o=n[i],s=o.split(/[.\/]/),u=0;u<s.length-1;++u)r[s[u]]===t&&(r[s[u]]={}),r=r[s[u]];r[s[s.length-1]]=a[o]}}var a={},s="moxie/core/utils/Basic",u="moxie/core/utils/Env",c="moxie/core/I18n",l="moxie/core/utils/Mime",d="moxie/core/utils/Dom",f="moxie/core/Exceptions",h="moxie/core/EventTarget",p="moxie/runtime/Runtime",m="moxie/runtime/RuntimeClient",g="moxie/file/FileInput",v="moxie/core/utils/Encode",y="moxie/file/Blob",_="moxie/file/File",w="moxie/file/FileDrop",E="moxie/file/FileReader",b="moxie/core/utils/Url",R="moxie/runtime/RuntimeTarget",x="moxie/file/FileReaderSync",A="moxie/xhr/FormData",I="moxie/xhr/XMLHttpRequest",S="moxie/runtime/Transporter",T="moxie/image/Image",O="moxie/runtime/html5/Runtime",D="moxie/core/utils/Events",N="moxie/runtime/html5/file/FileInput",C="moxie/runtime/html5/file/Blob",L="moxie/runtime/html5/file/FileDrop",M="moxie/runtime/html5/file/FileReader",F="moxie/runtime/html5/xhr/XMLHttpRequest",P="moxie/runtime/html5/utils/BinaryReader",z="moxie/runtime/html5/image/JPEGHeaders",U="moxie/runtime/html5/image/ExifParser",H="moxie/runtime/html5/image/JPEG",k="moxie/runtime/html5/image/PNG",B="moxie/runtime/html5/image/ImageInfo",q="moxie/runtime/html5/image/MegaPixel",G="moxie/runtime/html5/image/Image",j="moxie/runtime/flash/Runtime",X="moxie/runtime/flash/file/FileInput",V="moxie/runtime/flash/file/Blob",W="moxie/runtime/flash/file/FileReader",Y="moxie/runtime/flash/file/FileReaderSync",$="moxie/runtime/flash/xhr/XMLHttpRequest",J="moxie/runtime/flash/runtime/Transporter",Z="moxie/runtime/flash/image/Image",Q="moxie/runtime/silverlight/Runtime",K="moxie/runtime/silverlight/file/FileInput",ee="moxie/runtime/silverlight/file/Blob",te="moxie/runtime/silverlight/file/FileDrop",ne="moxie/runtime/silverlight/file/FileReader",ie="moxie/runtime/silverlight/file/FileReaderSync",re="moxie/runtime/silverlight/xhr/XMLHttpRequest",oe="moxie/runtime/silverlight/runtime/Transporter",ae="moxie/runtime/silverlight/image/Image",se="moxie/runtime/html4/Runtime",ue="moxie/runtime/html4/file/FileInput",ce="moxie/runtime/html4/file/FileReader",le="moxie/runtime/html4/xhr/XMLHttpRequest",de="moxie/runtime/html4/image/Image";i(s,[],function(){var e=function(e){var t;return e===t?"undefined":null===e?"null":e.nodeType?"node":{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},t=function(i){var r;return n(arguments,function(o,s){s>0&&n(o,function(n,o){n!==r&&(e(i[o])===e(n)&&~a(e(n),["array","object"])?t(i[o],n):i[o]=n)})}),i},n=function(t,n){var i,r,o;if(t)if("number"===e(t.length)){for(o=0,i=t.length;i>o;o++)if(n(t[o],o)===!1)return}else if("object"===e(t))for(r in t)if(t.hasOwnProperty(r)&&n(t[r],r)===!1)return},i=function(t){var n;if(!t||"object"!==e(t))return!0;for(n in t)return!1;return!0},r=function(t,n){function i(r){"function"===e(t[r])&&t[r](function(e){++r<o&&!e?i(r):n(e)})}var r=0,o=t.length;"function"!==e(n)&&(n=function(){}),t&&t.length||n(),i(r)},o=function(e,t){var i=0,r=e.length,o=new Array(r);n(e,function(e,n){e(function(e){if(e)return t(e);var a=[].slice.call(arguments);a.shift(),o[n]=a,i++,i===r&&(o.unshift(null),t.apply(this,o))})})},a=function(e,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n}return-1},s=function(t,n){var i=[];"array"!==e(t)&&(t=[t]),"array"!==e(n)&&(n=[n]);for(var r in t)-1===a(t[r],n)&&i.push(t[r]);return!!i.length&&i},u=function(e,t){var i=[];return n(e,function(e){-1!==a(e,t)&&i.push(e)}),i.length?i:null},c=function(e){var t,n=[];for(t=0;t<e.length;t++)n[t]=e[t];return n},l=function(){var e=0;return function(t){var n,i=(new Date).getTime().toString(32);for(n=0;5>n;n++)i+=Math.floor(65535*Math.random()).toString(32);return(t||"o_")+i+(e++).toString(32)}}(),d=function(e){return e?String.prototype.trim?String.prototype.trim.call(e):e.toString().replace(/^\s*/,"").replace(/\s*$/,""):e},f=function(e){if("string"!=typeof e)return e;var t,n={t:1099511627776,g:1073741824,m:1048576,k:1024};return e=/^([0-9\.]+)([tmgk]?)$/.exec(e.toLowerCase().replace(/[^0-9\.tmkg]/g,"")),t=e[2],e=+e[1],n.hasOwnProperty(t)&&(e*=n[t]),Math.floor(e)},h=function(t){var n=[].slice.call(arguments,1);return t.replace(/%[a-z]/g,function(){var t=n.shift();return"undefined"!==e(t)?t:""})};return{guid:l,typeOf:e,extend:t,each:n,isEmptyObj:i,inSeries:r,inParallel:o,inArray:a,arrayDiff:s,arrayIntersect:u,toArray:c,trim:d,sprintf:h,parseSizeStr:f}}),i(u,[s],function(e){function t(e,t,n){var i=0,r=0,o=0,a={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},s=function(e){return e=(""+e).replace(/[_\-+]/g,"."),e=e.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),e.length?e.split("."):[-8]},u=function(e){return e?isNaN(e)?a[e]||-7:parseInt(e,10):0};for(e=s(e),t=s(t),r=Math.max(e.length,t.length),i=0;r>i;i++)if(e[i]!=t[i]){if(e[i]=u(e[i]),t[i]=u(t[i]),e[i]<t[i]){o=-1;break}if(e[i]>t[i]){o=1;break}}if(!n)return o;switch(n){case">":case"gt":return o>0;case">=":case"ge":return o>=0;case"<=":case"le":return 0>=o;case"==":case"=":case"eq":return 0===o;case"<>":case"!=":case"ne":return 0!==o;case"":case"<":case"lt":return 0>o;default:return null}}var n=function(e){var t="",n="?",i="function",r="undefined",o="object",a="name",s="version",u={has:function(e,t){return-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()}},c={rgx:function(){for(var t,n,a,s,u,c,l,d=0,f=arguments;d<f.length;d+=2){var h=f[d],p=f[d+1];if(typeof t===r){t={};for(s in p)u=p[s],typeof u===o?t[u[0]]=e:t[u]=e}for(n=a=0;n<h.length;n++)if(c=h[n].exec(this.getUA())){for(s=0;s<p.length;s++)l=c[++a],u=p[s],typeof u===o&&u.length>0?2==u.length?typeof u[1]==i?t[u[0]]=u[1].call(this,l):t[u[0]]=u[1]:3==u.length?typeof u[1]!==i||u[1].exec&&u[1].test?t[u[0]]=l?l.replace(u[1],u[2]):e:t[u[0]]=l?u[1].call(this,l,u[2]):e:4==u.length&&(t[u[0]]=l?u[3].call(this,l.replace(u[1],u[2])):e):t[u]=l?l:e;break}if(c)break}return t},str:function(t,i){for(var r in i)if(typeof i[r]===o&&i[r].length>0){for(var a=0;a<i[r].length;a++)if(u.has(i[r][a],t))return r===n?e:r}else if(u.has(i[r],t))return r===n?e:r;return t}},l={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},d={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[a,s],[/\s(opr)\/([\w\.]+)/i],[[a,"Opera"],s],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[a,s],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[a,"IE"],s],[/(edge)\/((\d+)?[\w\.]+)/i],[a,s],[/(yabrowser)\/([\w\.]+)/i],[[a,"Yandex"],s],[/(comodo_dragon)\/([\w\.]+)/i],[[a,/_/g," "],s],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[a,s],[/(dolfin)\/([\w\.]+)/i],[[a,"Dolphin"],s],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[a,"Chrome"],s],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[s,[a,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[s,[a,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[s,[a,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[s,[a,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[s,a],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[a,[s,c.str,l.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[a,s],[/(navigator|netscape)\/([\w\.-]+)/i],[[a,"Netscape"],s],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[a,s]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[s,[a,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[a,s],[/rv\:([\w\.]+).*(gecko)/i],[s,a]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[a,s],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[a,[s,c.str,l.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[a,"Windows"],[s,c.str,l.os.windows.version]],[/\((bb)(10);/i],[[a,"BlackBerry"],s],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[a,s],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[a,"Symbian"],s],[/\((series40);/i],[a],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[a,"Firefox OS"],s],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[a,s],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[a,"Chromium OS"],s],[/(sunos)\s?([\w\.]+\d)*/i],[[a,"Solaris"],s],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[a,s],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[a,"iOS"],[s,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[a,"Mac OS"],[s,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[a,s]]},f=function(e){var n=e||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:t);this.getBrowser=function(){return c.rgx.apply(this,d.browser)},this.getEngine=function(){return c.rgx.apply(this,d.engine)},this.getOS=function(){return c.rgx.apply(this,d.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this.setUA(n)};return f}(),i=function(){var t={define_property:function(){return!1}(),create_canvas:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),return_response_type:function(t){try{if(-1!==e.inArray(t,["","text","document"]))return!0;if(window.XMLHttpRequest){var n=new XMLHttpRequest;if(n.open("get","/"),"responseType"in n)return n.responseType=t,n.responseType===t}}catch(i){}return!1},use_data_uri:function(){var e=new Image;return e.onload=function(){t.use_data_uri=1===e.width&&1===e.height},setTimeout(function(){e.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return t.use_data_uri&&("IE"!==o.browser||o.version>=9)},use_data_uri_of:function(e){return t.use_data_uri&&33e3>e||t.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;var e=document.createElement("input");return e.setAttribute("type","file"),!e.disabled}};return function(n){var i=[].slice.call(arguments);return i.shift(),"function"===e.typeOf(t[n])?t[n].apply(this,i):!!t[n]}}(),r=(new n).getResult(),o={can:i,uaParser:n,browser:r.browser.name,version:r.browser.version,os:r.os.name,osVersion:r.os.version,verComp:t,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return o.OS=o.os,o}),i(c,[s],function(e){var t={};return{addI18n:function(n){return e.extend(t,n)},translate:function(e){return t[e]||e},_:function(e){return this.translate(e)},sprintf:function(t){var n=[].slice.call(arguments,1);return t.replace(/%[a-z]/g,function(){var t=n.shift();return"undefined"!==e.typeOf(t)?t:""})}}}),i(l,[s,c],function(e,t){var n="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",i={mimes:{},extensions:{},addMimeType:function(e){var t,n,i,r=e.split(/,/);for(t=0;t<r.length;t+=2){for(i=r[t+1].split(/ /),n=0;n<i.length;n++)this.mimes[i[n]]=r[t];this.extensions[r[t]]=i}},extList2mimes:function(t,n){var i,r,o,a,s=this,u=[];for(r=0;r<t.length;r++)for(i=t[r].extensions.split(/\s*,\s*/),o=0;o<i.length;o++){if("*"===i[o])return[];if(a=s.mimes[i[o]],a&&-1===e.inArray(a,u)&&u.push(a),n&&/^\w+$/.test(i[o]))u.push("."+i[o]);else if(!a)return[]}return u},mimes2exts:function(t){var n=this,i=[];return e.each(t,function(t){if("*"===t)return i=[],!1;var r=t.match(/^(\w+)\/(\*|\w+)$/);r&&("*"===r[2]?e.each(n.extensions,function(e,t){new RegExp("^"+r[1]+"/").test(t)&&[].push.apply(i,n.extensions[t])}):n.extensions[t]&&[].push.apply(i,n.extensions[t]))}),i},mimes2extList:function(n){var i=[],r=[];return"string"===e.typeOf(n)&&(n=e.trim(n).split(/\s*,\s*/)),r=this.mimes2exts(n),i.push({title:t.translate("Files"),extensions:r.length?r.join(","):"*"}),i.mimes=n,i},getFileExtension:function(e){var t=e&&e.match(/\.([^.]+)$/);return t?t[1].toLowerCase():""},getFileMime:function(e){return this.mimes[this.getFileExtension(e)]||""}};return i.addMimeType(n),i}),i(d,[u],function(e){var t=function(e){return"string"!=typeof e?e:document.getElementById(e)},n=function(e,t){if(!e.className)return!1;var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return n.test(e.className)},i=function(e,t){n(e,t)||(e.className=e.className?e.className.replace(/\s+$/,"")+" "+t:t)},r=function(e,t){if(e.className){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(n,function(e,t,n){return" "===t&&" "===n?" ":""})}},o=function(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(e,null)[t]:void 0},a=function(t,n){function i(e){var t,n,i=0,r=0;return e&&(n=e.getBoundingClientRect(),t="CSS1Compat"===c.compatMode?c.documentElement:c.body,i=n.left+t.scrollLeft,r=n.top+t.scrollTop),{x:i,y:r}}var r,o,a,s=0,u=0,c=document;if(t=t,n=n||c.body,t&&t.getBoundingClientRect&&"IE"===e.browser&&(!c.documentMode||c.documentMode<8))return o=i(t),a=i(n),{x:o.x-a.x,y:o.y-a.y};for(r=t;r&&r!=n&&r.nodeType;)s+=r.offsetLeft||0,u+=r.offsetTop||0,r=r.offsetParent;for(r=t.parentNode;r&&r!=n&&r.nodeType;)s-=r.scrollLeft||0,u-=r.scrollTop||0,r=r.parentNode;return{x:s,y:u}},s=function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}};return{get:t,hasClass:n,addClass:i,removeClass:r,getStyle:o,getPos:a,getSize:s}}),i(f,[s],function(e){function t(e,t){var n;for(n in e)if(e[n]===t)return n;return null}return{RuntimeError:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": RuntimeError "+this.code}var i={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return e.extend(n,i),n.prototype=Error.prototype,n}(),OperationNotAllowedException:function(){function t(e){this.code=e,this.name="OperationNotAllowedException"}return e.extend(t,{NOT_ALLOWED_ERR:1}),t.prototype=Error.prototype,t}(),ImageError:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": ImageError "+this.code}var i={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};return e.extend(n,i),n.prototype=Error.prototype,n}(),FileException:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": FileException "+this.code}var i={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return e.extend(n,i),n.prototype=Error.prototype,n}(),DOMException:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": DOMException "+this.code}var i={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return e.extend(n,i),n.prototype=Error.prototype,n}(),EventException:function(){function t(e){this.code=e,this.name="EventException"}return e.extend(t,{UNSPECIFIED_EVENT_TYPE_ERR:0}),t.prototype=Error.prototype,t}()}}),i(h,[u,f,s],function(e,t,n){function i(){var e={};n.extend(this,{uid:null,init:function(){this.uid||(this.uid=n.guid("uid_"))},addEventListener:function(t,i,r,o){var a,s=this;return this.hasOwnProperty("uid")||(this.uid=n.guid("uid_")),t=n.trim(t),/\s/.test(t)?void n.each(t.split(/\s+/),function(e){s.addEventListener(e,i,r,o)}):(t=t.toLowerCase(),r=parseInt(r,10)||0,a=e[this.uid]&&e[this.uid][t]||[],a.push({fn:i,priority:r,scope:o||this}),e[this.uid]||(e[this.uid]={}),void(e[this.uid][t]=a))},hasEventListener:function(t){var n=t?e[this.uid]&&e[this.uid][t]:e[this.uid];return!!n&&n},removeEventListener:function(t,i){t=t.toLowerCase();var r,o=e[this.uid]&&e[this.uid][t];if(o){if(i){for(r=o.length-1;r>=0;r--)if(o[r].fn===i){o.splice(r,1);break}}else o=[];o.length||(delete e[this.uid][t],n.isEmptyObj(e[this.uid])&&delete e[this.uid])}},removeAllEventListeners:function(){e[this.uid]&&delete e[this.uid]},dispatchEvent:function(i){var r,o,a,s,u,c={},l=!0;if("string"!==n.typeOf(i)){if(s=i,"string"!==n.typeOf(s.type))throw new t.EventException(t.EventException.UNSPECIFIED_EVENT_TYPE_ERR);i=s.type,s.total!==u&&s.loaded!==u&&(c.total=s.total,c.loaded=s.loaded),c.async=s.async||!1}if(-1!==i.indexOf("::")?!function(e){r=e[0],i=e[1]}(i.split("::")):r=this.uid,i=i.toLowerCase(),o=e[r]&&e[r][i]){o.sort(function(e,t){return t.priority-e.priority}),a=[].slice.call(arguments),a.shift(),c.type=i,a.unshift(c);var d=[];n.each(o,function(e){a[0].target=e.scope,d.push(c.async?function(t){setTimeout(function(){t(e.fn.apply(e.scope,a)===!1)},1)}:function(t){t(e.fn.apply(e.scope,a)===!1)})}),d.length&&n.inSeries(d,function(e){l=!e})}return l},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(e){var t=this;this.bind(e.join(" "),function(e){var t="on"+e.type.toLowerCase();"function"===n.typeOf(this[t])&&this[t].apply(this,arguments)}),n.each(e,function(e){e="on"+e.toLowerCase(e),"undefined"===n.typeOf(t[e])&&(t[e]=null)})}})}return i.instance=new i,i}),i(p,[u,s,d,h],function(e,t,n,i){function r(e,i,o,s,u){var c,l=this,d=t.guid(i+"_"),f=u||"browser";e=e||{},a[d]=this,o=t.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},o),e.preferred_caps&&(f=r.getMode(s,e.preferred_caps,f)),c=function(){var e={};return{exec:function(t,n,i,r){return c[n]&&(e[t]||(e[t]={context:this,instance:new c[n]}),e[t].instance[i])?e[t].instance[i].apply(this,r):void 0},removeInstance:function(t){delete e[t]},removeAllInstances:function(){var n=this;t.each(e,function(e,i){"function"===t.typeOf(e.instance.destroy)&&e.instance.destroy.call(e.context),n.removeInstance(i)})}}}(),t.extend(this,{initialized:!1,uid:d,type:i,mode:r.getMode(s,e.required_caps,f),shimid:d+"_container",clients:0,options:e,can:function(e,n){var i=arguments[2]||o;if("string"===t.typeOf(e)&&"undefined"===t.typeOf(n)&&(e=r.parseCaps(e)),"object"===t.typeOf(e)){for(var a in e)if(!this.can(a,e[a],i))return!1;return!0}return"function"===t.typeOf(i[e])?i[e].call(this,n):n===i[e]},getShimContainer:function(){var e,i=n.get(this.shimid);return i||(e=this.options.container?n.get(this.options.container):document.body,i=document.createElement("div"),i.id=this.shimid,i.className="moxie-shim moxie-shim-"+this.type,t.extend(i.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),e.appendChild(i),e=null),i},getShim:function(){return c},shimExec:function(e,t){var n=[].slice.call(arguments,2);return l.getShim().exec.call(this,this.uid,e,t,n)},exec:function(e,t){var n=[].slice.call(arguments,2);return l[e]&&l[e][t]?l[e][t].apply(this,n):l.shimExec.apply(this,arguments)},destroy:function(){if(l){var e=n.get(this.shimid);e&&e.parentNode.removeChild(e),c&&c.removeAllInstances(),this.unbindAll(),delete a[this.uid],this.uid=null,d=l=c=e=null}}}),this.mode&&e.required_caps&&!this.can(e.required_caps)&&(this.mode=!1)}var o={},a={};return r.order="html5,flash,silverlight,html4",r.getRuntime=function(e){return!!a[e]&&a[e]},r.addConstructor=function(e,t){t.prototype=i.instance,o[e]=t},r.getConstructor=function(e){return o[e]||null},r.getInfo=function(e){var t=r.getRuntime(e);return t?{uid:t.uid,type:t.type,mode:t.mode,can:function(){return t.can.apply(t,arguments)}}:null},r.parseCaps=function(e){var n={};return"string"!==t.typeOf(e)?e||{}:(t.each(e.split(","),function(e){n[e]=!0}),n)},r.can=function(e,t){var n,i,o=r.getConstructor(e);return!!o&&(n=new o({required_caps:t}),i=n.mode,n.destroy(),!!i)},r.thatCan=function(e,t){var n=(t||r.order).split(/\s*,\s*/);for(var i in n)if(r.can(n[i],e))return n[i];return null},r.getMode=function(e,n,i){var r=null;if("undefined"===t.typeOf(i)&&(i="browser"),n&&!t.isEmptyObj(e)){if(t.each(n,function(n,i){if(e.hasOwnProperty(i)){var o=e[i](n);if("string"==typeof o&&(o=[o]),r){if(!(r=t.arrayIntersect(r,o)))return r=!1}else r=o}}),r)return-1!==t.inArray(i,r)?i:r[0];if(r===!1)return!1}return i},r.capTrue=function(){return!0},r.capFalse=function(){return!1},r.capTest=function(e){return function(){return!!e}},r}),i(m,[u,f,s,p],function(e,t,n,i){return function(){var e;n.extend(this,{connectRuntime:function(r){function o(n){var a,u;return n.length?(a=n.shift().toLowerCase(),(u=i.getConstructor(a))?(e=new u(r),e.bind("Init",function(){e.initialized=!0,setTimeout(function(){e.clients++,s.trigger("RuntimeInit",e)},1)}),e.bind("Error",function(){e.destroy(),o(n)}),e.mode?void e.init():void e.trigger("Error")):void o(n)):(s.trigger("RuntimeError",new t.RuntimeError(t.RuntimeError.NOT_INIT_ERR)),void(e=null))}var a,s=this;if("string"===n.typeOf(r)?a=r:"string"===n.typeOf(r.ruid)&&(a=r.ruid),a){if(e=i.getRuntime(a))return e.clients++,e;throw new t.RuntimeError(t.RuntimeError.NOT_INIT_ERR)}o((r.runtime_order||i.order).split(/\s*,\s*/))},disconnectRuntime:function(){e&&--e.clients<=0&&e.destroy(),e=null},getRuntime:function(){return e&&e.uid?e:e=null},exec:function(){return e?e.exec.apply(this,arguments):null}})}}),i(g,[s,u,l,d,f,h,c,p,m],function(e,t,n,i,r,o,a,s,u){function c(t){var o,c,d,f=this;if(-1!==e.inArray(e.typeOf(t),["string","node"])&&(t={browse_button:t}),c=i.get(t.browse_button),!c)throw new r.DOMException(r.DOMException.NOT_FOUND_ERR);d={accept:[{title:a.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:c.parentNode||document.body},t=e.extend({},d,t),"string"==typeof t.required_caps&&(t.required_caps=s.parseCaps(t.required_caps)),"string"==typeof t.accept&&(t.accept=n.mimes2extList(t.accept)),o=i.get(t.container),o||(o=document.body),"static"===i.getStyle(o,"position")&&(o.style.position="relative"),o=c=null,u.call(f),e.extend(f,{uid:e.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){f.bind("RuntimeInit",function(n,r){f.ruid=r.uid,f.shimid=r.shimid,f.bind("Ready",function(){f.trigger("Refresh")},999),f.bind("Refresh",function(){var n,o,a,s;a=i.get(t.browse_button),s=i.get(r.shimid),a&&(n=i.getPos(a,i.get(t.container)),o=i.getSize(a),s&&e.extend(s.style,{top:n.y+"px",left:n.x+"px",width:o.w+"px",height:o.h+"px"})),s=a=null}),r.exec.call(f,"FileInput","init",t)}),f.connectRuntime(e.extend({},t,{required_caps:{select_file:!0}}))},disable:function(t){var n=this.getRuntime();n&&n.exec.call(this,"FileInput","disable","undefined"===e.typeOf(t)||t)},refresh:function(){f.trigger("Refresh")},destroy:function(){var t=this.getRuntime();t&&(t.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===e.typeOf(this.files)&&e.each(this.files,function(e){e.destroy()}),this.files=null,this.unbindAll()}}),this.handleEventProps(l)}var l=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return c.prototype=o.instance,c}),i(v,[],function(){var e=function(e){return unescape(encodeURIComponent(e))},t=function(e){return decodeURIComponent(escape(e))},n=function(e,n){if("function"==typeof window.atob)return n?t(window.atob(e)):window.atob(e);var i,r,o,a,s,u,c,l,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0,h=0,p="",m=[];if(!e)return e;e+="";do a=d.indexOf(e.charAt(f++)),s=d.indexOf(e.charAt(f++)),u=d.indexOf(e.charAt(f++)),c=d.indexOf(e.charAt(f++)),l=a<<18|s<<12|u<<6|c,i=l>>16&255,r=l>>8&255,o=255&l,64==u?m[h++]=String.fromCharCode(i):64==c?m[h++]=String.fromCharCode(i,r):m[h++]=String.fromCharCode(i,r,o);while(f<e.length);return p=m.join(""),n?t(p):p},i=function(t,n){if(n&&(t=e(t)),"function"==typeof window.btoa)return window.btoa(t);var i,r,o,a,s,u,c,l,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0,h=0,p="",m=[];if(!t)return t;do i=t.charCodeAt(f++),r=t.charCodeAt(f++),o=t.charCodeAt(f++),l=i<<16|r<<8|o,a=l>>18&63,s=l>>12&63,u=l>>6&63,c=63&l,m[h++]=d.charAt(a)+d.charAt(s)+d.charAt(u)+d.charAt(c);while(f<t.length);p=m.join("");var g=t.length%3;return(g?p.slice(0,g-3):p)+"===".slice(g||3)};return{utf8_encode:e,utf8_decode:t,atob:n,btoa:i}}),i(y,[s,v,m],function(e,t,n){function i(o,a){function s(t,n,o){var a,s=r[this.uid];return"string"===e.typeOf(s)&&s.length?(a=new i(null,{type:o,size:n-t}),a.detach(s.substr(t,a.size)),a):null}n.call(this),o&&this.connectRuntime(o),a?"string"===e.typeOf(a)&&(a={data:a}):a={},e.extend(this,{uid:a.uid||e.guid("uid_"),ruid:o,size:a.size||0,type:a.type||"",slice:function(e,t,n){return this.isDetached()?s.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),e,t,n)},getSource:function(){return r[this.uid]?r[this.uid]:null},detach:function(e){if(this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),e=e||"","data:"==e.substr(0,5)){var n=e.indexOf(";base64,");this.type=e.substring(5,n),e=t.atob(e.substring(n+8))}this.size=e.length,r[this.uid]=e},isDetached:function(){return!this.ruid&&"string"===e.typeOf(r[this.uid])},destroy:function(){this.detach(),delete r[this.uid]}}),a.data?this.detach(a.data):r[this.uid]=a}var r={};return i}),i(_,[s,l,y],function(e,t,n){function i(i,r){r||(r={}),n.apply(this,arguments),this.type||(this.type=t.getFileMime(r.name));var o;if(r.name)o=r.name.replace(/\\/g,"/"),o=o.substr(o.lastIndexOf("/")+1);else if(this.type){var a=this.type.split("/")[0];o=e.guid((""!==a?a:"file")+"_"),t.extensions[this.type]&&(o+="."+t.extensions[this.type][0])}e.extend(this,{name:o||e.guid("file_"),relativePath:"",lastModifiedDate:r.lastModifiedDate||(new Date).toLocaleString()})}return i.prototype=n.prototype,i}),i(w,[c,d,f,s,u,_,m,h,l],function(e,t,n,i,r,o,a,s,u){function c(n){var r,o=this;"string"==typeof n&&(n={drop_zone:n}),r={accept:[{title:e.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},n="object"==typeof n?i.extend({},r,n):r,n.container=t.get(n.drop_zone)||document.body,"static"===t.getStyle(n.container,"position")&&(n.container.style.position="relative"),"string"==typeof n.accept&&(n.accept=u.mimes2extList(n.accept)),a.call(o),i.extend(o,{uid:i.guid("uid_"),ruid:null,files:null,init:function(){o.bind("RuntimeInit",function(e,t){o.ruid=t.uid,t.exec.call(o,"FileDrop","init",n),o.dispatchEvent("ready")}),o.connectRuntime(n)},destroy:function(){var e=this.getRuntime();e&&(e.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null,this.unbindAll()}}),this.handleEventProps(l)}var l=["ready","dragenter","dragleave","drop","error"];return c.prototype=s.instance,c}),i(E,[s,v,f,h,y,m],function(e,t,n,i,r,o){function a(){function i(e,i){if(this.trigger("loadstart"),this.readyState===a.LOADING)return this.trigger("error",new n.DOMException(n.DOMException.INVALID_STATE_ERR)),void this.trigger("loadend");if(!(i instanceof r))return this.trigger("error",new n.DOMException(n.DOMException.NOT_FOUND_ERR)),void this.trigger("loadend");if(this.result=null,this.readyState=a.LOADING,i.isDetached()){var o=i.getSource();switch(e){case"readAsText":case"readAsBinaryString":this.result=o;break;case"readAsDataURL":this.result="data:"+i.type+";base64,"+t.btoa(o)}this.readyState=a.DONE,this.trigger("load"),this.trigger("loadend")}else this.connectRuntime(i.ruid),this.exec("FileReader","read",e,i)}o.call(this),e.extend(this,{uid:e.guid("uid_"),readyState:a.EMPTY,result:null,error:null,readAsBinaryString:function(e){i.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){i.call(this,"readAsDataURL",e)},readAsText:function(e){i.call(this,"readAsText",e)},abort:function(){this.result=null,-1===e.inArray(this.readyState,[a.EMPTY,a.DONE])&&(this.readyState===a.LOADING&&(this.readyState=a.DONE),
this.exec("FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),this.exec("FileReader","destroy"),this.disconnectRuntime(),this.unbindAll()}}),this.handleEventProps(s),this.bind("Error",function(e,t){this.readyState=a.DONE,this.error=t},999),this.bind("Load",function(e){this.readyState=a.DONE},999)}var s=["loadstart","progress","load","abort","error","loadend"];return a.EMPTY=0,a.LOADING=1,a.DONE=2,a.prototype=i.instance,a}),i(b,[],function(){var e=function(t,n){for(var i=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],r=i.length,o={http:80,https:443},a={},s=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,u=s.exec(t||"");r--;)u[r]&&(a[i[r]]=u[r]);if(!a.scheme){n&&"string"!=typeof n||(n=e(n||document.location.href)),a.scheme=n.scheme,a.host=n.host,a.port=n.port;var c="";/^[^\/]/.test(a.path)&&(c=n.path,c=/\/[^\/]*\.[^\/]*$/.test(c)?c.replace(/\/[^\/]+$/,"/"):c.replace(/\/?$/,"/")),a.path=c+(a.path||"")}return a.port||(a.port=o[a.scheme]||80),a.port=parseInt(a.port,10),a.path||(a.path="/"),delete a.source,a},t=function(t){var n={http:80,https:443},i="object"==typeof t?t:e(t);return i.scheme+"://"+i.host+(i.port!==n[i.scheme]?":"+i.port:"")+i.path+(i.query?i.query:"")},n=function(t){function n(e){return[e.scheme,e.host,e.port].join("/")}return"string"==typeof t&&(t=e(t)),n(e())===n(t)};return{parseUrl:e,resolveUrl:t,hasSameOrigin:n}}),i(R,[s,m,h],function(e,t,n){function i(){this.uid=e.guid("uid_"),t.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return i.prototype=n.instance,i}),i(x,[s,m,v],function(e,t,n){return function(){function i(e,t){if(!t.isDetached()){var i=this.connectRuntime(t.ruid).exec.call(this,"FileReaderSync","read",e,t);return this.disconnectRuntime(),i}var r=t.getSource();switch(e){case"readAsBinaryString":return r;case"readAsDataURL":return"data:"+t.type+";base64,"+n.btoa(r);case"readAsText":for(var o="",a=0,s=r.length;s>a;a++)o+=String.fromCharCode(r[a]);return o}}t.call(this),e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function(e){return i.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){return i.call(this,"readAsDataURL",e)},readAsText:function(e){return i.call(this,"readAsText",e)}})}}),i(A,[f,s,y],function(e,t,n){function i(){var e,i=[];t.extend(this,{append:function(r,o){var a=this,s=t.typeOf(o);o instanceof n?e={name:r,value:o}:"array"===s?(r+="[]",t.each(o,function(e){a.append(r,e)})):"object"===s?t.each(o,function(e,t){a.append(r+"["+t+"]",e)}):"null"===s||"undefined"===s||"number"===s&&isNaN(o)?a.append(r,"false"):i.push({name:r,value:o.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return e&&e.value||null},getBlobName:function(){return e&&e.name||null},each:function(n){t.each(i,function(e){n(e.value,e.name)}),e&&n(e.value,e.name)},destroy:function(){e=null,i=[]}})}return i}),i(I,[s,f,h,v,b,p,R,y,x,A,u,l],function(e,t,n,i,r,o,a,s,u,c,l,d){function f(){this.uid=e.guid("uid_")}function h(){function n(e,t){return I.hasOwnProperty(e)?1===arguments.length?l.can("define_property")?I[e]:A[e]:void(l.can("define_property")?I[e]=t:A[e]=t):void 0}function u(t){function i(){R&&(R.destroy(),R=null),s.dispatchEvent("loadend"),s=null}function r(r){R.bind("LoadStart",function(e){n("readyState",h.LOADING),s.dispatchEvent("readystatechange"),s.dispatchEvent(e),L&&s.upload.dispatchEvent(e)}),R.bind("Progress",function(e){n("readyState")!==h.LOADING&&(n("readyState",h.LOADING),s.dispatchEvent("readystatechange")),s.dispatchEvent(e)}),R.bind("UploadProgress",function(e){L&&s.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:e.total,loaded:e.loaded})}),R.bind("Load",function(t){n("readyState",h.DONE),n("status",Number(r.exec.call(R,"XMLHttpRequest","getStatus")||0)),n("statusText",p[n("status")]||""),n("response",r.exec.call(R,"XMLHttpRequest","getResponse",n("responseType"))),~e.inArray(n("responseType"),["text",""])?n("responseText",n("response")):"document"===n("responseType")&&n("responseXML",n("response")),k=r.exec.call(R,"XMLHttpRequest","getAllResponseHeaders"),s.dispatchEvent("readystatechange"),n("status")>0?(L&&s.upload.dispatchEvent(t),s.dispatchEvent(t)):(F=!0,s.dispatchEvent("error")),i()}),R.bind("Abort",function(e){s.dispatchEvent(e),i()}),R.bind("Error",function(e){F=!0,n("readyState",h.DONE),s.dispatchEvent("readystatechange"),M=!0,s.dispatchEvent(e),i()}),r.exec.call(R,"XMLHttpRequest","send",{url:v,method:y,async:S,user:_,password:w,headers:T,mimeType:D,encoding:O,responseType:s.responseType,withCredentials:s.withCredentials,options:H},t)}var s=this;E=(new Date).getTime(),R=new a,"string"==typeof H.required_caps&&(H.required_caps=o.parseCaps(H.required_caps)),H.required_caps=e.extend({},H.required_caps,{return_response_type:s.responseType}),t instanceof c&&(H.required_caps.send_multipart=!0),e.isEmptyObj(T)||(H.required_caps.send_custom_headers=!0),P||(H.required_caps.do_cors=!0),H.ruid?r(R.connectRuntime(H)):(R.bind("RuntimeInit",function(e,t){r(t)}),R.bind("RuntimeError",function(e,t){s.dispatchEvent("RuntimeError",t)}),R.connectRuntime(H))}function g(){n("responseText",""),n("responseXML",null),n("response",null),n("status",0),n("statusText",""),E=b=null}var v,y,_,w,E,b,R,x,A=this,I={timeout:0,readyState:h.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},S=!0,T={},O=null,D=null,N=!1,C=!1,L=!1,M=!1,F=!1,P=!1,z=null,U=null,H={},k="";e.extend(this,I,{uid:e.guid("uid_"),upload:new f,open:function(o,a,s,u,c){var l;if(!o||!a)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(o)||i.utf8_encode(o)!==o)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(~e.inArray(o.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(y=o.toUpperCase()),~e.inArray(y,["CONNECT","TRACE","TRACK"]))throw new t.DOMException(t.DOMException.SECURITY_ERR);if(a=i.utf8_encode(a),l=r.parseUrl(a),P=r.hasSameOrigin(l),v=r.resolveUrl(a),(u||c)&&!P)throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);if(_=u||l.user,w=c||l.pass,S=s||!0,S===!1&&(n("timeout")||n("withCredentials")||""!==n("responseType")))throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);N=!S,C=!1,T={},g.call(this),n("readyState",h.OPENED),this.dispatchEvent("readystatechange")},setRequestHeader:function(r,o){var a=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(n("readyState")!==h.OPENED||C)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(r)||i.utf8_encode(r)!==r)throw new t.DOMException(t.DOMException.SYNTAX_ERR);return r=e.trim(r).toLowerCase(),!~e.inArray(r,a)&&!/^(proxy\-|sec\-)/.test(r)&&(T[r]?T[r]+=", "+o:T[r]=o,!0)},getAllResponseHeaders:function(){return k||""},getResponseHeader:function(t){return t=t.toLowerCase(),F||~e.inArray(t,["set-cookie","set-cookie2"])?null:k&&""!==k&&(x||(x={},e.each(k.split(/\r\n/),function(t){var n=t.split(/:\s+/);2===n.length&&(n[0]=e.trim(n[0]),x[n[0].toLowerCase()]={header:n[0],value:e.trim(n[1])})})),x.hasOwnProperty(t))?x[t].header+": "+x[t].value:null},overrideMimeType:function(i){var r,o;if(~e.inArray(n("readyState"),[h.LOADING,h.DONE]))throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(i=e.trim(i.toLowerCase()),/;/.test(i)&&(r=i.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(i=r[1],r[2]&&(o=r[2])),!d.mimes[i])throw new t.DOMException(t.DOMException.SYNTAX_ERR);z=i,U=o},send:function(n,r){if(H="string"===e.typeOf(r)?{ruid:r}:r?r:{},this.readyState!==h.OPENED||C)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(n instanceof s)H.ruid=n.ruid,D=n.type||"application/octet-stream";else if(n instanceof c){if(n.hasBlob()){var o=n.getBlob();H.ruid=o.ruid,D=o.type||"application/octet-stream"}}else"string"==typeof n&&(O="UTF-8",D="text/plain;charset=UTF-8",n=i.utf8_encode(n));this.withCredentials||(this.withCredentials=H.required_caps&&H.required_caps.send_browser_cookies&&!P),L=!N&&this.upload.hasEventListener(),F=!1,M=!n,N||(C=!0),u.call(this,n)},abort:function(){if(F=!0,N=!1,~e.inArray(n("readyState"),[h.UNSENT,h.OPENED,h.DONE]))n("readyState",h.UNSENT);else{if(n("readyState",h.DONE),C=!1,!R)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);R.getRuntime().exec.call(R,"XMLHttpRequest","abort",M),M=!0}},destroy:function(){R&&("function"===e.typeOf(R.destroy)&&R.destroy(),R=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}}),this.handleEventProps(m.concat(["readystatechange"])),this.upload.handleEventProps(m)}var p={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};f.prototype=n.instance;var m=["loadstart","progress","abort","error","load","timeout","loadend"];return h.UNSENT=0,h.OPENED=1,h.HEADERS_RECEIVED=2,h.LOADING=3,h.DONE=4,h.prototype=n.instance,h}),i(S,[s,v,m,h],function(e,t,n,i){function r(){function i(){l=d=0,c=this.result=null}function o(t,n){var i=this;u=n,i.bind("TransportingProgress",function(t){d=t.loaded,l>d&&-1===e.inArray(i.state,[r.IDLE,r.DONE])&&a.call(i)},999),i.bind("TransportingComplete",function(){d=l,i.state=r.DONE,c=null,i.result=u.exec.call(i,"Transporter","getAsBlob",t||"")},999),i.state=r.BUSY,i.trigger("TransportingStarted"),a.call(i)}function a(){var e,n=this,i=l-d;f>i&&(f=i),e=t.btoa(c.substr(d,f)),u.exec.call(n,"Transporter","receive",e,l)}var s,u,c,l,d,f;n.call(this),e.extend(this,{uid:e.guid("uid_"),state:r.IDLE,result:null,transport:function(t,n,r){var a=this;if(r=e.extend({chunk_size:204798},r),(s=r.chunk_size%3)&&(r.chunk_size+=3-s),f=r.chunk_size,i.call(this),c=t,l=t.length,"string"===e.typeOf(r)||r.ruid)o.call(a,n,this.connectRuntime(r));else{var u=function(e,t){a.unbind("RuntimeInit",u),o.call(a,n,t)};this.bind("RuntimeInit",u),this.connectRuntime(r)}},abort:function(){var e=this;e.state=r.IDLE,u&&(u.exec.call(e,"Transporter","clear"),e.trigger("TransportingAborted")),i.call(e)},destroy:function(){this.unbindAll(),u=null,this.disconnectRuntime(),i.call(this)}})}return r.IDLE=0,r.BUSY=1,r.DONE=2,r.prototype=i.instance,r}),i(T,[s,d,f,x,I,p,m,S,u,h,y,_,v],function(e,t,n,i,r,o,a,s,u,c,l,d,f){function h(){function i(e){e||(e=this.exec("Image","getInfo")),this.size=e.size,this.width=e.width,this.height=e.height,this.type=e.type,this.meta=e.meta,""===this.name&&(this.name=e.name)}function c(t){var i=e.typeOf(t);try{if(t instanceof h){if(!t.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);m.apply(this,arguments)}else if(t instanceof l){if(!~e.inArray(t.type,["image/jpeg","image/png"]))throw new n.ImageError(n.ImageError.WRONG_FORMAT);g.apply(this,arguments)}else if(-1!==e.inArray(i,["blob","file"]))c.call(this,new d(null,t),arguments[1]);else if("string"===i)"data:"===t.substr(0,5)?c.call(this,new l(null,{data:t}),arguments[1]):v.apply(this,arguments);else{if("node"!==i||"img"!==t.nodeName.toLowerCase())throw new n.DOMException(n.DOMException.TYPE_MISMATCH_ERR);c.call(this,t.src,arguments[1])}}catch(r){this.trigger("error",r.code)}}function m(t,n){var i=this.connectRuntime(t.ruid);this.ruid=i.uid,i.exec.call(this,"Image","loadFromImage",t,"undefined"===e.typeOf(n)||n)}function g(t,n){function i(e){r.ruid=e.uid,e.exec.call(r,"Image","loadFromBlob",t)}var r=this;r.name=t.name||"",t.isDetached()?(this.bind("RuntimeInit",function(e,t){i(t)}),n&&"string"==typeof n.required_caps&&(n.required_caps=o.parseCaps(n.required_caps)),this.connectRuntime(e.extend({required_caps:{access_image_binary:!0,resize_image:!0}},n))):i(this.connectRuntime(t.ruid))}function v(e,t){var n,i=this;n=new r,n.open("get",e),n.responseType="blob",n.onprogress=function(e){i.trigger(e)},n.onload=function(){g.call(i,n.response,!0)},n.onerror=function(e){i.trigger(e)},n.onloadend=function(){n.destroy()},n.bind("RuntimeError",function(e,t){i.trigger("RuntimeError",t)}),n.send(null,t)}a.call(this),e.extend(this,{uid:e.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){c.apply(this,arguments)},downsize:function(t){var i={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,preserveHeaders:!0,resample:!1};t="object"==typeof t?e.extend(i,t):e.extend(i,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]});try{if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);if(this.width>h.MAX_RESIZE_WIDTH||this.height>h.MAX_RESIZE_HEIGHT)throw new n.ImageError(n.ImageError.MAX_RESOLUTION_ERR);this.exec("Image","downsize",t.width,t.height,t.crop,t.preserveHeaders)}catch(r){this.trigger("error",r.code)}},crop:function(e,t,n){this.downsize(e,t,!0,n)},getAsCanvas:function(){if(!u.can("create_canvas"))throw new n.RuntimeError(n.RuntimeError.NOT_SUPPORTED_ERR);var e=this.connectRuntime(this.ruid);return e.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(e,t){if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsBlob",e||"image/jpeg",t||90)},getAsDataURL:function(e,t){if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsDataURL",e||"image/jpeg",t||90)},getAsBinaryString:function(e,t){var n=this.getAsDataURL(e,t);return f.atob(n.substring(n.indexOf("base64,")+7))},embed:function(i,r){function o(t,r){var o=this;if(u.can("create_canvas")){var l=o.getAsCanvas();if(l)return i.appendChild(l),l=null,o.destroy(),void c.trigger("embedded")}var d=o.getAsDataURL(t,r);if(!d)throw new n.ImageError(n.ImageError.WRONG_FORMAT);if(u.can("use_data_uri_of",d.length))i.innerHTML='<img src="'+d+'" width="'+o.width+'" height="'+o.height+'" />',o.destroy(),c.trigger("embedded");else{var h=new s;h.bind("TransportingComplete",function(){a=c.connectRuntime(this.result.ruid),c.bind("Embedded",function(){e.extend(a.getShimContainer().style,{top:"0px",left:"0px",width:o.width+"px",height:o.height+"px"}),a=null},999),a.exec.call(c,"ImageView","display",this.result.uid,width,height),o.destroy()}),h.transport(f.atob(d.substring(d.indexOf("base64,")+7)),t,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:i})}}var a,c=this;r=e.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90},r||{});try{if(!(i=t.get(i)))throw new n.DOMException(n.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);this.width>h.MAX_RESIZE_WIDTH||this.height>h.MAX_RESIZE_HEIGHT;var l=new h;return l.bind("Resize",function(){o.call(this,r.type,r.quality)}),l.bind("Load",function(){l.downsize(r)}),this.meta.thumb&&this.meta.thumb.width>=r.width&&this.meta.thumb.height>=r.height?l.load(this.meta.thumb.data):l.clone(this,!1),l}catch(d){this.trigger("error",d.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}}),this.handleEventProps(p),this.bind("Load Resize",function(){i.call(this)},999)}var p=["progress","load","error","resize","embedded"];return h.MAX_RESIZE_WIDTH=8192,h.MAX_RESIZE_HEIGHT=8192,h.prototype=c.instance,h}),i(O,[s,f,p,u],function(e,t,n,i){function r(t){var r=this,s=n.capTest,u=n.capTrue,c=e.extend({access_binary:s(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return r.can("access_binary")&&!!a.Image},display_media:s(i.can("create_canvas")||i.can("use_data_uri_over32kb")),do_cors:s(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:s(function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&("IE"!==i.browser||i.verComp(i.version,9,">"))}()),filter_by_extension:s(function(){return"Chrome"===i.browser&&i.verComp(i.version,28,">=")||"IE"===i.browser&&i.verComp(i.version,10,">=")||"Safari"===i.browser&&i.verComp(i.version,7,">=")}()),return_response_headers:u,return_response_type:function(e){return!("json"!==e||!window.JSON)||i.can("return_response_type",e)},return_status_code:u,report_upload_progress:s(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return r.can("access_binary")&&i.can("create_canvas")},select_file:function(){return i.can("use_fileinput")&&window.File},select_folder:function(){return r.can("select_file")&&"Chrome"===i.browser&&i.verComp(i.version,21,">=")},select_multiple:function(){return!(!r.can("select_file")||"Safari"===i.browser&&"Windows"===i.os||"iOS"===i.os&&i.verComp(i.osVersion,"7.0.0",">")&&i.verComp(i.osVersion,"8.0.0","<"))},send_binary_string:s(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:s(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||r.can("send_binary_string")},slice_blob:s(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return r.can("slice_blob")&&r.can("send_multipart")},summon_file_dialog:function(){return r.can("select_file")&&("Firefox"===i.browser&&i.verComp(i.version,4,">=")||"Opera"===i.browser&&i.verComp(i.version,12,">=")||"IE"===i.browser&&i.verComp(i.version,10,">=")||!!~e.inArray(i.browser,["Chrome","Safari"]))},upload_filesize:u},arguments[2]);n.call(this,t,arguments[1]||o,c),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(r),e=r=null}}(this.destroy)}),e.extend(this.getShim(),a)}var o="html5",a={};return n.addConstructor(o,r),a}),i(D,[s],function(e){function t(){this.returnValue=!1}function n(){this.cancelBubble=!0}var i={},r="moxie_"+e.guid(),o=function(o,a,s,u){var c,l;a=a.toLowerCase(),o.addEventListener?(c=s,o.addEventListener(a,c,!1)):o.attachEvent&&(c=function(){var e=window.event;e.target||(e.target=e.srcElement),e.preventDefault=t,e.stopPropagation=n,s(e)},o.attachEvent("on"+a,c)),o[r]||(o[r]=e.guid()),i.hasOwnProperty(o[r])||(i[o[r]]={}),l=i[o[r]],l.hasOwnProperty(a)||(l[a]=[]),l[a].push({func:c,orig:s,key:u})},a=function(t,n,o){var a,s;if(n=n.toLowerCase(),t[r]&&i[t[r]]&&i[t[r]][n]){a=i[t[r]][n];for(var u=a.length-1;u>=0&&(a[u].orig!==o&&a[u].key!==o||(t.removeEventListener?t.removeEventListener(n,a[u].func,!1):t.detachEvent&&t.detachEvent("on"+n,a[u].func),a[u].orig=null,a[u].func=null,a.splice(u,1),o===s));u--);if(a.length||delete i[t[r]][n],e.isEmptyObj(i[t[r]])){delete i[t[r]];try{delete t[r]}catch(c){t[r]=s}}}},s=function(t,n){t&&t[r]&&e.each(i[t[r]],function(e,i){a(t,i,n)})};return{addEvent:o,removeEvent:a,removeAllEvents:s}}),i(N,[O,_,s,d,D,l,u],function(e,t,n,i,r,o,a){function s(){var e;n.extend(this,{init:function(s){var u,c,l,d,f,h,p=this,m=p.getRuntime();e=s,l=e.accept.mimes||o.extList2mimes(e.accept,m.can("filter_by_extension")),c=m.getShimContainer(),c.innerHTML='<input id="'+m.uid+'" type="file" style="font-size:999px;opacity:0;"'+(e.multiple&&m.can("select_multiple")?"multiple":"")+(e.directory&&m.can("select_folder")?"webkitdirectory directory":"")+(l?' accept="'+l.join(",")+'"':"")+" />",u=i.get(m.uid),n.extend(u.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),d=i.get(e.browse_button),m.can("summon_file_dialog")&&("static"===i.getStyle(d,"position")&&(d.style.position="relative"),f=parseInt(i.getStyle(d,"z-index"),10)||1,d.style.zIndex=f,c.style.zIndex=f-1,r.addEvent(d,"click",function(e){var t=i.get(m.uid);t&&!t.disabled&&t.click(),e.preventDefault()},p.uid)),h=m.can("summon_file_dialog")?d:c,r.addEvent(h,"mouseover",function(){p.trigger("mouseenter")},p.uid),r.addEvent(h,"mouseout",function(){p.trigger("mouseleave")},p.uid),r.addEvent(h,"mousedown",function(){p.trigger("mousedown")},p.uid),r.addEvent(i.get(e.container),"mouseup",function(){p.trigger("mouseup")},p.uid),u.onchange=function g(i){if(p.files=[],n.each(this.files,function(n){var i="";return!(!e.directory||"."!=n.name)||(n.webkitRelativePath&&(i="/"+n.webkitRelativePath.replace(/^\//,"")),n=new t(m.uid,n),n.relativePath=i,void p.files.push(n))}),"IE"!==a.browser&&"IEMobile"!==a.browser)this.value="";else{var r=this.cloneNode(!0);this.parentNode.replaceChild(r,this),r.onchange=g}p.files.length&&p.trigger("change")},p.trigger({type:"ready",async:!0}),c=null},disable:function(e){var t,n=this.getRuntime();(t=i.get(n.uid))&&(t.disabled=!!e)},destroy:function(){var t=this.getRuntime(),n=t.getShim(),o=t.getShimContainer();r.removeAllEvents(o,this.uid),r.removeAllEvents(e&&i.get(e.container),this.uid),r.removeAllEvents(e&&i.get(e.browse_button),this.uid),o&&(o.innerHTML=""),n.removeInstance(this.uid),e=o=n=null}})}return e.FileInput=s}),i(C,[O,y],function(e,t){function n(){function e(e,t,n){var i;if(!window.File.prototype.slice)return(i=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?i.call(e,t,n):null;try{return e.slice(),e.slice(t,n)}catch(r){return e.slice(t,n-t)}}this.slice=function(){return new t(this.getRuntime().uid,e.apply(this,arguments))}}return e.Blob=n}),i(L,[O,_,s,d,D,l],function(e,t,n,i,r,o){function a(){function e(e){if(!e.dataTransfer||!e.dataTransfer.types)return!1;var t=n.toArray(e.dataTransfer.types||[]);return-1!==n.inArray("Files",t)||-1!==n.inArray("public.file-url",t)||-1!==n.inArray("application/x-moz-file",t)}function a(e,n){if(u(e)){var i=new t(p,e);i.relativePath=n||"",m.push(i)}}function s(e){for(var t=[],i=0;i<e.length;i++)[].push.apply(t,e[i].extensions.split(/\s*,\s*/));return-1===n.inArray("*",t)?t:[]}function u(e){if(!g.length)return!0;var t=o.getFileExtension(e.name);return!t||-1!==n.inArray(t,g)}function c(e,t){var i=[];n.each(e,function(e){var t=e.webkitGetAsEntry();t&&(t.isFile?a(e.getAsFile(),t.fullPath):i.push(t))}),i.length?l(i,t):t()}function l(e,t){var i=[];n.each(e,function(e){i.push(function(t){d(e,t)})}),n.inSeries(i,function(){t()})}function d(e,t){e.isFile?e.file(function(n){a(n,e.fullPath),t()},function(){t()}):e.isDirectory?f(e,t):t()}function f(e,t){function n(e){r.readEntries(function(t){t.length?([].push.apply(i,t),n(e)):e()},e)}var i=[],r=e.createReader();n(function(){l(i,t)})}var h,p,m=[],g=[];n.extend(this,{init:function(t){var i,o=this;h=t,p=o.ruid,g=s(h.accept),i=h.container,r.addEvent(i,"dragover",function(t){e(t)&&(t.preventDefault(),t.dataTransfer.dropEffect="copy")},o.uid),r.addEvent(i,"drop",function(t){e(t)&&(t.preventDefault(),m=[],t.dataTransfer.items&&t.dataTransfer.items[0].webkitGetAsEntry?c(t.dataTransfer.items,function(){o.files=m,o.trigger("drop")}):(n.each(t.dataTransfer.files,function(e){a(e)}),o.files=m,o.trigger("drop")))},o.uid),r.addEvent(i,"dragenter",function(e){o.trigger("dragenter")},o.uid),r.addEvent(i,"dragleave",function(e){o.trigger("dragleave")},o.uid)},destroy:function(){r.removeAllEvents(h&&i.get(h.container),this.uid),p=m=g=h=null}})}return e.FileDrop=a}),i(M,[O,v,s],function(e,t,n){function i(){function e(e){return t.atob(e.substring(e.indexOf("base64,")+7))}var i,r=!1;n.extend(this,{read:function(t,o){var a=this;a.result="",i=new window.FileReader,i.addEventListener("progress",function(e){a.trigger(e)}),i.addEventListener("load",function(t){a.result=r?e(i.result):i.result,a.trigger(t)}),i.addEventListener("error",function(e){a.trigger(e,i.error)}),i.addEventListener("loadend",function(e){i=null,a.trigger(e)}),"function"===n.typeOf(i[t])?(r=!1,i[t](o.getSource())):"readAsBinaryString"===t&&(r=!0,i.readAsDataURL(o.getSource()))},abort:function(){i&&i.abort()},destroy:function(){i=null}})}return e.FileReader=i}),i(F,[O,s,l,b,_,y,A,f,u],function(e,t,n,i,r,o,a,s,u){function c(){function e(e,t){var n,i,r=this;n=t.getBlob().getSource(),i=new window.FileReader,i.onload=function(){t.append(t.getBlobName(),new o(null,{type:n.type,data:i.result})),p.send.call(r,e,t)},i.readAsBinaryString(n)}function c(){return!window.XMLHttpRequest||"IE"===u.browser&&u.verComp(u.version,8,"<")?function(){for(var e=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(n){}}():new window.XMLHttpRequest}function l(e){var t=e.responseXML,n=e.responseText;return"IE"===u.browser&&n&&t&&!t.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(e.getResponseHeader("Content-Type"))&&(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.validateOnParse=!1,t.loadXML(n)),t&&("IE"===u.browser&&0!==t.parseError||!t.documentElement||"parsererror"===t.documentElement.tagName)?null:t}function d(e){var t="----moxieboundary"+(new Date).getTime(),n="--",i="\r\n",r="",a=this.getRuntime();if(!a.can("send_binary_string"))throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR);return f.setRequestHeader("Content-Type","multipart/form-data; boundary="+t),e.each(function(e,a){r+=e instanceof o?n+t+i+'Content-Disposition: form-data; name="'+a+'"; filename="'+unescape(encodeURIComponent(e.name||"blob"))+'"'+i+"Content-Type: "+(e.type||"application/octet-stream")+i+i+e.getSource()+i:n+t+i+'Content-Disposition: form-data; name="'+a+'"'+i+i+unescape(encodeURIComponent(e))+i}),r+=n+t+n+i}var f,h,p=this;t.extend(this,{send:function(n,r){var s=this,l="Mozilla"===u.browser&&u.verComp(u.version,4,">=")&&u.verComp(u.version,7,"<"),p="Android Browser"===u.browser,m=!1;if(h=n.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),f=c(),f.open(n.method,n.url,n.async,n.user,n.password),r instanceof o)r.isDetached()&&(m=!0),r=r.getSource();else if(r instanceof a){if(r.hasBlob())if(r.getBlob().isDetached())r=d.call(s,r),m=!0;else if((l||p)&&"blob"===t.typeOf(r.getBlob().getSource())&&window.FileReader)return void e.call(s,n,r);if(r instanceof a){var g=new window.FormData;r.each(function(e,t){e instanceof o?g.append(t,e.getSource()):g.append(t,e)}),r=g}}f.upload?(n.withCredentials&&(f.withCredentials=!0),f.addEventListener("load",function(e){s.trigger(e)}),f.addEventListener("error",function(e){s.trigger(e)}),f.addEventListener("progress",function(e){s.trigger(e)}),f.upload.addEventListener("progress",function(e){s.trigger({type:"UploadProgress",loaded:e.loaded,total:e.total})})):f.onreadystatechange=function(){switch(f.readyState){case 1:break;case 2:break;case 3:var e,t;try{i.hasSameOrigin(n.url)&&(e=f.getResponseHeader("Content-Length")||0),f.responseText&&(t=f.responseText.length)}catch(r){e=t=0}s.trigger({type:"progress",lengthComputable:!!e,total:parseInt(e,10),loaded:t});break;case 4:f.onreadystatechange=function(){},s.trigger(0===f.status?"error":"load")}},t.isEmptyObj(n.headers)||t.each(n.headers,function(e,t){f.setRequestHeader(t,e)}),""!==n.responseType&&"responseType"in f&&("json"!==n.responseType||u.can("return_response_type","json")?f.responseType=n.responseType:f.responseType="text"),m?f.sendAsBinary?f.sendAsBinary(r):!function(){for(var e=new Uint8Array(r.length),t=0;t<r.length;t++)e[t]=255&r.charCodeAt(t);f.send(e.buffer)}():f.send(r),s.trigger("loadstart")},getStatus:function(){try{if(f)return f.status}catch(e){}return 0},getResponse:function(e){var t=this.getRuntime();try{switch(e){case"blob":var i=new r(t.uid,f.response),o=f.getResponseHeader("Content-Disposition");if(o){var a=o.match(/filename=([\'\"'])([^\1]+)\1/);a&&(h=a[2])}return i.name=h,i.type||(i.type=n.getFileMime(h)),i;case"json":return u.can("return_response_type","json")?f.response:200===f.status&&window.JSON?JSON.parse(f.responseText):null;case"document":return l(f);default:return""!==f.responseText?f.responseText:null}}catch(s){return null}},getAllResponseHeaders:function(){try{return f.getAllResponseHeaders()}catch(e){}return""},abort:function(){f&&f.abort()},destroy:function(){p=h=null}})}return e.XMLHttpRequest=c}),i(P,[s],function(e){function t(e){e instanceof ArrayBuffer?n.apply(this,arguments):i.apply(this,arguments)}function n(t){var n=new DataView(t);e.extend(this,{readByteAt:function(e){return n.getUint8(e)},writeByteAt:function(e,t){n.setUint8(e,t)},SEGMENT:function(e,i,r){switch(arguments.length){case 2:return t.slice(e,e+i);case 1:return t.slice(e);case 3:if(null===r&&(r=new ArrayBuffer),r instanceof ArrayBuffer){var o=new Uint8Array(this.length()-i+r.byteLength);e>0&&o.set(new Uint8Array(t.slice(0,e)),0),o.set(new Uint8Array(r),e),o.set(new Uint8Array(t.slice(e+i)),e+r.byteLength),this.clear(),t=o.buffer,n=new DataView(t);break}default:return t}},length:function(){return t?t.byteLength:0},clear:function(){n=t=null}})}function i(t){function n(e,n,i){i=3===arguments.length?i:t.length-n-1,t=t.substr(0,n)+e+t.substr(i+n)}e.extend(this,{readByteAt:function(e){return t.charCodeAt(e)},writeByteAt:function(e,t){n(String.fromCharCode(t),e,1)},SEGMENT:function(e,i,r){switch(arguments.length){case 1:return t.substr(e);case 2:return t.substr(e,i);case 3:n(null!==r?r:"",e,i);break;default:return t}},length:function(){return t?t.length:0},clear:function(){t=null}})}return e.extend(t.prototype,{littleEndian:!1,read:function(e,t){var n,i,r;if(e+t>this.length())throw new Error("You are trying to read outside the source boundaries.");for(i=this.littleEndian?0:-8*(t-1),r=0,n=0;t>r;r++)n|=this.readByteAt(e+r)<<Math.abs(i+8*r);return n},write:function(e,t,n){var i,r;if(e>this.length())throw new Error("You are trying to write outside the source boundaries.");for(i=this.littleEndian?0:-8*(n-1),r=0;n>r;r++)this.writeByteAt(e+r,t>>Math.abs(i+8*r)&255)},BYTE:function(e){return this.read(e,1)},SHORT:function(e){return this.read(e,2)},LONG:function(e){return this.read(e,4)},SLONG:function(e){var t=this.read(e,4);return t>2147483647?t-4294967296:t},CHAR:function(e){return String.fromCharCode(this.read(e,1))},STRING:function(e,t){return this.asArray("CHAR",e,t).join("")},asArray:function(e,t,n){for(var i=[],r=0;n>r;r++)i[r]=this[e](t+r);return i}}),t}),i(z,[P,f],function(e,t){return function n(i){var r,o,a,s=[],u=0;if(r=new e(i),65496!==r.SHORT(0))throw r.clear(),new t.ImageError(t.ImageError.WRONG_FORMAT);for(o=2;o<=r.length();)if(a=r.SHORT(o),a>=65488&&65495>=a)o+=2;else{if(65498===a||65497===a)break;u=r.SHORT(o+2)+2,a>=65505&&65519>=a&&s.push({hex:a,name:"APP"+(15&a),start:o,length:u,segment:r.SEGMENT(o,u)}),o+=u}return r.clear(),{headers:s,restore:function(t){var n,i,r;for(r=new e(t),o=65504==r.SHORT(2)?4+r.SHORT(4):2,i=0,n=s.length;n>i;i++)r.SEGMENT(o,0,s[i].segment),o+=s[i].length;return t=r.SEGMENT(),r.clear(),t},strip:function(t){var i,r,o,a;for(o=new n(t),r=o.headers,o.purge(),i=new e(t),a=r.length;a--;)i.SEGMENT(r[a].start,r[a].length,"");return t=i.SEGMENT(),i.clear(),t},get:function(e){for(var t=[],n=0,i=s.length;i>n;n++)s[n].name===e.toUpperCase()&&t.push(s[n].segment);return t},set:function(e,t){var n,i,r,o=[];for("string"==typeof t?o.push(t):o=t,n=i=0,r=s.length;r>n&&(s[n].name===e.toUpperCase()&&(s[n].segment=o[i],s[n].length=o[i].length,
i++),!(i>=o.length));n++);},purge:function(){this.headers=s=[]}}}}),i(U,[s,P,f],function(e,n,i){function r(o){function a(n,r){var o,a,s,u,c,f,h,p,m=this,g=[],v={},y={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},_={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};for(o=m.SHORT(n),a=0;o>a;a++)if(g=[],h=n+2+12*a,s=r[m.SHORT(h)],s!==t){if(u=y[m.SHORT(h+=2)],c=m.LONG(h+=2),f=_[u],!f)throw new i.ImageError(i.ImageError.INVALID_META_ERR);if(h+=4,f*c>4&&(h=m.LONG(h)+d.tiffHeader),h+f*c>=this.length())throw new i.ImageError(i.ImageError.INVALID_META_ERR);"ASCII"!==u?(g=m.asArray(u,h,c),p=1==c?g[0]:g,l.hasOwnProperty(s)&&"object"!=typeof p?v[s]=l[s][p]:v[s]=p):v[s]=e.trim(m.STRING(h,c).replace(/\0$/,""))}return v}function s(e,t,n){var i,r,o,a=0;if("string"==typeof t){var s=c[e.toLowerCase()];for(var u in s)if(s[u]===t){t=u;break}}i=d[e.toLowerCase()+"IFD"],r=this.SHORT(i);for(var l=0;r>l;l++)if(o=i+12*l+2,this.SHORT(o)==t){a=o+8;break}if(!a)return!1;try{this.write(a,n,4)}catch(f){return!1}return!0}var u,c,l,d,f,h;if(n.call(this,o),c={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}},l={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},d={tiffHeader:10},f=d.tiffHeader,u={clear:this.clear},e.extend(this,{read:function(){try{return r.prototype.read.apply(this,arguments)}catch(e){throw new i.ImageError(i.ImageError.INVALID_META_ERR)}},write:function(){try{return r.prototype.write.apply(this,arguments)}catch(e){throw new i.ImageError(i.ImageError.INVALID_META_ERR)}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(e){return this.LONG(e)/this.LONG(e+4)},SRATIONAL:function(e){return this.SLONG(e)/this.SLONG(e+4)},ASCII:function(e){return this.CHAR(e)},TIFF:function(){return h||null},EXIF:function(){var t=null;if(d.exifIFD){try{t=a.call(this,d.exifIFD,c.exif)}catch(n){return null}if(t.ExifVersion&&"array"===e.typeOf(t.ExifVersion)){for(var i=0,r="";i<t.ExifVersion.length;i++)r+=String.fromCharCode(t.ExifVersion[i]);t.ExifVersion=r}}return t},GPS:function(){var t=null;if(d.gpsIFD){try{t=a.call(this,d.gpsIFD,c.gps)}catch(n){return null}t.GPSVersionID&&"array"===e.typeOf(t.GPSVersionID)&&(t.GPSVersionID=t.GPSVersionID.join("."))}return t},thumb:function(){if(d.IFD1)try{var e=a.call(this,d.IFD1,c.thumb);if("JPEGInterchangeFormat"in e)return this.SEGMENT(d.tiffHeader+e.JPEGInterchangeFormat,e.JPEGInterchangeFormatLength)}catch(t){}return null},setExif:function(e,t){return("PixelXDimension"===e||"PixelYDimension"===e)&&s.call(this,"exif",e,t)},clear:function(){u.clear(),o=c=l=h=d=u=null}}),65505!==this.SHORT(0)||"EXIF\0"!==this.STRING(4,5).toUpperCase())throw new i.ImageError(i.ImageError.INVALID_META_ERR);if(this.littleEndian=18761==this.SHORT(f),42!==this.SHORT(f+=2))throw new i.ImageError(i.ImageError.INVALID_META_ERR);d.IFD0=d.tiffHeader+this.LONG(f+=2),h=a.call(this,d.IFD0,c.tiff),"ExifIFDPointer"in h&&(d.exifIFD=d.tiffHeader+h.ExifIFDPointer,delete h.ExifIFDPointer),"GPSInfoIFDPointer"in h&&(d.gpsIFD=d.tiffHeader+h.GPSInfoIFDPointer,delete h.GPSInfoIFDPointer),e.isEmptyObj(h)&&(h=null);var p=this.LONG(d.IFD0+12*this.SHORT(d.IFD0)+2);p&&(d.IFD1=d.tiffHeader+p)}return r.prototype=n.prototype,r}),i(H,[s,f,z,P,U],function(e,t,n,i,r){function o(o){function a(e){var t,n,i=0;for(e||(e=c);i<=e.length();){if(t=e.SHORT(i+=2),t>=65472&&65475>=t)return i+=5,{height:e.SHORT(i),width:e.SHORT(i+=2)};n=e.SHORT(i+=2),i+=n-2}return null}function s(){var e,t,n=d.thumb();return n&&(e=new i(n),t=a(e),e.clear(),t)?(t.data=n,t):null}function u(){d&&l&&c&&(d.clear(),l.purge(),c.clear(),f=l=d=c=null)}var c,l,d,f;if(c=new i(o),65496!==c.SHORT(0))throw new t.ImageError(t.ImageError.WRONG_FORMAT);l=new n(o);try{d=new r(l.get("app1")[0])}catch(h){}f=a.call(this),e.extend(this,{type:"image/jpeg",size:c.length(),width:f&&f.width||0,height:f&&f.height||0,setExif:function(t,n){return!!d&&("object"===e.typeOf(t)?e.each(t,function(e,t){d.setExif(t,e)}):d.setExif(t,n),void l.set("app1",d.SEGMENT()))},writeHeaders:function(){return l.restore(arguments.length?arguments[0]:o)},stripHeaders:function(e){return l.strip(e)},purge:function(){u.call(this)}}),d&&(this.meta={tiff:d.TIFF(),exif:d.EXIF(),gps:d.GPS(),thumb:s()})}return o}),i(k,[f,s,P],function(e,t,n){function i(i){function r(){var e,t;return e=a.call(this,8),"IHDR"==e.type?(t=e.start,{width:s.LONG(t),height:s.LONG(t+=4)}):null}function o(){s&&(s.clear(),i=l=u=c=s=null)}function a(e){var t,n,i,r;return t=s.LONG(e),n=s.STRING(e+=4,4),i=e+=4,r=s.LONG(e+t),{length:t,type:n,start:i,CRC:r}}var s,u,c,l;s=new n(i),function(){var t=0,n=0,i=[35152,20039,3338,6666];for(n=0;n<i.length;n++,t+=2)if(i[n]!=s.SHORT(t))throw new e.ImageError(e.ImageError.WRONG_FORMAT)}(),l=r.call(this),t.extend(this,{type:"image/png",size:s.length(),width:l.width,height:l.height,purge:function(){o.call(this)}}),o.call(this)}return i}),i(B,[s,f,H,k],function(e,t,n,i){return function(r){var o,a=[n,i];o=function(){for(var e=0;e<a.length;e++)try{return new a[e](r)}catch(n){}throw new t.ImageError(t.ImageError.WRONG_FORMAT)}(),e.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(e){return e},stripHeaders:function(e){return e},purge:function(){r=null}}),e.extend(this,o),this.purge=function(){o.purge(),o=null}}}),i(q,[],function(){function e(e,i,r){var o=e.naturalWidth,a=e.naturalHeight,s=r.width,u=r.height,c=r.x||0,l=r.y||0,d=i.getContext("2d");t(e)&&(o/=2,a/=2);var f=1024,h=document.createElement("canvas");h.width=h.height=f;for(var p=h.getContext("2d"),m=n(e,o,a),g=0;a>g;){for(var v=g+f>a?a-g:f,y=0;o>y;){var _=y+f>o?o-y:f;p.clearRect(0,0,f,f),p.drawImage(e,-y,-g);var w=y*s/o+c<<0,E=Math.ceil(_*s/o),b=g*u/a/m+l<<0,R=Math.ceil(v*u/a/m);d.drawImage(h,0,0,_,v,w,b,E,R),y+=f}g+=f}h=p=null}function t(e){var t=e.naturalWidth,n=e.naturalHeight;if(t*n>1048576){var i=document.createElement("canvas");i.width=i.height=1;var r=i.getContext("2d");return r.drawImage(e,-t+1,0),0===r.getImageData(0,0,1,1).data[3]}return!1}function n(e,t,n){var i=document.createElement("canvas");i.width=1,i.height=n;var r=i.getContext("2d");r.drawImage(e,0,0);for(var o=r.getImageData(0,0,1,n).data,a=0,s=n,u=n;u>a;){var c=o[4*(u-1)+3];0===c?s=u:a=u,u=s+a>>1}i=null;var l=u/n;return 0===l?1:l}return{isSubsampled:t,renderTo:e}}),i(G,[O,s,f,v,y,_,B,q,l,u],function(e,t,n,i,r,o,a,s,u,c){function l(){function e(){if(!w&&!y)throw new n.ImageError(n.DOMException.INVALID_STATE_ERR);return w||y}function l(e){return i.atob(e.substring(e.indexOf("base64,")+7))}function d(e,t){return"data:"+(t||"")+";base64,"+i.btoa(e)}function f(e){var t=this;y=new Image,y.onerror=function(){v.call(this),t.trigger("error",n.ImageError.WRONG_FORMAT)},y.onload=function(){t.trigger("load")},y.src="data:"==e.substr(0,5)?e:d(e,b.type)}function h(e,t){var i,r=this;return window.FileReader?(i=new FileReader,i.onload=function(){t(this.result)},i.onerror=function(){r.trigger("error",n.ImageError.WRONG_FORMAT)},void i.readAsDataURL(e)):t(e.getAsDataURL())}function p(n,i,r,o){var a,s,u,c,l,d=this,f=0,h=0;if(A=o,l=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==t.inArray(l,[5,6,7,8])){var p=n;n=i,i=p}return s=e(),r?(n=Math.min(n,s.width),i=Math.min(i,s.height),a=Math.max(n/s.width,i/s.height)):a=Math.min(n/s.width,i/s.height),a>1&&!r&&o?void this.trigger("Resize"):(w||(w=document.createElement("canvas")),u=Math.round(s.width*a),c=Math.round(s.height*a),r?(w.width=n,w.height=i,u>n&&(f=Math.round((u-n)/2)),c>i&&(h=Math.round((c-i)/2))):(w.width=u,w.height=c),A||g(w.width,w.height,l),m.call(this,s,w,-f,-h,u,c),this.width=w.width,this.height=w.height,x=!0,void d.trigger("Resize"))}function m(e,t,n,i,r,o){if("iOS"===c.OS)s.renderTo(e,t,{width:r,height:o,x:n,y:i});else{var a=t.getContext("2d");a.drawImage(e,n,i,r,o)}}function g(e,t,n){switch(n){case 5:case 6:case 7:case 8:w.width=t,w.height=e;break;default:w.width=e,w.height=t}var i=w.getContext("2d");switch(n){case 2:i.translate(e,0),i.scale(-1,1);break;case 3:i.translate(e,t),i.rotate(Math.PI);break;case 4:i.translate(0,t),i.scale(1,-1);break;case 5:i.rotate(.5*Math.PI),i.scale(1,-1);break;case 6:i.rotate(.5*Math.PI),i.translate(0,-t);break;case 7:i.rotate(.5*Math.PI),i.translate(e,-t),i.scale(-1,1);break;case 8:i.rotate(-.5*Math.PI),i.translate(-e,0)}}function v(){_&&(_.purge(),_=null),E=y=w=b=null,x=!1}var y,_,w,E,b,R=this,x=!1,A=!0;t.extend(this,{loadFromBlob:function(e){var t=this,i=t.getRuntime(),r=!(arguments.length>1)||arguments[1];if(!i.can("access_binary"))throw new n.RuntimeError(n.RuntimeError.NOT_SUPPORTED_ERR);return b=e,e.isDetached()?(E=e.getSource(),void f.call(this,E)):void h.call(this,e.getSource(),function(e){r&&(E=l(e)),f.call(t,e)})},loadFromImage:function(e,t){this.meta=e.meta,b=new o(null,{name:e.name,size:e.size,type:e.type}),f.call(this,t?E=e.getAsBinaryString():e.getAsDataURL())},getInfo:function(){var t,n=this.getRuntime();return!_&&E&&n.can("access_image_binary")&&(_=new a(E)),t={width:e().width||0,height:e().height||0,type:b.type||u.getFileMime(b.name),size:E&&E.length||b.size||0,name:b.name||"",meta:_&&_.meta||this.meta||{}},!t.meta||!t.meta.thumb||t.meta.thumb.data instanceof r||(t.meta.thumb.data=new r(null,{type:"image/jpeg",data:t.meta.thumb.data})),t},downsize:function(){p.apply(this,arguments)},getAsCanvas:function(){return w&&(w.id=this.uid+"_canvas"),w},getAsBlob:function(e,t){return e!==this.type&&p.call(this,this.width,this.height,!1),new o(null,{name:b.name||"",type:e,data:R.getAsBinaryString.call(this,e,t)})},getAsDataURL:function(e){var t=arguments[1]||90;if(!x)return y.src;if("image/jpeg"!==e)return w.toDataURL("image/png");try{return w.toDataURL("image/jpeg",t/100)}catch(n){return w.toDataURL("image/jpeg")}},getAsBinaryString:function(e,t){if(!x)return E||(E=l(R.getAsDataURL(e,t))),E;if("image/jpeg"!==e)E=l(R.getAsDataURL(e,t));else{var n;t||(t=90);try{n=w.toDataURL("image/jpeg",t/100)}catch(i){n=w.toDataURL("image/jpeg")}E=l(n),_&&(E=_.stripHeaders(E),A&&(_.meta&&_.meta.exif&&_.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),E=_.writeHeaders(E)),_.purge(),_=null)}return x=!1,E},destroy:function(){R=null,v.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return e.Image=l}),i(j,[s,u,d,f,p],function(e,t,n,i,r){function o(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(n){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1])}function a(e){var i=n.get(e);i&&"OBJECT"==i.nodeName&&("IE"===t.browser?(i.style.display="none",function r(){4==i.readyState?s(e):setTimeout(r,10)}()):i.parentNode.removeChild(i))}function s(e){var t=n.get(e);if(t){for(var i in t)"function"==typeof t[i]&&(t[i]=null);t.parentNode.removeChild(t)}}function u(s){var u,d=this;s=e.extend({swf_url:t.swf_url},s),r.call(this,s,c,{access_binary:function(e){return e&&"browser"===d.mode},access_image_binary:function(e){return e&&"browser"===d.mode},display_media:r.capTrue,do_cors:r.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===d.mode},resize_image:r.capTrue,return_response_headers:!1,return_response_type:function(t){return!("json"!==t||!window.JSON)||(!e.arrayDiff(t,["","text","document"])||"browser"===d.mode)},return_status_code:function(t){return"browser"===d.mode||!e.arrayDiff(t,[200,404])},select_file:r.capTrue,select_multiple:r.capTrue,send_binary_string:function(e){return e&&"browser"===d.mode},send_browser_cookies:function(e){return e&&"browser"===d.mode},send_custom_headers:function(e){return e&&"browser"===d.mode},send_multipart:r.capTrue,slice_blob:function(e){return e&&"browser"===d.mode},stream_upload:function(e){return e&&"browser"===d.mode},summon_file_dialog:!1,upload_filesize:function(t){return e.parseSizeStr(t)<=2097152||"client"===d.mode},use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}},{access_binary:function(e){return e?"browser":"client"},access_image_binary:function(e){return e?"browser":"client"},report_upload_progress:function(e){return e?"browser":"client"},return_response_type:function(t){return e.arrayDiff(t,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"browser":["client","browser"]},send_binary_string:function(e){return e?"browser":"client"},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"browser":"client"},stream_upload:function(e){return e?"client":"browser"},upload_filesize:function(t){return e.parseSizeStr(t)>=2097152?"client":"browser"}},"client"),o()<10&&(this.mode=!1),e.extend(this,{getShim:function(){return n.get(this.uid)},shimExec:function(e,t){var n=[].slice.call(arguments,2);return d.getShim().exec(this.uid,e,t,n)},init:function(){var n,r,o;o=this.getShimContainer(),e.extend(o.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),n='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+s.swf_url+'" ',"IE"===t.browser&&(n+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),n+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+s.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+t.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',"IE"===t.browser?(r=document.createElement("div"),o.appendChild(r),r.outerHTML=n,r=o=null):o.innerHTML=n,u=setTimeout(function(){d&&!d.initialized&&d.trigger("Error",new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(e){return function(){a(d.uid),e.call(d),clearTimeout(u),s=u=e=d=null}}(this.destroy)},l)}var c="flash",l={};return r.addConstructor(c,u),l}),i(X,[j,_,s],function(e,t,n){var i={init:function(e){var i=this,r=this.getRuntime();this.bind("Change",function(){var e=r.shimExec.call(i,"FileInput","getFiles");i.files=[],n.each(e,function(e){i.files.push(new t(r.uid,e))})},999),this.getRuntime().shimExec.call(this,"FileInput","init",{name:e.name,accept:e.accept,multiple:e.multiple}),this.trigger("ready")}};return e.FileInput=i}),i(V,[j,y],function(e,t){var n={slice:function(e,n,i,r){var o=this.getRuntime();return 0>n?n=Math.max(e.size+n,0):n>0&&(n=Math.min(n,e.size)),0>i?i=Math.max(e.size+i,0):i>0&&(i=Math.min(i,e.size)),e=o.shimExec.call(this,"Blob","slice",n,i,r||""),e&&(e=new t(o.uid,e)),e}};return e.Blob=n}),i(W,[j,v],function(e,t){function n(e,n){switch(n){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var i={read:function(e,t){var i=this;return i.result="","readAsDataURL"===e&&(i.result="data:"+(t.type||"")+";base64,"),i.bind("Progress",function(t,r){r&&(i.result+=n(r,e))},999),i.getRuntime().shimExec.call(this,"FileReader","readAsBase64",t.uid)}};return e.FileReader=i}),i(Y,[j,v],function(e,t){function n(e,n){switch(n){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var i={read:function(e,t){var i,r=this.getRuntime();return(i=r.shimExec.call(this,"FileReaderSync","readAsBase64",t.uid))?("readAsDataURL"===e&&(i="data:"+(t.type||"")+";base64,"+i),n(i,e,t.type)):null}};return e.FileReaderSync=i}),i($,[j,s,y,_,x,A,S],function(e,t,n,i,r,o,a){var s={send:function(e,i){function r(){e.transport=l.mode,l.shimExec.call(c,"XMLHttpRequest","send",e,i)}function s(e,t){l.shimExec.call(c,"XMLHttpRequest","appendBlob",e,t.uid),i=null,r()}function u(e,t){var n=new a;n.bind("TransportingComplete",function(){t(this.result)}),n.transport(e.getSource(),e.type,{ruid:l.uid})}var c=this,l=c.getRuntime();if(t.isEmptyObj(e.headers)||t.each(e.headers,function(e,t){l.shimExec.call(c,"XMLHttpRequest","setRequestHeader",t,e.toString())}),i instanceof o){var d;if(i.each(function(e,t){e instanceof n?d=t:l.shimExec.call(c,"XMLHttpRequest","append",t,e)}),i.hasBlob()){var f=i.getBlob();f.isDetached()?u(f,function(e){f.destroy(),s(d,e)}):s(d,f)}else i=null,r()}else i instanceof n?i.isDetached()?u(i,function(e){i.destroy(),i=e.uid,r()}):(i=i.uid,r()):r()},getResponse:function(e){var n,o,a=this.getRuntime();if(o=a.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(o=new i(a.uid,o),"blob"===e)return o;try{if(n=new r,~t.inArray(e,["","text"]))return n.readAsText(o);if("json"===e&&window.JSON)return JSON.parse(n.readAsText(o))}finally{o.destroy()}}return null},abort:function(e){var t=this.getRuntime();t.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return e.XMLHttpRequest=s}),i(J,[j,y],function(e,t){var n={getAsBlob:function(e){var n=this.getRuntime(),i=n.shimExec.call(this,"Transporter","getAsBlob",e);return i?new t(n.uid,i):null}};return e.Transporter=n}),i(Z,[j,s,S,y,x],function(e,t,n,i,r){var o={loadFromBlob:function(e){function t(e){r.shimExec.call(i,"Image","loadFromBlob",e.uid),i=r=null}var i=this,r=i.getRuntime();if(e.isDetached()){var o=new n;o.bind("TransportingComplete",function(){t(o.result.getSource())}),o.transport(e.getSource(),e.type,{ruid:r.uid})}else t(e.getSource())},loadFromImage:function(e){var t=this.getRuntime();return t.shimExec.call(this,"Image","loadFromImage",e.uid)},getInfo:function(){var e=this.getRuntime(),t=e.shimExec.call(this,"Image","getInfo");return!t.meta||!t.meta.thumb||t.meta.thumb.data instanceof i||(t.meta.thumb.data=new i(e.uid,t.meta.thumb.data)),t},getAsBlob:function(e,t){var n=this.getRuntime(),r=n.shimExec.call(this,"Image","getAsBlob",e,t);return r?new i(n.uid,r):null},getAsDataURL:function(){var e,t=this.getRuntime(),n=t.Image.getAsBlob.apply(this,arguments);return n?(e=new r,e.readAsDataURL(n)):null}};return e.Image=o}),i(Q,[s,u,d,f,p],function(e,t,n,i,r){function o(e){var t,n,i,r,o,a=!1,s=null,u=0;try{try{s=new ActiveXObject("AgControl.AgControl"),s.IsVersionSupported(e)&&(a=!0),s=null}catch(c){var l=navigator.plugins["Silverlight Plug-In"];if(l){for(t=l.description,"1.0.30226.2"===t&&(t="2.0.30226.2"),n=t.split(".");n.length>3;)n.pop();for(;n.length<4;)n.push(0);for(i=e.split(".");i.length>4;)i.pop();do r=parseInt(i[u],10),o=parseInt(n[u],10),u++;while(u<i.length&&r===o);o>=r&&!isNaN(r)&&(a=!0)}}}catch(d){a=!1}return a}function a(a){var c,l=this;a=e.extend({xap_url:t.xap_url},a),r.call(this,a,s,{access_binary:r.capTrue,access_image_binary:r.capTrue,display_media:r.capTrue,do_cors:r.capTrue,drag_and_drop:!1,report_upload_progress:r.capTrue,resize_image:r.capTrue,return_response_headers:function(e){return e&&"client"===l.mode},return_response_type:function(e){return"json"!==e||!!window.JSON},return_status_code:function(t){return"client"===l.mode||!e.arrayDiff(t,[200,404])},select_file:r.capTrue,select_multiple:r.capTrue,send_binary_string:r.capTrue,send_browser_cookies:function(e){return e&&"browser"===l.mode},send_custom_headers:function(e){return e&&"client"===l.mode},send_multipart:r.capTrue,slice_blob:r.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:r.capTrue,use_http_method:function(t){return"client"===l.mode||!e.arrayDiff(t,["GET","POST"])}},{return_response_headers:function(e){return e?"client":"browser"},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"client":["client","browser"]},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"client":"browser"},use_http_method:function(t){return e.arrayDiff(t,["GET","POST"])?"client":["client","browser"]}}),o("2.0.31005.0")&&"Opera"!==t.browser||(this.mode=!1),e.extend(this,{getShim:function(){return n.get(this.uid).content.Moxie},shimExec:function(e,t){var n=[].slice.call(arguments,2);return l.getShim().exec(this.uid,e,t,n)},init:function(){var e;e=this.getShimContainer(),e.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+a.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+t.global_event_dispatcher+'"/></object>',c=setTimeout(function(){l&&!l.initialized&&l.trigger("Error",new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR))},"Windows"!==t.OS?1e4:5e3)},destroy:function(e){return function(){e.call(l),clearTimeout(c),a=c=e=l=null}}(this.destroy)},u)}var s="silverlight",u={};return r.addConstructor(s,a),u}),i(K,[Q,_,s],function(e,t,n){var i={init:function(e){function i(e){for(var t="",n=0;n<e.length;n++)t+=(""!==t?"|":"")+e[n].title+" | *."+e[n].extensions.replace(/,/g,";*.");return t}var r=this,o=this.getRuntime();this.bind("Change",function(){var e=o.shimExec.call(r,"FileInput","getFiles");r.files=[],n.each(e,function(e){r.files.push(new t(o.uid,e))})},999),this.getRuntime().shimExec.call(this,"FileInput","init",i(e.accept),e.name,e.multiple),this.trigger("ready")}};return e.FileInput=i}),i(ee,[Q,s,V],function(e,t,n){return e.Blob=t.extend({},n)}),i(te,[Q,d,D],function(e,t,n){var i={init:function(){var e,i=this,r=i.getRuntime();return e=r.getShimContainer(),n.addEvent(e,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},i.uid),n.addEvent(e,"dragenter",function(e){e.preventDefault();var n=t.get(r.uid).dragEnter(e);n&&e.stopPropagation()},i.uid),n.addEvent(e,"drop",function(e){e.preventDefault();var n=t.get(r.uid).dragDrop(e);n&&e.stopPropagation()},i.uid),r.shimExec.call(this,"FileDrop","init")}};return e.FileDrop=i}),i(ne,[Q,s,W],function(e,t,n){return e.FileReader=t.extend({},n)}),i(ie,[Q,s,Y],function(e,t,n){return e.FileReaderSync=t.extend({},n)}),i(re,[Q,s,$],function(e,t,n){return e.XMLHttpRequest=t.extend({},n)}),i(oe,[Q,s,J],function(e,t,n){return e.Transporter=t.extend({},n)}),i(ae,[Q,s,y,Z],function(e,t,n,i){return e.Image=t.extend({},i,{getInfo:function(){var e=this.getRuntime(),i=["tiff","exif","gps","thumb"],r={meta:{}},o=e.shimExec.call(this,"Image","getInfo");return o.meta&&(t.each(i,function(e){var t,n,i,a,s=o.meta[e];if(s&&s.keys)for(r.meta[e]={},n=0,i=s.keys.length;i>n;n++)t=s.keys[n],a=s[t],a&&(/^(\d|[1-9]\d+)$/.test(a)?a=parseInt(a,10):/^\d*\.\d+$/.test(a)&&(a=parseFloat(a)),r.meta[e][t]=a)}),!r.meta||!r.meta.thumb||r.meta.thumb.data instanceof n||(r.meta.thumb.data=new n(e.uid,r.meta.thumb.data))),r.width=parseInt(o.width,10),r.height=parseInt(o.height,10),r.size=parseInt(o.size,10),r.type=o.type,r.name=o.name,r}})}),i(se,[s,f,p,u],function(e,t,n,i){function r(t){var r=this,s=n.capTest,u=n.capTrue;n.call(this,t,o,{access_binary:s(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:s(a.Image&&(i.can("create_canvas")||i.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:s(function(){return"Chrome"===i.browser&&i.verComp(i.version,28,">=")||"IE"===i.browser&&i.verComp(i.version,10,">=")||"Safari"===i.browser&&i.verComp(i.version,7,">=")}()),resize_image:function(){return a.Image&&r.can("access_binary")&&i.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(t){return!("json"!==t||!window.JSON)||!!~e.inArray(t,["text","document",""])},return_status_code:function(t){return!e.arrayDiff(t,[200,404])},select_file:function(){return i.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return r.can("select_file")},summon_file_dialog:function(){return r.can("select_file")&&("Firefox"===i.browser&&i.verComp(i.version,4,">=")||"Opera"===i.browser&&i.verComp(i.version,12,">=")||"IE"===i.browser&&i.verComp(i.version,10,">=")||!!~e.inArray(i.browser,["Chrome","Safari"]))},upload_filesize:u,use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}}),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(r),e=r=null}}(this.destroy)}),e.extend(this.getShim(),a)}var o="html4",a={};return n.addConstructor(o,r),a}),i(ue,[se,_,s,d,D,l,u],function(e,t,n,i,r,o,a){function s(){function e(){var o,l,d,f,h,p,m=this,g=m.getRuntime();p=n.guid("uid_"),o=g.getShimContainer(),s&&(d=i.get(s+"_form"),d&&n.extend(d.style,{top:"100%"})),f=document.createElement("form"),f.setAttribute("id",p+"_form"),f.setAttribute("method","post"),f.setAttribute("enctype","multipart/form-data"),f.setAttribute("encoding","multipart/form-data"),n.extend(f.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),h=document.createElement("input"),h.setAttribute("id",p),h.setAttribute("type","file"),h.setAttribute("name",u.name||"Filedata"),h.setAttribute("accept",c.join(",")),n.extend(h.style,{fontSize:"999px",opacity:0}),f.appendChild(h),o.appendChild(f),n.extend(h.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===a.browser&&a.verComp(a.version,10,"<")&&n.extend(h.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),h.onchange=function(){var n;if(this.value){if(this.files){if(n=this.files[0],0===n.size)return void f.parentNode.removeChild(f)}else n={name:this.value};n=new t(g.uid,n),this.onchange=function(){},e.call(m),m.files=[n],h.setAttribute("id",n.uid),f.setAttribute("id",n.uid+"_form"),m.trigger("change"),h=f=null}},g.can("summon_file_dialog")&&(l=i.get(u.browse_button),r.removeEvent(l,"click",m.uid),r.addEvent(l,"click",function(e){h&&!h.disabled&&h.click(),e.preventDefault()},m.uid)),s=p,o=d=l=null}var s,u,c=[];n.extend(this,{init:function(t){var n,a=this,s=a.getRuntime();u=t,c=t.accept.mimes||o.extList2mimes(t.accept,s.can("filter_by_extension")),n=s.getShimContainer(),function(){var e,o,u;e=i.get(t.browse_button),s.can("summon_file_dialog")&&("static"===i.getStyle(e,"position")&&(e.style.position="relative"),o=parseInt(i.getStyle(e,"z-index"),10)||1,e.style.zIndex=o,n.style.zIndex=o-1),u=s.can("summon_file_dialog")?e:n,r.addEvent(u,"mouseover",function(){a.trigger("mouseenter")},a.uid),r.addEvent(u,"mouseout",function(){a.trigger("mouseleave")},a.uid),r.addEvent(u,"mousedown",function(){a.trigger("mousedown")},a.uid),r.addEvent(i.get(t.container),"mouseup",function(){a.trigger("mouseup")},a.uid),e=null}(),e.call(this),n=null,a.trigger({type:"ready",async:!0})},disable:function(e){var t;(t=i.get(s))&&(t.disabled=!!e)},destroy:function(){var e=this.getRuntime(),t=e.getShim(),n=e.getShimContainer();r.removeAllEvents(n,this.uid),r.removeAllEvents(u&&i.get(u.container),this.uid),r.removeAllEvents(u&&i.get(u.browse_button),this.uid),n&&(n.innerHTML=""),t.removeInstance(this.uid),s=c=u=n=t=null}})}return e.FileInput=s}),i(ce,[se,M],function(e,t){return e.FileReader=t}),i(le,[se,s,d,b,f,D,y,A],function(e,t,n,i,r,o,a,s){function u(){function e(e){var t,i,r,a,s=this,u=!1;if(l){if(t=l.id.replace(/_iframe$/,""),i=n.get(t+"_form")){for(r=i.getElementsByTagName("input"),a=r.length;a--;)switch(r[a].getAttribute("type")){case"hidden":r[a].parentNode.removeChild(r[a]);break;case"file":u=!0}r=[],u||i.parentNode.removeChild(i),i=null}setTimeout(function(){o.removeEvent(l,"load",s.uid),l.parentNode&&l.parentNode.removeChild(l);var t=s.getRuntime().getShimContainer();t.children.length||t.parentNode.removeChild(t),t=l=null,e()},1)}}var u,c,l;t.extend(this,{send:function(d,f){function h(){var n=_.getShimContainer()||document.body,r=document.createElement("div");r.innerHTML='<iframe id="'+p+'_iframe" name="'+p+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',l=r.firstChild,n.appendChild(l),o.addEvent(l,"load",function(){var n;try{n=l.contentWindow.document||l.contentDocument||window.frames[l.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(n.title)?u=n.title.replace(/^(\d+).*$/,"$1"):(u=200,c=t.trim(n.body.innerHTML),y.trigger({type:"progress",loaded:c.length,total:c.length}),v&&y.trigger({type:"uploadprogress",loaded:v.size||1025,total:v.size||1025}))}catch(r){if(!i.hasSameOrigin(d.url))return void e.call(y,function(){y.trigger("error")});u=404}e.call(y,function(){y.trigger("load")})},y.uid)}var p,m,g,v,y=this,_=y.getRuntime();if(u=c=null,f instanceof s&&f.hasBlob()){if(v=f.getBlob(),p=v.uid,g=n.get(p),m=n.get(p+"_form"),!m)throw new r.DOMException(r.DOMException.NOT_FOUND_ERR)}else p=t.guid("uid_"),m=document.createElement("form"),m.setAttribute("id",p+"_form"),m.setAttribute("method",d.method),m.setAttribute("enctype","multipart/form-data"),m.setAttribute("encoding","multipart/form-data"),_.getShimContainer().appendChild(m);m.setAttribute("target",p+"_iframe"),f instanceof s&&f.each(function(e,n){if(e instanceof a)g&&g.setAttribute("name",n);else{var i=document.createElement("input");t.extend(i,{type:"hidden",name:n,value:e}),g?m.insertBefore(i,g):m.appendChild(i)}}),m.setAttribute("action",d.url),h(),m.submit(),y.trigger("loadstart")},getStatus:function(){return u},getResponse:function(e){if("json"===e&&"string"===t.typeOf(c)&&window.JSON)try{return JSON.parse(c.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(n){return null}return c},abort:function(){var t=this;l&&l.contentWindow&&(l.contentWindow.stop?l.contentWindow.stop():l.contentWindow.document.execCommand?l.contentWindow.document.execCommand("Stop"):l.src="about:blank"),
e.call(this,function(){t.dispatchEvent("abort")})}})}return e.XMLHttpRequest=u}),i(de,[se,G],function(e,t){return e.Image=t}),o([s,u,c,l,d,f,h,p,m,g,v,y,_,w,E,b,R,x,A,I,S,T,D])}(this),function(e){"use strict";var t={},n=e.moxie.core.utils.Basic.inArray;return function i(e){var r,o;for(r in e)o=typeof e[r],"object"!==o||~n(r,["Exceptions","Env","Mime"])?"function"===o&&(t[r]=e[r]):i(e[r])}(e.moxie),t.Env=e.moxie.core.utils.Env,t.Mime=e.moxie.core.utils.Mime,t.Exceptions=e.moxie.core.Exceptions,e.mOxie=t,e.o||(e.o=t),t}(this),function(e,t,n){function i(e){function t(e,t,n){var r={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};r[e]?i[r[e]]=t:n||(i[e]=t)}var n=e.required_features,i={};return"string"==typeof n?a.each(n.split(/\s*,\s*/),function(e){t(e,!0)}):"object"==typeof n?a.each(n,function(e,n){t(n,e)}):n===!0&&(e.chunk_size>0&&(i.slice_blob=!0),!e.resize.enabled&&e.multipart||(i.send_binary_string=!0),a.each(e,function(e,n){t(n,!!e,!0)})),i}var r=e.setTimeout,o={},a={VERSION:"2.1.8",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:t.mimes,ua:t.ua,typeOf:t.typeOf,extend:t.extend,guid:t.guid,get:function(e){var n,i=[];"array"!==t.typeOf(e)&&(e=[e]);for(var r=e.length;r--;)n=t.get(e[r]),n&&i.push(n);return i.length?i:null},each:t.each,getPos:t.getPos,getSize:t.getSize,xmlEncode:function(e){var t={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},n=/[<>&\"\']/g;return e?(""+e).replace(n,function(e){return t[e]?"&"+t[e]+";":e}):e},toArray:t.toArray,inArray:t.inArray,addI18n:t.addI18n,translate:t.translate,isEmptyObj:t.isEmptyObj,hasClass:t.hasClass,addClass:t.addClass,removeClass:t.removeClass,getStyle:t.getStyle,addEvent:t.addEvent,removeEvent:t.removeEvent,removeAllEvents:t.removeAllEvents,cleanName:function(e){var t,n;for(n=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],t=0;t<n.length;t+=2)e=e.replace(n[t],n[t+1]);return e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(e,t){var n="";return a.each(t,function(e,t){n+=(n?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),n&&(e+=(e.indexOf("?")>0?"&":"?")+n),e},formatSize:function(e){function t(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}if(e===n||/\D/.test(e))return a.translate("N/A");var i=Math.pow(1024,4);return e>i?t(e/i,1)+" "+a.translate("tb"):e>(i/=1024)?t(e/i,1)+" "+a.translate("gb"):e>(i/=1024)?t(e/i,1)+" "+a.translate("mb"):e>1024?Math.round(e/1024)+" "+a.translate("kb"):e+" "+a.translate("b")},parseSize:t.parseSizeStr,predictRuntime:function(e,n){var i,r;return i=new a.Uploader(e),r=t.Runtime.thatCan(i.getOption().required_features,n||e.runtimes),i.destroy(),r},addFileFilter:function(e,t){o[e]=t}};a.addFileFilter("mime_types",function(e,t,n){e.length&&!e.regexp.test(t.name)?(this.trigger("Error",{code:a.FILE_EXTENSION_ERROR,message:a.translate("File extension error."),file:t}),n(!1)):n(!0)}),a.addFileFilter("max_file_size",function(e,t,n){var i;e=a.parseSize(e),t.size!==i&&e&&t.size>e?(this.trigger("Error",{code:a.FILE_SIZE_ERROR,message:a.translate("File size error."),file:t}),n(!1)):n(!0)}),a.addFileFilter("prevent_duplicates",function(e,t,n){if(e)for(var i=this.files.length;i--;)if(t.name===this.files[i].name&&t.size===this.files[i].size)return this.trigger("Error",{code:a.FILE_DUPLICATE_ERROR,message:a.translate("Duplicate file error."),file:t}),void n(!1);n(!0)}),a.Uploader=function(e){function s(){var e,t,n=0;if(this.state==a.STARTED){for(t=0;t<O.length;t++)e||O[t].status!=a.QUEUED?n++:(e=O[t],this.trigger("BeforeUpload",e)&&(e.status=a.UPLOADING,this.trigger("UploadFile",e)));n==O.length&&(this.state!==a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",O))}}function u(e){e.percent=e.size>0?Math.ceil(e.loaded/e.size*100):100,c()}function c(){var e,t;for(I.reset(),e=0;e<O.length;e++)t=O[e],t.size!==n?(I.size+=t.origSize,I.loaded+=t.loaded*t.origSize/t.size):I.size=n,t.status==a.DONE?I.uploaded++:t.status==a.FAILED?I.failed++:I.queued++;I.size===n?I.percent=O.length>0?Math.ceil(I.uploaded/O.length*100):0:(I.bytesPerSec=Math.ceil(I.loaded/((+new Date-A||1)/1e3)),I.percent=I.size>0?Math.ceil(I.loaded/I.size*100):0)}function l(){var e=N[0]||C[0];return!!e&&e.getRuntime().uid}function d(e,n){if(e.ruid){var i=t.Runtime.getInfo(e.ruid);if(i)return i.can(n)}return!1}function f(){this.bind("FilesAdded FilesRemoved",function(e){e.trigger("QueueChanged"),e.refresh()}),this.bind("CancelUpload",w),this.bind("BeforeUpload",g),this.bind("UploadFile",v),this.bind("UploadProgress",y),this.bind("StateChanged",_),this.bind("QueueChanged",c),this.bind("Error",b),this.bind("FileUploaded",E),this.bind("Destroy",R)}function h(e,n){var i=this,r=0,o=[],s={runtime_order:e.runtimes,required_caps:e.required_features,preferred_caps:D,swf_url:e.flash_swf_url,xap_url:e.silverlight_xap_url};a.each(e.runtimes.split(/\s*,\s*/),function(t){e[t]&&(s[t]=e[t])}),e.browse_button&&a.each(e.browse_button,function(n){o.push(function(o){var u=new t.FileInput(a.extend({},s,{accept:e.filters.mime_types,name:e.file_data_name,multiple:e.multi_selection,container:e.container,browse_button:n}));u.onready=function(){var e=t.Runtime.getInfo(this.ruid);t.extend(i.features,{chunks:e.can("slice_blob"),multipart:e.can("send_multipart"),multi_selection:e.can("select_multiple")}),r++,N.push(this),o()},u.onchange=function(){i.addFile(this.files)},u.bind("mouseenter mouseleave mousedown mouseup",function(i){L||(e.browse_button_hover&&("mouseenter"===i.type?t.addClass(n,e.browse_button_hover):"mouseleave"===i.type&&t.removeClass(n,e.browse_button_hover)),e.browse_button_active&&("mousedown"===i.type?t.addClass(n,e.browse_button_active):"mouseup"===i.type&&t.removeClass(n,e.browse_button_active)))}),u.bind("mousedown",function(){i.trigger("Browse")}),u.bind("error runtimeerror",function(){u=null,o()}),u.init()})}),e.drop_element&&a.each(e.drop_element,function(e){o.push(function(n){var o=new t.FileDrop(a.extend({},s,{drop_zone:e}));o.onready=function(){var e=t.Runtime.getInfo(this.ruid);i.features.dragdrop=e.can("drag_and_drop"),r++,C.push(this),n()},o.ondrop=function(){i.addFile(this.files)},o.bind("error runtimeerror",function(){o=null,n()}),o.init()})}),t.inSeries(o,function(){"function"==typeof n&&n(r)})}function p(e,i,r){var o=new t.Image;try{o.onload=function(){return i.width>this.width&&i.height>this.height&&i.quality===n&&i.preserve_headers&&!i.crop?(this.destroy(),r(e)):void o.downsize(i.width,i.height,i.crop,i.preserve_headers)},o.onresize=function(){r(this.getAsBlob(e.type,i.quality)),this.destroy()},o.onerror=function(){r(e)},o.load(e)}catch(a){r(e)}}function m(e,n,r){function o(e,t,n){var i=x[e];switch(e){case"max_file_size":"max_file_size"===e&&(x.max_file_size=x.filters.max_file_size=t);break;case"chunk_size":(t=a.parseSize(t))&&(x[e]=t,x.send_file_name=!0);break;case"multipart":x[e]=t,t||(x.send_file_name=!0);break;case"unique_names":x[e]=t,t&&(x.send_file_name=!0);break;case"filters":"array"===a.typeOf(t)&&(t={mime_types:t}),n?a.extend(x.filters,t):x.filters=t,t.mime_types&&(x.filters.mime_types.regexp=function(e){var t=[];return a.each(e,function(e){a.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?t.push("\\.*"):t.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+t.join("|")+")$","i")}(x.filters.mime_types));break;case"resize":n?a.extend(x.resize,t,{enabled:!0}):x.resize=t;break;case"prevent_duplicates":x.prevent_duplicates=x.filters.prevent_duplicates=!!t;break;case"browse_button":case"drop_element":t=a.get(t);case"container":case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":x[e]=t,n||(u=!0);break;default:x[e]=t}n||s.trigger("OptionChanged",e,t,i)}var s=this,u=!1;"object"==typeof e?a.each(e,function(e,t){o(t,e,r)}):o(e,n,r),r?(x.required_features=i(a.extend({},x)),D=i(a.extend({},x,{required_features:!0}))):u&&(s.trigger("Destroy"),h.call(s,x,function(e){e?(s.runtime=t.Runtime.getInfo(l()).type,s.trigger("Init",{runtime:s.runtime}),s.trigger("PostInit")):s.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})}))}function g(e,t){if(e.settings.unique_names){var n=t.name.match(/\.([^.]+)$/),i="part";n&&(i=n[1]),t.target_name=t.id+"."+i}}function v(e,n){function i(){l-- >0?r(o,1e3):(n.loaded=h,e.trigger("Error",{code:a.HTTP_ERROR,message:a.translate("HTTP Error."),file:n,response:S.responseText,status:S.status,responseHeaders:S.getAllResponseHeaders()}))}function o(){var d,p,m,g={};n.status===a.UPLOADING&&e.state!==a.STOPPED&&(e.settings.send_file_name&&(g.name=n.target_name||n.name),c&&f.chunks&&s.size>c?(m=Math.min(c,s.size-h),d=s.slice(h,h+m)):(m=s.size,d=s),c&&f.chunks&&(e.settings.send_chunk_number?(g.chunk=Math.ceil(h/c),g.chunks=Math.ceil(s.size/c)):(g.offset=h,g.total=s.size)),S=new t.XMLHttpRequest,S.upload&&(S.upload.onprogress=function(t){n.loaded=Math.min(n.size,h+t.loaded),e.trigger("UploadProgress",n)}),S.onload=function(){return S.status>=400?void i():(l=e.settings.max_retries,m<s.size?(d.destroy(),h+=m,n.loaded=Math.min(h,s.size),e.trigger("ChunkUploaded",n,{offset:n.loaded,total:s.size,response:S.responseText,status:S.status,responseHeaders:S.getAllResponseHeaders()}),"Android Browser"===t.Env.browser&&e.trigger("UploadProgress",n)):n.loaded=n.size,d=p=null,!h||h>=s.size?(n.size!=n.origSize&&(s.destroy(),s=null),e.trigger("UploadProgress",n),n.status=a.DONE,e.trigger("FileUploaded",n,{response:S.responseText,status:S.status,responseHeaders:S.getAllResponseHeaders()})):r(o,1),void 0)},S.onerror=function(){i()},S.onloadend=function(){this.destroy(),S=null},e.settings.multipart&&f.multipart?(S.open("post",u,!0),a.each(e.settings.headers,function(e,t){S.setRequestHeader(t,e)}),p=new t.FormData,a.each(a.extend(g,e.settings.multipart_params),function(e,t){p.append(t,e)}),p.append(e.settings.file_data_name,d),S.send(p,{runtime_order:e.settings.runtimes,required_caps:e.settings.required_features,preferred_caps:D,swf_url:e.settings.flash_swf_url,xap_url:e.settings.silverlight_xap_url})):(u=a.buildUrl(e.settings.url,a.extend(g,e.settings.multipart_params)),S.open("post",u,!0),S.setRequestHeader("Content-Type","application/octet-stream"),a.each(e.settings.headers,function(e,t){S.setRequestHeader(t,e)}),S.send(d,{runtime_order:e.settings.runtimes,required_caps:e.settings.required_features,preferred_caps:D,swf_url:e.settings.flash_swf_url,xap_url:e.settings.silverlight_xap_url})))}var s,u=e.settings.url,c=e.settings.chunk_size,l=e.settings.max_retries,f=e.features,h=0;n.loaded&&(h=n.loaded=c?c*Math.floor(n.loaded/c):0),s=n.getSource(),e.settings.resize.enabled&&d(s,"send_binary_string")&&~t.inArray(s.type,["image/jpeg","image/png"])?p.call(this,s,e.settings.resize,function(e){s=e,n.size=e.size,o()}):o()}function y(e,t){u(t)}function _(e){if(e.state==a.STARTED)A=+new Date;else if(e.state==a.STOPPED)for(var t=e.files.length-1;t>=0;t--)e.files[t].status==a.UPLOADING&&(e.files[t].status=a.QUEUED,c())}function w(){S&&S.abort()}function E(e){c(),r(function(){s.call(e)},1)}function b(e,t){t.code===a.INIT_ERROR?e.destroy():t.code===a.HTTP_ERROR&&(t.file.status=a.FAILED,u(t.file),e.state==a.STARTED&&(e.trigger("CancelUpload"),r(function(){s.call(e)},1)))}function R(e){e.stop(),a.each(O,function(e){e.destroy()}),O=[],N.length&&(a.each(N,function(e){e.destroy()}),N=[]),C.length&&(a.each(C,function(e){e.destroy()}),C=[]),D={},L=!1,A=S=null,I.reset()}var x,A,I,S,T=a.guid(),O=[],D={},N=[],C=[],L=!1;x={runtimes:t.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_file_name:!0,send_chunk_number:!0},m.call(this,e,null,!0),I=new a.QueueProgress,a.extend(this,{id:T,uid:T,state:a.STOPPED,features:{},runtime:null,files:O,settings:x,total:I,init:function(){var e=this;return"function"==typeof x.preinit?x.preinit(e):a.each(x.preinit,function(t,n){e.bind(n,t)}),f.call(this),x.browse_button&&x.url?void h.call(this,x,function(n){"function"==typeof x.init?x.init(e):a.each(x.init,function(t,n){e.bind(n,t)}),n?(e.runtime=t.Runtime.getInfo(l()).type,e.trigger("Init",{runtime:e.runtime}),e.trigger("PostInit")):e.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})}):void this.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})},setOption:function(e,t){m.call(this,e,t,!this.runtime)},getOption:function(e){return e?x[e]:x},refresh:function(){N.length&&a.each(N,function(e){e.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=a.STARTED&&(this.state=a.STARTED,this.trigger("StateChanged"),s.call(this))},stop:function(){this.state!=a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){L=arguments[0]===n||arguments[0],N.length&&a.each(N,function(e){e.disable(L)}),this.trigger("DisableBrowse",L)},getFile:function(e){var t;for(t=O.length-1;t>=0;t--)if(O[t].id===e)return O[t]},addFile:function(e,n){function i(e,n){var i=[];t.each(c.settings.filters,function(t,n){o[n]&&i.push(function(i){o[n].call(c,t,e,function(e){i(!e)})})}),t.inSeries(i,n)}function s(e){var o=t.typeOf(e);if(e instanceof t.File){if(!e.ruid&&!e.isDetached()){if(!u)return!1;e.ruid=u,e.connectRuntime(u)}s(new a.File(e))}else e instanceof t.Blob?(s(e.getSource()),e.destroy()):e instanceof a.File?(n&&(e.name=n),d.push(function(t){i(e,function(n){n||(O.push(e),f.push(e),c.trigger("FileFiltered",e)),r(t,1)})})):t.inArray(o,["file","blob"])!==-1?s(new t.File(null,e)):"node"===o&&"filelist"===t.typeOf(e.files)?t.each(e.files,s):"array"===o&&(n=null,t.each(e,s))}var u,c=this,d=[],f=[];u=l(),s(e),d.length&&t.inSeries(d,function(){f.length&&c.trigger("FilesAdded",f)})},removeFile:function(e){for(var t="string"==typeof e?e:e.id,n=O.length-1;n>=0;n--)if(O[n].id===t)return this.splice(n,1)[0]},splice:function(e,t){var i=O.splice(e===n?0:e,t===n?O.length:t),r=!1;return this.state==a.STARTED&&(a.each(i,function(e){if(e.status===a.UPLOADING)return r=!0,!1}),r&&this.stop()),this.trigger("FilesRemoved",i),a.each(i,function(e){e.destroy()}),r&&this.start(),i},dispatchEvent:function(e){var t,n;if(e=e.toLowerCase(),t=this.hasEventListener(e)){t.sort(function(e,t){return t.priority-e.priority}),n=[].slice.call(arguments),n.shift(),n.unshift(this);for(var i=0;i<t.length;i++)if(t[i].fn.apply(t[i].scope,n)===!1)return!1}return!0},bind:function(e,t,n,i){a.Uploader.prototype.bind.call(this,e,t,i,n)},destroy:function(){this.trigger("Destroy"),x=I=null,this.unbindAll()}})},a.Uploader.prototype=t.EventTarget.instance,a.File=function(){function e(e){a.extend(this,{id:a.guid(),name:e.name||e.fileName,type:e.type||"",size:e.size||e.fileSize,origSize:e.size||e.fileSize,loaded:0,percent:0,status:a.QUEUED,lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var e=this.getSource().getSource();return t.inArray(t.typeOf(e),["blob","file"])!==-1?e:null},getSource:function(){return n[this.id]?n[this.id]:null},destroy:function(){var e=this.getSource();e&&(e.destroy(),delete n[this.id])}}),n[this.id]=e}var n={};return e}(),a.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},e.plupload=a}(window,mOxie);
TOL.Module.browselinks=function(n){return{init:function(){n("#allMakes,#topMakes").click(function(){n("#mkBtn,#mkLnks").toggle(),window.scrollTo(0,0)})}}}(jQuery);
TOL.Module.ContacAtOnce=function(e){var t=function(){"desktop"!=device_detection&&"tablet"!=device_detection||e(".CAOtext").remove(),"mobile"==device_detection&&e(".CAO").remove(),e(".CAO, .CAOtext").each(function(t,a){if("A"!=a.tagName&&(a=e(a).children()[0]),e(a).attr("data-referenceid")){var n=e(a).attr("data-referenceid"),r=e(a).attr("data-lpvars");lpTag.sdk.exec("caoPresence.getPresence",{referenceId:n,engagementId:e(a).attr("data-engref"),onSuccess:function(t){"online"!=t.presenceStatus?TOL.Module.ContacAtOnce.hideChat(a,n):e(a).after('<div id="caoPopIn" style="display:none;" data-cao-referenceid="'+n+'" data-cao-engref="cao-overlay" data-cao-lpvars="'+r+'"></div>')},onError:function(e){TOL.Module.ContacAtOnce.hideChat(a,n)}})}}),e(".chatButton").click(function(){TOL.Module.ContacAtOnce.loadChat(e(this))}),e(".CAOtext").click(function(){TOL.Module.ContacAtOnce.loadText(e(this))})},a=function(t,a){e(t).remove()},n=function(t){lpTag.sdk.exec("caoEngager.startChat",{engagementId:e(t).attr("data-engref"),referenceId:e(t).attr("data-referenceid"),isPopOut:!0,channel:"chat",language:"en-US",lpVars:JSON.parse(e(t).attr("data-lpvars"))})};return loadText=function(t){lpTag.sdk.exec("caoEngager.startChat",{engagementId:e(t).attr("data-engref"),referenceId:e(t).attr("data-referenceid"),isPopOut:!0,channel:"mtc",language:"en-US",mtc:{tapToTextDisabled:!1,phoneNumber:e(t).attr("data-phone"),message:"Please send me more information about the "+e(t).attr("data-title")},lpVars:JSON.parse(e(t).attr("data-lpvars"))})},{init:t,hideChat:a,loadChat:n,loadText:loadText}}(jQuery);
TOL.Tile.DealerGroups=function(e){function n(){var e=new google.maps.Map(document.getElementById("dealerGroupsMap"),{center:{lat:36.851,lng:-76.287},zoom:2}),n=new google.maps.LatLngBounds;for(var o in dealerLocations)try{var a=dealerLocations[o],r=String(a.number);n.extend(a),new google.maps.Marker({position:a,label:r,map:e})}catch(t){}e.fitBounds(n)}return{initMap:n}}(jQuery);
TOL.Tile.DealerListings=function(e){var a=function(){realmDealersTerm=tolConfig.getRealmDealersTerm(),window.location.pathname.search("/"+realmDealersTerm+"/results")==-1&&window.location.pathname.search("/campgrounds/results")==-1&&window.location.pathname.search("/rentals/results")==-1||(e("select#dealersSortSelect").change(t),e(".dealerPage").on("click",".sortSelection",function(){var a=e(this).attr("data-val"),t=null,s=a.split(":");e(this).find("i.fa-sort").length&&(t=s[1]),e(this).find("i.fa-sort-asc").length&&(t="desc"),e(this).find("i.fa-sort-desc").length&&(t="asc"),e(".sortSelection i.fa-sort").removeClass("fa-sort-asc fa-sort-desc"),null!=t&&(a=s[0]+":"+t,e(this).find("i").addClass("fa-sort-"+t)),e(".sortSelection.btn-gray").removeClass("btn-gray").addClass("btn-default"),e(this).removeClass("btn-default").addClass("btn-gray"),TOL.updateParameters({sort:a})}),e("a#pageNext").click(function(){s(1)}),e("a#pagePrev").click(function(){s(-1)}),e(".dealerResults").click(function(a){var t=e(this).data("url");if(null!=t){var s=a.originalEvent.srcElement;if(e(s).hasClass("dealerCallButton")||e(s).parents(".dealerCallButton").length>0)return;location=t}}))},t=function(){TOL.updateParameters({sort:e(this).val()})},s=function(e){var a=parseInt(TOL.getGet("page"))||1;TOL.updateParameters({page:a+e})};return{init:a}}(jQuery);
TOL.Tile.DealerSearch=function(e){function a(e){var a=e?e.split(/\s+/):[];return a.push(e.replace(/ /g,"")),a}var r=function(){realmDealersTerm=tolConfig.getRealmDealersTerm(),window.location.pathname.search("/"+realmDealersTerm)!=-1&&e("#nameText").typeahead({highlight:!0,minLength:3},{name:"dealers",limit:10,source:function(r,n,t){e.ajax({url:"/gettiledata/dealersearch/getdealernames",data:{q:r},dataType:"json",success:function(n,l){var o=[];for(var c in n)o.push(c);var s=new Bloodhound({datumTokenizer:a,queryTokenizer:Bloodhound.tokenizers.whitespace,local:o});r=r.replace(/-/g," "),t([e("#nameText").val()]);var h=[],d=function(e){for(var a in e){var r=!1;for(var n in h)if(h[n]==e[a]){r=!0;break}r||h.push(e[a])}};s.search(r,d,d),s.search(r.replace(" & ","&"),d,d),s.search(r.replace("and","&"),d,d),s.search(r.replace("&","and"),d,d),s.search(r.replace(" and ","&"),d,d);for(i in h)t([h[i]]);e("#nameText").bind("typeahead:select",function(e,a){n[a]&&(location="/"+realmDealersTerm+"/detail/"+encodeURIComponent(a.replace("/","-"))+"-"+n[a])})}})}})};return{init:r}}(jQuery);
TOL.Module.EmailDealer=function(e){return{init:function(){realmDealersTerm=tolConfig.getRealmDealersTerm(),window.location.pathname.search("/"+realmDealersTerm+"/detail/email")!=-1&&e("#submitEmail").click(TOL.Module.EmailDealer.submitEmail)},submitEmail:function(a){a.preventDefault();var t=!0,r="",i={};i.source="PORTAL-AD","mobile"==device_detection?i.source="mobile":"tablet"==device_detection&&(i.source="tablet"),e(":input").each(function(){!e(this).attr("required")||""!=jQuery.trim(e(this).val())&&jQuery.trim(e(this).val())!=e(this).attr("defaultValue")?e(this).attr("validation")&&jQuery.trim(e(this).val()).search("^"+e(this).attr("validation")+"$")==-1?(t=!1,"undefined"!=typeof e(this).attr("defaultValue")?r+=e(this).attr("defaultValue")+" is invalid.\n":(errorText=e(this).attr("placeholder"),r+=errorText.replace("(Required)","")+" is invalid.\n")):e(this).is(":checkbox")?i[e(this).attr("name")]=e(this).is(":checked"):i[e(this).attr("name")]=jQuery.trim(e(this).val()):(t=!1,"undefined"!=typeof e(this).attr("defaultValue")?r+=e(this).attr("defaultValue")+" is required.\n":(errorText=e(this).attr("placeholder"),r+=errorText.replace("(Required)","")+" is required.\n"))}),""!=r?alert(r):(e(this).hide(),e(this).parent().append("<center><i id='ajaxload' class='fa fa-cog fa-spin fa-2x'></i></center>"),goog_report_emailseller(),e.ajax({url:"/Gettiledata/emailseller/sendemail/",type:"POST",data:i,context:e(this).parent(),success:TOL.Module.EmailDealer.emailSellerCallback}))},emailSellerCallback:function(a){e(this).find("#ajaxload").remove();try{a=e.parseJSON(a)}catch(t){a={Errors:["Unknown Error"]}}"undefined"==typeof a.Errors||0==a.Errors.length?(e(this).append("<input type='button' class='submitEmail' value='Message Sent'data-lead-type='Email Lead'data-lead-status='Confirmed'data-lead-cat='Email Dealer from Gallery'>"),TOL.Module.sendSilverPopLeadInfo("Dealer"),window.rec.UTILS.trigger(document.body,"ConfirmedLead",{type:"Email Dealer from Gallery"}),setTimeout('window.location = window.location.href.replace("/email","")',2e3)):(e("#submitEmail").show(),alert(a.Errors[0]))}}}(jQuery);
"function"!=typeof Object.create&&(Object.create=function(e){function t(){}return t.prototype=e,new t}),function(e,t,o){var i={init:function(t,o){var i=this;i.$elem=e(o),i.options=e.extend({},e.fn.featuredCarousel.options,i.$elem.data(),t),i.userOptions=t,i.loadContent()},loadContent:function(){function t(e){var t,o="";if("function"==typeof i.options.jsonSuccess)i.options.jsonSuccess.apply(this,[e]);else{for(t in e.featured)e.featured.hasOwnProperty(t)&&(o+=e.featured[t].item);i.$elem.html(o)}i.logIn()}var o,i=this;"function"==typeof i.options.beforeInit&&i.options.beforeInit.apply(this,[i.$elem]),"string"==typeof i.options.jsonPath?(o=i.options.jsonPath,e.getJSON(o,t)):i.logIn()},logIn:function(){var e=this;e.$elem.css({opacity:0}),e.orignalItems=e.options.items,e.checkBrowser(),e.wrapperWidth=0,e.checkVisible=null,e.setVars()},setVars:function(){var e=this;return 0!==e.$elem.children().length&&(e.baseClass(),e.eventTypes(),e.$userItems=e.$elem.children(),e.itemsAmount=e.$userItems.length,e.wrapItems(),e.$featuredItems=e.$elem.find(".featured-item"),e.$featuredWrapper=e.$elem.find(".featured-wrapper"),e.playDirection="next",e.prevItem=0,e.prevArr=[0],e.currentItem=0,e.customEvents(),void e.onStartup())},onStartup:function(){var e=this;e.updateItems(),e.calculateAll(),e.buildControls(),e.updateControls(),e.response(),e.moveEvents(),e.stopOnHover(),e.featuredStatus(),e.options.transitionStyle!==!1&&e.transitionTypes(e.options.transitionStyle),e.options.autoPlay===!0&&(e.options.autoPlay=5e3),e.play(),e.$elem.find(".featured-wrapper").css("display","block"),e.$elem.is(":visible")?e.$elem.css("opacity",1):e.watchVisibility(),e.onstartup=!1,e.eachMoveUpdate(),"function"==typeof e.options.afterInit&&e.options.afterInit.apply(this,[e.$elem])},eachMoveUpdate:function(){var e=this;e.options.lazyLoad===!0&&e.lazyLoad(),e.options.autoHeight===!0&&e.autoHeight(),e.onVisibleItems(),"function"==typeof e.options.afterAction&&e.options.afterAction.apply(this,[e.$elem])},updateVars:function(){var e=this;"function"==typeof e.options.beforeUpdate&&e.options.beforeUpdate.apply(this,[e.$elem]),e.watchVisibility(),e.updateItems(),e.calculateAll(),e.updatePosition(),e.updateControls(),e.eachMoveUpdate(),"function"==typeof e.options.afterUpdate&&e.options.afterUpdate.apply(this,[e.$elem])},reload:function(){var e=this;t.setTimeout(function(){e.updateVars()},0)},watchVisibility:function(){var e=this;return e.$elem.is(":visible")===!1&&(e.$elem.css({opacity:0}),t.clearInterval(e.autoPlayInterval),t.clearInterval(e.checkVisible),void(e.checkVisible=t.setInterval(function(){e.$elem.is(":visible")&&(e.reload(),e.$elem.animate({opacity:1},200),t.clearInterval(e.checkVisible))},500)))},wrapItems:function(){var e=this;e.$userItems.wrapAll('<div class="featured-wrapper">').wrap('<div class="featured-item"></div>'),e.$elem.find(".featured-wrapper").wrap('<div class="featured-wrapper-outer">'),e.wrapperOuter=e.$elem.find(".featured-wrapper-outer"),e.$elem.css("display","block")},baseClass:function(){var e=this,t=e.$elem.hasClass(e.options.baseClass),o=e.$elem.hasClass(e.options.theme);t||e.$elem.addClass(e.options.baseClass),o||e.$elem.addClass(e.options.theme)},updateItems:function(){var t,o,i=this;if(i.options.responsive===!1)return!1;if(i.options.singleItem===!0)return i.options.items=i.orignalItems=1,i.options.itemsCustom=!1,i.options.itemsDesktop=!1,i.options.itemsDesktopSmall=!1,i.options.itemsTablet=!1,i.options.itemsTabletSmall=!1,i.options.itemsMobile=!1,!1;if(t=e(i.options.responsiveBaseWidth).width(),t>(i.options.itemsDesktop[0]||i.orignalItems)&&(i.options.items=i.orignalItems),i.options.itemsCustom!==!1)for(i.options.itemsCustom.sort(function(e,t){return e[0]-t[0]}),o=0;o<i.options.itemsCustom.length;o+=1)i.options.itemsCustom[o][0]<=t&&(i.options.items=i.options.itemsCustom[o][1]);else t<=i.options.itemsDesktop[0]&&i.options.itemsDesktop!==!1&&(i.options.items=i.options.itemsDesktop[1]),t<=i.options.itemsDesktopSmall[0]&&i.options.itemsDesktopSmall!==!1&&(i.options.items=i.options.itemsDesktopSmall[1]),t<=i.options.itemsTablet[0]&&i.options.itemsTablet!==!1&&(i.options.items=i.options.itemsTablet[1]),t<=i.options.itemsTabletSmall[0]&&i.options.itemsTabletSmall!==!1&&(i.options.items=i.options.itemsTabletSmall[1]),t<=i.options.itemsMobile[0]&&i.options.itemsMobile!==!1&&(i.options.items=i.options.itemsMobile[1]);i.options.items>i.itemsAmount&&i.options.itemsScaleUp===!0&&(i.options.items=i.itemsAmount)},response:function(){var o,i,n=this;return n.options.responsive===!0&&(i=e(t).width(),n.resizer=function(){e(t).width()!==i&&(n.options.autoPlay!==!1&&t.clearInterval(n.autoPlayInterval),t.clearTimeout(o),o=t.setTimeout(function(){i=e(t).width(),n.updateVars()},n.options.responsiveRefreshRate))},void e(t).resize(n.resizer))},updatePosition:function(){var e=this;e.jumpTo(e.currentItem),e.options.autoPlay!==!1&&e.checkAp()},appendItemsSizes:function(){var t=this,o=0,i=t.itemsAmount-t.options.items;t.$featuredItems.each(function(n){var s=e(this);s.css({width:300}).data("featured-item",Number(n)),n%t.options.items!==0&&n!==i||n>i||(o+=1),s.data("featured-roundPages",o)})},appendWrapperSizes:function(){var e=this,t=e.$featuredItems.length*e.itemWidth;e.$featuredWrapper.css({width:2*t,left:0}),e.appendItemsSizes()},calculateAll:function(){var e=this;e.calculateWidth(),e.appendWrapperSizes(),e.loops(),e.max()},calculateWidth:function(){var e=this;e.itemWidth=Math.round(e.$elem.width()/e.options.items)},max:function(){var e=this,t=(e.itemsAmount*e.itemWidth-e.options.items*e.itemWidth)*-1;return e.options.items>e.itemsAmount?(e.maximumItem=0,t=0,e.maximumPixels=0):(e.maximumItem=e.itemsAmount-e.options.items,e.maximumPixels=t),t},min:function(){return 0},loops:function(){var t,o,i,n=this,s=0,a=0;for(n.positionsInArray=[0],n.pagesInArray=[],t=0;t<n.itemsAmount;t+=1)a+=n.itemWidth,n.positionsInArray.push(-a),n.options.scrollPerPage===!0&&(o=e(n.$featuredItems[t]),i=o.data("featured-roundPages"),i!==s&&(n.pagesInArray[s]=n.positionsInArray[t],s=i))},buildControls:function(){var t=this;t.options.navigation!==!0&&t.options.pagination!==!0||(t.featuredControls=e('<div class="featured-controls"/>').toggleClass("clickable",!t.browser.isTouch).appendTo(t.$elem)),t.options.pagination===!0&&t.buildPagination(),t.options.navigation===!0&&t.buildButtons()},buildButtons:function(){var t=this,o=e(".featured-buttons");o.on("touchend.featuredControls mouseup.featuredControls",'a[class^="featured"]',function(o){o.preventDefault(),e(this).hasClass("featured-next")?t.next():t.prev()})},buildPagination:function(){var t=this;t.paginationWrapper=e('<div class="featured-pagination"/>'),t.featuredControls.append(t.paginationWrapper),t.paginationWrapper.on("touchend.featuredControls mouseup.featuredControls",".featured-page",function(o){o.preventDefault(),Number(e(this).data("featured-page"))!==t.currentItem&&t.goTo(Number(e(this).data("featured-page")),!0)})},updatePagination:function(){var t,o,i,n,s,a,r=this;if(r.options.pagination===!1)return!1;for(r.paginationWrapper.html(""),t=0,o=r.itemsAmount-r.itemsAmount%r.options.items,n=0;n<r.itemsAmount;n+=1)n%r.options.items===0&&(t+=1,o===n&&(i=r.itemsAmount-r.options.items),s=e("<div/>",{"class":"featured-page"}),a=e("<span></span>",{text:r.options.paginationNumbers===!0?t:"","class":r.options.paginationNumbers===!0?"featured-numbers":""}),s.append(a),s.data("featured-page",o===n?i:n),s.data("featured-roundPages",t),r.paginationWrapper.append(s));r.checkPagination()},checkPagination:function(){var t=this;return t.options.pagination!==!1&&void t.paginationWrapper.find(".featured-page").each(function(){e(this).data("featured-roundPages")===e(t.$featuredItems[t.currentItem]).data("featured-roundPages")&&(t.paginationWrapper.find(".featured-page").removeClass("active"),e(this).addClass("active"))})},checkNavigation:function(){var e=this;return e.options.navigation!==!1&&void(e.options.rewindNav===!1&&(0===e.currentItem&&0===e.maximumItem?(e.buttonPrev.addClass("disabled"),e.buttonNext.addClass("disabled")):0===e.currentItem&&0!==e.maximumItem?(e.buttonPrev.addClass("disabled"),e.buttonNext.removeClass("disabled")):e.currentItem===e.maximumItem?(e.buttonPrev.removeClass("disabled"),e.buttonNext.addClass("disabled")):0!==e.currentItem&&e.currentItem!==e.maximumItem&&(e.buttonPrev.removeClass("disabled"),e.buttonNext.removeClass("disabled"))))},updateControls:function(){var e=this;e.updatePagination(),e.checkNavigation(),e.featuredControls&&(e.options.items>=e.itemsAmount?e.featuredControls.hide():e.featuredControls.show())},destroyControls:function(){var e=this;e.featuredControls&&e.featuredControls.remove()},next:function(e){var t=this;if(t.isTransition)return!1;if(t.currentItem+=t.options.scrollPerPage===!0?t.options.items:1,t.currentItem>t.maximumItem+(t.options.scrollPerPage===!0?t.options.items-1:0)){if(t.options.rewindNav!==!0)return t.currentItem=t.maximumItem,!1;t.currentItem=0,e="rewind"}t.goTo(t.currentItem,e)},prev:function(e){var t=this;if(t.isTransition)return!1;if(t.options.scrollPerPage===!0&&t.currentItem>0&&t.currentItem<t.options.items?t.currentItem=0:t.currentItem-=t.options.scrollPerPage===!0?t.options.items:1,t.currentItem<0){if(t.options.rewindNav!==!0)return t.currentItem=0,!1;t.currentItem=t.maximumItem,e="rewind"}t.goTo(t.currentItem,e)},goTo:function(e,o,i){var n,s=this;return!s.isTransition&&("function"==typeof s.options.beforeMove&&s.options.beforeMove.apply(this,[s.$elem]),e>=s.maximumItem?e=s.maximumItem:e<=0&&(e=0),s.currentItem=s.featured.currentItem=e,s.options.transitionStyle!==!1&&"drag"!==i&&1===s.options.items&&s.browser.support3d===!0?(s.swapSpeed(0),s.browser.support3d===!0?s.transition3d(s.positionsInArray[e]):s.css2slide(s.positionsInArray[e],1),s.afterGo(),s.singleItemTransition(),!1):(n=s.positionsInArray[e],s.browser.support3d===!0?(s.isCss3Finish=!1,o===!0?(s.swapSpeed("paginationSpeed"),t.setTimeout(function(){s.isCss3Finish=!0},s.options.paginationSpeed)):"rewind"===o?(s.swapSpeed(s.options.rewindSpeed),t.setTimeout(function(){s.isCss3Finish=!0},s.options.rewindSpeed)):(s.swapSpeed("slideSpeed"),t.setTimeout(function(){s.isCss3Finish=!0},s.options.slideSpeed)),s.transition3d(n)):o===!0?s.css2slide(n,s.options.paginationSpeed):"rewind"===o?s.css2slide(n,s.options.rewindSpeed):s.css2slide(n,s.options.slideSpeed),void s.afterGo()))},jumpTo:function(e){var t=this;"function"==typeof t.options.beforeMove&&t.options.beforeMove.apply(this,[t.$elem]),e>=t.maximumItem||e===-1?e=t.maximumItem:e<=0&&(e=0),t.swapSpeed(0),t.browser.support3d===!0?t.transition3d(t.positionsInArray[e]):t.css2slide(t.positionsInArray[e],1),t.currentItem=t.featured.currentItem=e,t.afterGo()},afterGo:function(){var e=this;e.prevArr.push(e.currentItem),e.prevItem=e.featured.prevItem=e.prevArr[e.prevArr.length-2],e.prevArr.shift(0),e.prevItem!==e.currentItem&&(e.checkPagination(),e.checkNavigation(),e.eachMoveUpdate(),e.options.autoPlay!==!1&&e.checkAp()),"function"==typeof e.options.afterMove&&e.prevItem!==e.currentItem&&e.options.afterMove.apply(this,[e.$elem])},stop:function(){var e=this;e.apStatus="stop",t.clearInterval(e.autoPlayInterval)},checkAp:function(){var e=this;"stop"!==e.apStatus&&e.play()},play:function(){var e=this;return e.apStatus="play",e.options.autoPlay!==!1&&(t.clearInterval(e.autoPlayInterval),void(e.autoPlayInterval=t.setInterval(function(){e.next(!0)},e.options.autoPlay)))},swapSpeed:function(e){var t=this;"slideSpeed"===e?t.$featuredWrapper.css(t.addCssSpeed(t.options.slideSpeed)):"paginationSpeed"===e?t.$featuredWrapper.css(t.addCssSpeed(t.options.paginationSpeed)):"string"!=typeof e&&t.$featuredWrapper.css(t.addCssSpeed(e))},addCssSpeed:function(e){return{"-webkit-transition":"all "+e+"ms ease","-moz-transition":"all "+e+"ms ease","-o-transition":"all "+e+"ms ease",transition:"all "+e+"ms ease"}},removeTransition:function(){return{"-webkit-transition":"","-moz-transition":"","-o-transition":"",transition:""}},doTranslate:function(e){return{"-webkit-transform":"translate3d("+e+"px, 0px, 0px)","-moz-transform":"translate3d("+e+"px, 0px, 0px)","-o-transform":"translate3d("+e+"px, 0px, 0px)","-ms-transform":"translate3d("+e+"px, 0px, 0px)",transform:"translate3d("+e+"px, 0px,0px)"}},transition3d:function(e){var t=this;t.$featuredWrapper.css(t.doTranslate(e))},css2move:function(e){var t=this;t.$featuredWrapper.css({left:e})},css2slide:function(e,t){var o=this;o.isCssFinish=!1,o.$featuredWrapper.stop(!0,!0).animate({left:e},{duration:t||o.options.slideSpeed,complete:function(){o.isCssFinish=!0}})},checkBrowser:function(){var e,i,n,s,a=this,r="translate3d(0px, 0px, 0px)",u=o.createElement("div");u.style.cssText="  -moz-transform:"+r+"; -ms-transform:"+r+"; -o-transform:"+r+"; -webkit-transform:"+r+"; transform:"+r,e=/translate3d\(0px, 0px, 0px\)/g,i=u.style.cssText.match(e),n=null!==i&&1===i.length,s="ontouchstart"in t||t.navigator.msMaxTouchPoints,a.browser={support3d:n,isTouch:s}},moveEvents:function(){var e=this;e.options.mouseDrag===!1&&e.options.touchDrag===!1||(e.gestures(),e.disabledEvents())},eventTypes:function(){var e=this,t=["s","e","x"];e.ev_types={},e.options.mouseDrag===!0&&e.options.touchDrag===!0?t=["touchstart.featured mousedown.featured","touchmove.featured mousemove.featured","touchend.featured touchcancel.featured mouseup.featured"]:e.options.mouseDrag===!1&&e.options.touchDrag===!0?t=["touchstart.featured","touchmove.featured","touchend.featured touchcancel.featured"]:e.options.mouseDrag===!0&&e.options.touchDrag===!1&&(t=["mousedown.featured","mousemove.featured","mouseup.featured"]),e.ev_types.start=t[0],e.ev_types.move=t[1],e.ev_types.end=t[2]},disabledEvents:function(){var t=this;t.$elem.on("dragstart.featured",function(e){e.preventDefault()}),t.$elem.on("mousedown.disableTextSelect",function(t){return e(t.target).is("input, textarea, select, option")})},gestures:function(){function i(e){if(void 0!==e.touches)return{x:e.touches[0].pageX,y:e.touches[0].pageY};if(void 0===e.touches){if(void 0!==e.pageX)return{x:e.pageX,y:e.pageY};if(void 0===e.pageX)return{x:e.clientX,y:e.clientY}}}function n(t){"on"===t?(e(o).on(u.ev_types.move,a),e(o).on(u.ev_types.end,r)):"off"===t&&(e(o).off(u.ev_types.move),e(o).off(u.ev_types.end))}function s(o){var s,a=o.originalEvent||o||t.event;if(3===a.which)return!1;if(!(u.itemsAmount<=u.options.items)){if(u.isCssFinish===!1&&!u.options.dragBeforeAnimFinish)return!1;if(u.isCss3Finish===!1&&!u.options.dragBeforeAnimFinish)return!1;u.options.autoPlay!==!1&&t.clearInterval(u.autoPlayInterval),u.browser.isTouch===!0||u.$featuredWrapper.hasClass("grabbing")||u.$featuredWrapper.addClass("grabbing"),u.newPosX=0,u.newRelativeX=0,e(this).css(u.removeTransition()),s=e(this).position(),p.relativePos=s.left,p.offsetX=i(a).x-s.left,p.offsetY=i(a).y-s.top,n("on"),p.sliding=!1,p.targetElement=a.target||a.srcElement}}function a(n){var s,a,r=n.originalEvent||n||t.event;u.newPosX=i(r).x-p.offsetX,u.newPosY=i(r).y-p.offsetY,u.newRelativeX=u.newPosX-p.relativePos,"function"==typeof u.options.startDragging&&p.dragging!==!0&&0!==u.newRelativeX&&(p.dragging=!0,u.options.startDragging.apply(u,[u.$elem])),(u.newRelativeX>8||u.newRelativeX<-8)&&u.browser.isTouch===!0&&(void 0!==r.preventDefault?r.preventDefault():r.returnValue=!1,p.sliding=!0),(u.newPosY>10||u.newPosY<-10)&&p.sliding===!1&&e(o).off("touchmove.featured"),s=function(){return u.newRelativeX/5},a=function(){return u.maximumPixels+u.newRelativeX/5},u.newPosX=Math.max(Math.min(u.newPosX,s()),a()),u.browser.support3d===!0?u.transition3d(u.newPosX):u.css2move(u.newPosX)}function r(o){var i,s,a,r=o.originalEvent||o||t.event;r.target=r.target||r.srcElement,p.dragging=!1,u.browser.isTouch!==!0&&u.$featuredWrapper.removeClass("grabbing"),u.newRelativeX<0?u.dragDirection=u.featured.dragDirection="left":u.dragDirection=u.featured.dragDirection="right",0!==u.newRelativeX&&(i=u.getNewPosition(),u.goTo(i,!1,"drag"),p.targetElement===r.target&&u.browser.isTouch!==!0&&(e(r.target).on("click.disable",function(t){t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault(),e(t.target).off("click.disable")}),s=e._data(r.target,"events").click,a=s.pop(),s.splice(0,0,a))),n("off")}var u=this,p={offsetX:0,offsetY:0,baseElWidth:0,relativePos:0,position:null,minSwipe:null,maxSwipe:null,sliding:null,dargging:null,targetElement:null};u.isCssFinish=!0,u.$elem.on(u.ev_types.start,".featured-wrapper",s)},getNewPosition:function(){var e=this,t=e.closestItem();return t>e.maximumItem?(e.currentItem=e.maximumItem,t=e.maximumItem):e.newPosX>=0&&(t=0,e.currentItem=0),t},closestItem:function(){var t=this,o=t.options.scrollPerPage===!0?t.pagesInArray:t.positionsInArray,i=t.newPosX,n=null;return e.each(o,function(s,a){i-t.itemWidth/20>o[s+1]&&i-t.itemWidth/20<a&&"left"===t.moveDirection()?(n=a,t.options.scrollPerPage===!0?t.currentItem=e.inArray(n,t.positionsInArray):t.currentItem=s):i+t.itemWidth/20<a&&i+t.itemWidth/20>(o[s+1]||o[s]-t.itemWidth)&&"right"===t.moveDirection()&&(t.options.scrollPerPage===!0?(n=o[s+1]||o[o.length-1],t.currentItem=e.inArray(n,t.positionsInArray)):(n=o[s+1],t.currentItem=s+1))}),t.currentItem},moveDirection:function(){var e,t=this;return t.newRelativeX<0?(e="right",t.playDirection="next"):(e="left",t.playDirection="prev"),e},customEvents:function(){var e=this;e.$elem.on("featured.next",function(){e.next()}),e.$elem.on("featured.prev",function(){e.prev()}),e.$elem.on("featured.play",function(t,o){e.options.autoPlay=o,e.play(),e.hoverStatus="play"}),e.$elem.on("featured.stop",function(){e.stop(),e.hoverStatus="stop"}),e.$elem.on("featured.goTo",function(t,o){e.goTo(o)}),e.$elem.on("featured.jumpTo",function(t,o){e.jumpTo(o)})},stopOnHover:function(){var e=this;e.options.stopOnHover===!0&&e.browser.isTouch!==!0&&e.options.autoPlay!==!1&&(e.$elem.on("mouseover",function(){e.stop()}),e.$elem.on("mouseout",function(){"stop"!==e.hoverStatus&&e.play()}))},lazyLoad:function(){var t,o,i,n,s,a=this;if(a.options.lazyLoad===!1)return!1;for(t=0;t<a.itemsAmount;t+=1)o=e(a.$featuredItems[t]),"loaded"!==o.data("featured-loaded")&&(i=o.data("featured-item"),n=o.find(".lazyfeatured"),"string"==typeof n.data("src")?(void 0===o.data("featured-loaded")&&(n.hide(),o.addClass("loading").data("featured-loaded","checked")),s=a.options.lazyFollow!==!0||i>=a.currentItem,s&&i<a.currentItem+a.options.items&&n.length&&a.lazyPreload(o,n)):o.data("featured-loaded","loaded"))},lazyPreload:function(e,o){function i(){e.data("featured-loaded","loaded").removeClass("loading"),o.removeAttr("data-src"),"fade"===a.options.lazyEffect?o.fadeIn(400):o.show(),"function"==typeof a.options.afterLazyLoad&&a.options.afterLazyLoad.apply(this,[a.$elem])}function n(){r+=1,a.completeImg(o.get(0))||s===!0?i():r<=100?t.setTimeout(n,100):i()}var s,a=this,r=0;"DIV"===o.prop("tagName")?(o.css("background-image","url("+o.data("src")+")"),s=!0):o[0].src=o.data("src"),n()},autoHeight:function(){function o(){var o=e(s.$featuredItems[s.currentItem]).height();s.wrapperOuter.css("height",o+"px"),s.wrapperOuter.hasClass("autoHeight")||t.setTimeout(function(){s.wrapperOuter.addClass("autoHeight")},0)}function i(){n+=1,s.completeImg(a.get(0))?o():n<=100?t.setTimeout(i,100):s.wrapperOuter.css("height","")}var n,s=this,a=e(s.$featuredItems[s.currentItem]).find("img");void 0!==a.get(0)?(n=0,i()):o()},completeImg:function(e){var t;return!!e.complete&&(t=typeof e.naturalWidth,"undefined"===t||0!==e.naturalWidth)},onVisibleItems:function(){var t,o=this;for(o.options.addClassActive===!0&&o.$featuredItems.removeClass("active"),o.visibleItems=[],t=o.currentItem;t<o.currentItem+o.options.items;t+=1)o.visibleItems.push(t),o.options.addClassActive===!0&&e(o.$featuredItems[t]).addClass("active");o.featured.visibleItems=o.visibleItems},transitionTypes:function(e){var t=this;t.outClass="featured-"+e+"-out",t.inClass="featured-"+e+"-in"},singleItemTransition:function(){function e(e){return{position:"relative",left:e+"px"}}var t=this,o=t.outClass,i=t.inClass,n=t.$featuredItems.eq(t.currentItem),s=t.$featuredItems.eq(t.prevItem),a=Math.abs(t.positionsInArray[t.currentItem])+t.positionsInArray[t.prevItem],r=Math.abs(t.positionsInArray[t.currentItem])+t.itemWidth/2,u="webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend";t.isTransition=!0,t.$featuredWrapper.addClass("featured-origin").css({"-webkit-transform-origin":r+"px","-moz-perspective-origin":r+"px","perspective-origin":r+"px"}),s.css(e(a,10)).addClass(o).on(u,function(){t.endPrev=!0,s.off(u),t.clearTransStyle(s,o)}),n.addClass(i).on(u,function(){t.endCurrent=!0,n.off(u),t.clearTransStyle(n,i)})},clearTransStyle:function(e,t){var o=this;e.css({position:"",left:""}).removeClass(t),o.endPrev&&o.endCurrent&&(o.$featuredWrapper.removeClass("featured-origin"),o.endPrev=!1,o.endCurrent=!1,o.isTransition=!1)},featuredStatus:function(){var e=this;e.featured={userOptions:e.userOptions,baseElement:e.$elem,userItems:e.$userItems,featuredItems:e.$featuredItems,currentItem:e.currentItem,prevItem:e.prevItem,visibleItems:e.visibleItems,isTouch:e.browser.isTouch,browser:e.browser,dragDirection:e.dragDirection}},clearEvents:function(){var i=this;i.$elem.off(".featured featured mousedown.disableTextSelect"),e(o).off(".featured featured"),e(t).off("resize",i.resizer)},unWrap:function(){var e=this;0!==e.$elem.children().length&&(e.$featuredWrapper.unwrap(),e.$userItems.unwrap().unwrap(),e.featuredControls&&e.featuredControls.remove()),e.clearEvents(),e.$elem.attr("style",e.$elem.data("featured-originalStyles")||"").attr("class",e.$elem.data("featured-originalClasses"))},destroy:function(){var e=this;e.stop(),t.clearInterval(e.checkVisible),e.unWrap(),e.$elem.removeData()},reinit:function(t){var o=this,i=e.extend({},o.userOptions,t);o.unWrap(),o.init(i,o.$elem)}};e.fn.featuredCarousel=function(t){return this.each(function(){if(e(this).data("featured-init")===!0)return!1;e(this).data("featured-init",!0);var o=Object.create(i);o.init(t,this),e.data(this,"featuredCarousel",o)})},e.fn.featuredCarousel.options={items:5,itemsCustom:!1,itemsDesktop:[1199,4],itemsDesktopSmall:[979,3],itemsTablet:[768,2],itemsTabletSmall:!1,itemsMobile:[479,1],singleItem:!1,itemsScaleUp:!1,slideSpeed:200,paginationSpeed:800,rewindSpeed:1e3,autoPlay:!1,stopOnHover:!1,navigation:!1,navigationText:["prev","next"],rewindNav:!0,scrollPerPage:!1,pagination:!0,paginationNumbers:!1,responsive:!0,responsiveRefreshRate:200,responsiveBaseWidth:t,baseClass:"featured-carousel",theme:"featured-theme",lazyLoad:!1,lazyFollow:!0,lazyEffect:"fade",autoHeight:!1,jsonPath:!1,jsonSuccess:!1,dragBeforeAnimFinish:!0,mouseDrag:!0,touchDrag:!0,addClassActive:!1,transitionStyle:!1,beforeUpdate:!1,afterUpdate:!1,beforeInit:!1,afterInit:!1,beforeMove:!1,afterMove:!1,afterAction:!1,startDragging:!1,afterLazyLoad:!1}}(jQuery,window,document);
TOL.Module.Footer=function(t){return{init:function(){t(".newsletterSignup").click(function(){var e=t(this).parent().find("input[name='newsletter-email']").val();e.length>0&&e.match(/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/)?t.ajax({url:"/Gettiledata/newslettersubscription/addsubscription/",type:"POST",data:{emailAddress:e},success:function(e){t("input[name='newsletter-email']").parent().html("Thanks for signing up!"),t(".newsletterSignup").hide()}}):alert("Invalid email address")}),t(".footerLink").click(function(e){t(e.originalEvent.srcElement).hasClass("footerLink")&&(window.location=t(this).find("a:first").attr("href"))})}}}(jQuery);
function handleBlackBerryLocationTimeout(){bb_blackberryTimeout_id!=-1&&bb_error({message:"Timeout error",code:3})}function handleBlackBerryLocation(){if(clearTimeout(bb_blackberryTimeout_id),bb_blackberryTimeout_id=-1,bb_success&&bb_error){if(0==blackberry.location.latitude&&0==blackberry.location.longitude)bb_error({message:"Position unavailable",code:2});else{var e=null;blackberry.location.timestamp&&(e=new Date(blackberry.location.timestamp)),bb_success({timestamp:e,coords:{latitude:blackberry.location.latitude,longitude:blackberry.location.longitude}})}bb_success=null,bb_error=null}}!function(){if(!window.google||!google.gears){var e=null;if("undefined"!=typeof GearsFactory)e=new GearsFactory;else try{e=new ActiveXObject("Gears.Factory"),e.getBuildInfo().indexOf("ie_mobile")!=-1&&e.privateSetGlobalObject(this)}catch(o){"undefined"!=typeof navigator.mimeTypes&&navigator.mimeTypes["application/x-googlegears"]&&(e=document.createElement("object"),e.style.display="none",e.width=0,e.height=0,e.type="application/x-googlegears",document.documentElement.appendChild(e),e&&"undefined"==typeof e.create&&(e=null))}e&&(window.google||(google={}),google.gears||(google.gears={factory:e}))}}();var bb_success,bb_error,bb_blackberryTimeout_id=-1,geo_position_js=function(){var e={},o=null,t="undefined";return e.getCurrentPosition=function(e,t,i){o.getCurrentPosition(e,t,i)},e.init=function(){try{if(typeof geo_position_js_simulator!=t)o=geo_position_js_simulator;else if(typeof bondi!=t&&typeof bondi.geolocation!=t)o=bondi.geolocation;else if(typeof navigator.geolocation!=t)o=navigator.geolocation,e.getCurrentPosition=function(e,i,r){function a(o){e(typeof o.latitude!=t?{timestamp:o.timestamp,coords:{latitude:o.latitude,longitude:o.longitude}}:o)}o.getCurrentPosition(a,i,r)};else if(typeof window.blackberry!=t&&blackberry.location.GPSSupported){if(typeof blackberry.location.setAidMode==t)return!1;blackberry.location.setAidMode(2),e.getCurrentPosition=function(e,o,t){bb_success=e,bb_error=o,bb_blackberryTimeout_id=t.timeout?setTimeout("handleBlackBerryLocationTimeout()",t.timeout):setTimeout("handleBlackBerryLocationTimeout()",6e4),blackberry.location.onLocationUpdate("handleBlackBerryLocation()"),blackberry.location.refreshLocation()},o=blackberry.location}else typeof window.google!=t&&typeof google.gears!=t?o=google.gears.factory.create("beta.geolocation"):typeof Mojo!=t&&"Mojo.Service.Request"!=typeof Mojo.Service.Request?(o=!0,e.getCurrentPosition=function(e,o,t){parameters={},t&&(t.enableHighAccuracy&&1==t.enableHighAccuracy&&(parameters.accuracy=1),t.maximumAge&&(parameters.maximumAge=t.maximumAge),t.responseTime&&(t.responseTime<5?parameters.responseTime=1:t.responseTime<20?parameters.responseTime=2:parameters.timeout=3)),r=new Mojo.Service.Request("palm://com.palm.location",{method:"getCurrentPosition",parameters:parameters,onSuccess:function(o){e({timestamp:o.timestamp,coords:{latitude:o.latitude,longitude:o.longitude,heading:o.heading}})},onFailure:function(e){o(1==e.errorCode?{code:3,message:"Timeout"}:2==e.errorCode?{code:2,message:"Position Unavailable"}:{code:0,message:"Unknown Error: webOS-code"+errorCode})}})}):typeof device!=t&&typeof device.getServiceObject!=t&&(o=device.getServiceObject("Service.Location","ILocation"),e.getCurrentPosition=function(e,t,i){function r(o,i,r){4==i?t({message:"Position unavailable",code:2}):e({timestamp:null,coords:{latitude:r.ReturnValue.Latitude,longitude:r.ReturnValue.Longitude,altitude:r.ReturnValue.Altitude,heading:r.ReturnValue.Heading}})}var a=new Object;a.LocationInformationClass="BasicLocationInformation",o.ILocation.GetLocation(a,r)})}catch(i){return typeof console!=t&&console.log(i),!1}return null!=o},e}();
TOL.Module.geoLocate=function(e,t){var o=!1;return{geoCallBack:function(e){var a=t("input[name='lat']"),i=t("input[name='long']"),n={};o=!0,a.length&&(a.val(e.coords.latitude),n.latitude=e.coords.latitude),i.length&&(i.val(e.coords.longitude),n.longitude=e.coords.longitude);var l=t("#zip_code");l.length&&!t(l).is(":focus")&&(l.val("Near Me"),l.attr("defaultValue","Near Me"),TOL.cookie.set("location",JSON.stringify(n),365)),"/"==window.location.pathname&&(TOL.Module.geoLocate.getFeaturedListings(e.coords.latitude,e.coords.longitude),"desktop"!==device_detection&&TOL.Module.Mainsearch.loadHomePageAdvertising())},notgeolocation:function(){if(0==o){var e=TOL.cookie.get("location"),t="",a="";if(e){var i=JSON.parse(e);i.latitude&&i.longitude&&(t=i.latitude,a=i.longitude)}TOL.Module.geoLocate.getFeaturedListings(t,a)}},init:function(){realmDealersTerm=tolConfig.getRealmDealersTerm();var t=new RegExp("^/"+realmDealersTerm+"/?$");window.location.pathname.search(t)==-1&&"/"!=window.location.pathname||"desktop"==device_detection||(navigator.geolocation&&(e.init(),e.getCurrentPosition(TOL.Module.geoLocate.geoCallBack)),setTimeout(function(){TOL.Module.geoLocate.notgeolocation()},2e3))},getFeaturedListings:function(e,o){var a={};null!=e&&null!=o&&(a={lat:e,"long":o}),t.ajax({url:"/gettiledata/listingsFeatured/featuredListings",data:a,success:function(e){t("#listingsFeatured").html(e),TOL.Module.Listings.featuredCarousel(),t("#listingsFeatured").trigger("featured-carousel-refresh")}})},featuredListings:function(){navigator.geolocation&&e.getCurrentPosition(TOL.Module.geoLocate.getFeaturedListings)}}}(geo_position_js,jQuery);
TOL.Module.Gigya=function(e){function i(){return t?(g||(g=e.getScript("https://cdns.gigya.com/js/gigya.js?apiKey="+t,function(){gigya.services.socialize.addEventHandlers({},{onLogin:function(e){var i=e.user;"undefined"!=typeof i&&"function"==typeof n&&n(i)}})})),g):e.Deferred().promise()}var n,o=e("#gigyaSiteName").val(),t=e("#gigyaApiKey").val(),s={siteName:o,enabledProviders:"facebook, googleplus",signIDs:"true"},a={version:2,showTermsLink:"false",height:40,width:"100%",containerID:"gigyaLogin",buttonsStyle:"signInWith",autoDetectUserProviders:"",hideGigyaLink:!0,facepilePosition:"none"},g=null;return{showUi:function(e){n=e,i().then(function(){gigya.services.socialize.showLoginUI(s,a)})}}}(jQuery);
TOL.Module.GPTAjax=function(e){return{reloadAds:function(o){"undefined"!=typeof googletag&&googletag&&googletag.apiReady&&e.ajax({url:"/Gettiledata/googletag/getQuery",data:o,dataType:"json",success:function(o){deployads.push(function(){console.log("DFP destroySlots"),deployads.gpt.destroySlots()}),googletag.pubads().clearTargeting(),TOL.Module.GoogleAdsInit.defineSlots(),e.each(o,function(e,o){googletag.pubads().setTargeting(e,o)}),deployads.push(function(){console.log("DFP pubadsRefresh"),deployads.gpt.pubadsRefresh(null)})}})}}}(jQuery);
TOL.Module.Index=function(e){function t(){var t=tolConfig.typeIconPopover().types;for(var a in t)t&&e("li."+a).attr({"data-content":t[a],"data-toggle":"popover","data-trigger":"hover","data-placement":"top"})}function a(){if(window.localStorage&&window.localStorage.history){var t=localStorage.history.split(",");t.reverse(),e.ajax({url:"/recent-searches",method:"POST",data:{recentSearches:t},success:function(t){var a="<ol>";for(var i in t)a+='<li><a href="'+t[i].url+"?zmc=recentsLink"+(1+parseInt(i))+'">'+t[i].text+"</a></li>";a+="</ol>",e(".recents").attr("data-content",a).removeClass("hide")}})}}var i=function(){if("/"==window.location.pathname){if(a(),"mobile"!=device_detection&&t(),e('[data-toggle="popover"]').popover(),e("#index-search-form").submit(function(){e("#submit_button i").removeClass("fa-arrow-right").addClass("fa-gear fa-spin"),e(this).children(':input[value=""]').attr("disabled","disabled"),e("#zip_code").val()||(e("#zip_code").attr("disabled","disabled"),e("select[name='radius']").attr("disabled","disabled"))}),e(".browse-btns a").click(function(){e(".browse-btns a").removeClass("bold"),e(this).addClass("bold"),e("#browse-section ul").addClass("hide"),e("#browse-section ul"+e(this).data("target")).removeClass("hide")}),"desktop"==device_detection){var i=TOL.cookie.get("location");if(i){var n=JSON.parse(i);e("#zip_code").val(n.zipCode)}o()}else s();e("#keyword").keydown(function(t){if(13==t.keyCode)return e("#sugs").hide(),!1}),"desktop"!=device_detection&&e("#index-search-form").append('<input type="hidden" name="sort" value="distance:asc" />')}},o=function(){var t={device_detection:"desktop"};e.ajax({url:"/gettiledata/listingsFeatured/featuredListings",data:t,success:function(t){e("#listingsFeatured").html(t),TOL.Module.Listings.featuredCarousel()}})},s=function(){e(".useMyLocation").click(function(){TOL.Module.geoLocate.featuredListings()})};return{priority:"last",init:i}}(jQuery);
TOL.Module.IndexSearch=function(e){function t(){e(this).hasClass("type-selected")?(e(this).removeClass("type-selected"),e(this).find("i").removeClass("fa-check"),e("#classSelect").val("")):(e(".checkable li").removeClass("type-selected"),e(".checkable li i").removeClass("fa-check"),e(this).addClass("type-selected"),e(this).find("i").addClass("fa-check"),e("#classSelect").val(e(this).attr("data-typevalue"))),o()}var a={},l=function(){3==tolConfig.getRealmId()&&"/"==window.location.pathname&&(e("#submit_button_advanced").click(r),e("#index-search-form").submit(r),e(".checkable li").click(t),o(),e("#makeSelect").click(function(){""!=e(this).val()?(e("#modelText").val(""),e("#modelText").attr("placeholder","Enter a Model")):e("#modelText").attr("placeholder","Enter a Keyword"),e("#sugs").hide()}))},o=function(){var t=e("#makeSelect"),l=t.find("option:first").text();t.find("option").remove(),t.find("optgroup").remove(),t.append('<option value="">'+l+"</option>");var o=e("#classSelect").val();if(o.search("\\|")!=-1){var r=o.split("|");o=4==r.length?r[2]:r[1]}if(topMakes&&topMakes[o]&&topMakes[o].length){var i=e("<optgroup />");i.attr("label","Top Makes"),topMakes[o].sort(function(e,t){return e.name.toLowerCase().localeCompare(t.name.toLowerCase())});for(var s in topMakes[o])i.append('<option value="'+topMakes[o][s].name+"|"+topMakes[o][s].id+'">'+topMakes[o][s].name+"</option>");t.append(i)}var n=e("<optgroup />");n.attr("label","All Makes"),o&&(allMakes[o]=allMakes[o].concat(allMakes[0])),allMakes[o].sort(function(e,t){return e.name.toLowerCase().localeCompare(t.name.toLowerCase())});for(var s in allMakes[o])n.append('<option value="'+allMakes[o][s].name+"|"+allMakes[o][s].id+'">'+allMakes[o][s].name+"</option>");t.append(n),a.make&&t.find('option[value="'+a.make+'"]').attr("selected",!0)},r=function(){e("#submit_button i").removeClass("fa-arrow-right").addClass("fa-gear fa-spin");var t=e("#index-search-form"),a={},l=e(t).find(":input"),o=e("#zip_code").val(),r={},i=TOL.Module.Keywordsearch.getAutocompleteURL(),s="";setKeywordQuery=function(e){if("category"==e[0]&&(e[0]="type",checkCombinedKeyword(e[1]))){var t=splitTypeCategory(e[1]);e[1]=t[0],a.category=t[1]}a[e[0]]=e[1]};for(var n=0;n<l.length;n++)if(""!=e(l[n]).val()){if(s=e(l[n]).attr("name"),void 0==s)continue;switch(l[n].type){case"select-one":case"hidden":case"text":case"number":case"tel":if("zip"===s&&"Near Me"===e(l[n]).val())break;if("model"===s&&0!=i.length)break;if(""!=e(l[n]).val()&&0!=e(l[n]).val()){var p=e(l[n]).val().split("|");5==p.length?(a.type=p[1]+"|"+p[2],a.category=p[3]+"|"+p[4]):4==p.length?(a.type=p[0]+"|"+p[2],"1049212410"!==p[2]&&(a.category=p[1]+"|"+p[3])):("model"==s&&""==e("#makeSelect").val()&&(s="keyword"),a[s]=e.trim(e(l[n]).val()))}}}if(!(void 0==o||e.isNumeric(o)&&5==o.length||""==o||"Near Me"==o))return alert("Invalid Zip"),!1;r.zipCode=o,TOL.cookie.set("location",JSON.stringify(r),365),""==o&&delete a.radius;var c=[],d=[];if(""!=a.type&&(c=a.type),""!=a.make&&(d=a.make),TOL.cookie.set("homepageForm",JSON.stringify({type:c||null,make:d||null})),e('select[id^="type"]').length)a.type=e('select[id^="type"]').val();else{var u=e(".checkable .type-selected");if(u.length>0&&u.attr("data-typevalue").length>0){var v=u.attr("data-typevalue").split("|");if(5==tolConfig.getRealmId()&&4==v.length){var m=v[0]+"|"+v[2]+","+v[1]+"|"+v[3];a.type=m}else if(3==tolConfig.getRealmId()&&4==v.length){var m=v[0]+"|"+v[2],f=v[1]+"|"+v[3];a.type=m,a.category=f}else a.type=u.attr("data-typevalue")}}if(""!==i){parseAutocomplete=i.split("&");for(var n in parseAutocomplete)setKeywordQuery(parseAutocomplete[n].split("="))}else{var y=TOL.Module.Keywordsearch.getSolrData(),h=e("#modelText").val().toLowerCase();for(n in y)if(solrText=y[n].text.toLowerCase(),solrText==h){solrQuery=y[n].query,parseAutocomplete=solrQuery.split("&");for(var n in parseAutocomplete)setKeywordQuery(parseAutocomplete[n].split("="));break}}return""!=a.model&&void 0==a.trim&&(a.modelkeyword=1),location="rvs-for-sale?"+e.param(a),!1};return checkCombinedKeyword=function(e){var t=["644248182","644248181","644248821"],a=e.split("|")[1];return!!t.includes(a)},splitTypeCategory=function(e){var t=e.split("|")[1];return 644248182==t?["Toy Hauler|139350904","Travel Trailer|644248182"]:644248181==t?["Toy Hauler|139350904","Fifth Wheel|644248181"]:644248821==t?["Fifth Wheel|198070","Horse/Livestock Trailer|644248821"]:void 0},{priority:"last",init:l}}(jQuery);
!function(t){t.fn.ocupload=function(e){return new t.ocupload(this,e)},t.ocupload=function(e,n){var o=this,a=(new Date).getTime().toString().substr(8),n=t.extend({name:"file",enctype:"multipart/form-data",action:"",autosubmit:!0,params:{},hover:{},onSubmit:function(){},onComplete:function(){},onSelect:function(){}},n),i=t('<iframe id="iframe'+a+'" name="iframe'+a+'" ></iframe>').css({display:"none"}),r=t('<form method="post" enctype="'+n.enctype+'" action="'+n.action+'" target="iframe'+a+'"></form>').css({margin:0,padding:0});window.chrome&&r.css({margin:15});var c=t('<input name="'+n.name+'" type="file" accept="video/*" capture="camera" />').css({position:"relative",display:"block",opacity:0,cursor:"pointer"});e.wrap("<div></div>"),r.append(c),e.after(r),e.after(i);var u=e.parent().css({position:"relative",height:e.outerHeight()+"px",width:e.outerWidth()+"px",overflow:"hidden",cursor:"pointer",margin:0,padding:0});c.css("marginTop",-u.height()-10+"px"),window.chrome&&c.css("marginLeft",-u.height()-10+"px"),t.extend(this,{_autosubmit:n.autosubmit,_params:n.params,_hover:n.hover,_hover_default:{},onComplete:n.onComplete,onSubmit:n.onSubmit,onSelect:n.onSelect,getFilename:function(){return c.attr("value")},setName:function(t){c.attr("name",t)},getName:function(t){return c.attr("name")},setAction:function(t){r.attr("action",t)},getAction:function(t){return r.attr("action")},setEnctype:function(t){r.attr("enctype",t)},getEnctype:function(t){return r.attr("enctype")},setParams:function(e){this._params=t.extend(this.params,e)},getParams:function(){return this._params},setAutosubmit:function(t){this._autosubmit=t},getAutosubmit:function(){return this._autosubmit},setHover:function(n){this._hover=t.extend(this._hover,n),t.each(this._hover,function(t,n){o._hover_default[t]=e.css(t)})},getHover:function(){return this._hover},set:function(e,n){function a(t,e){switch(t){default:throw new Error("[jQuery.ocupload.set] '"+t+"' is an invalid option.");case"name":o.setName(e);break;case"action":o.setAction(e);break;case"enctype":o.setEnctype(e);break;case"params":o.setParams(e);break;case"hover":o.setHover(e);break;case"autosubmit":o.setAutosubmit(e);break;case"onSubmit":o.onSubmit=e;break;case"onComplete":o.onComplete=e;break;case"onSelect":o.onSelect=e}}var n=!!n&&n;n?a(e,n):t.each(e,function(t,e){a(t,e)})},get:function(t){switch(t){default:throw new Error("[jQuery.ocupload.set] '"+t+"' is an invalid option.");case"name":return o.getName();case"action":return o.getAction();case"enctype":return o.getEnctype();case"params":return o.getParams();case"hover":return o.getHover();case"autosubmit":return o.getAutosubmit();case"onSubmit":return o.onSubmit;case"onComplete":return o.onComplete;case"onSelect":return o.onSelect}},submit:function(){this.onSubmit(),t.each(o._params,function(e,n){r.append(t('<input type="hidden" name="'+e+'" value="'+n+'" />'))}),r.get(0).submit(),i.unbind().load(function(){var e=document.getElementById(i.attr("name")),n="";try{n=t(e.contentWindow.document.body).text()}catch(a){}o.onComplete(n)})}}),t.each(this._hover,function(t,n){o._hover_default[t]=e.css(t)}),u.hover(function(){t.each(o._hover,function(t,n){e.css(t,n)}),u.css({height:e.outerHeight()+"px",width:e.outerWidth()+"px"})},function(){t.each(o._hover,function(t,n){e.css(t,o._hover_default[t])}),u.css({height:e.outerHeight()+"px",width:e.outerWidth()+"px"})}),c.change(function(){o.onSelect(),o._autosubmit&&o.submit()})}}(jQuery);
"use strict";window.jscolor||(window.jscolor=function(){var e={register:function(){e.attachDOMReadyEvent(e.init),e.attachEvent(document,"mousedown",e.onDocumentMouseDown),e.attachEvent(document,"touchstart",e.onDocumentTouchStart),e.attachEvent(window,"resize",e.onWindowResize)},init:function(){e.jscolor.lookupClass&&e.jscolor.installByClassName(e.jscolor.lookupClass)},tryInstallOnElements:function(t,n){for(var r=new RegExp("(^|\\s)("+n+")(\\s*(\\{[^}]*\\})|\\s|$)","i"),o=0;o<t.length;o+=1)if(void 0===t[o].type||"color"!=t[o].type.toLowerCase()||!e.isColorAttrSupported){var i;if(!t[o].jscolor&&t[o].className&&(i=t[o].className.match(r))){var s=t[o],l=null,a=e.getDataAttr(s,"jscolor");null!==a?l=a:i[4]&&(l=i[4]);var d={};if(l)try{d=new Function("return ("+l+")")()}catch(c){e.warn("Error parsing jscolor options: "+c+":\n"+l)}s.jscolor=new e.jscolor(s,d)}}},isColorAttrSupported:function(){var e=document.createElement("input");return!(!e.setAttribute||(e.setAttribute("type","color"),"color"!=e.type.toLowerCase()))}(),isCanvasSupported:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),fetchElement:function(e){return"string"==typeof e?document.getElementById(e):e},isElementType:function(e,t){return e.nodeName.toLowerCase()===t.toLowerCase()},getDataAttr:function(e,t){var n="data-"+t,r=e.getAttribute(n);return null!==r?r:null},attachEvent:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},detachEvent:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},_attachedGroupEvents:{},attachGroupEvent:function(t,n,r,o){e._attachedGroupEvents.hasOwnProperty(t)||(e._attachedGroupEvents[t]=[]),e._attachedGroupEvents[t].push([n,r,o]),e.attachEvent(n,r,o)},detachGroupEvents:function(t){if(e._attachedGroupEvents.hasOwnProperty(t)){for(var n=0;n<e._attachedGroupEvents[t].length;n+=1){var r=e._attachedGroupEvents[t][n];e.detachEvent(r[0],r[1],r[2])}delete e._attachedGroupEvents[t]}},attachDOMReadyEvent:function(e){var t=!1,n=function(){t||(t=!0,e())};if("complete"===document.readyState)return void setTimeout(n,1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),n())}),window.attachEvent("onload",n),document.documentElement.doScroll&&window==window.top)){var r=function(){if(document.body)try{document.documentElement.doScroll("left"),n()}catch(e){setTimeout(r,1)}};r()}},warn:function(e){window.console&&window.console.warn&&window.console.warn(e)},preventDefault:function(e){e.preventDefault&&e.preventDefault(),e.returnValue=!1},captureTarget:function(t){t.setCapture&&(e._capturedTarget=t,e._capturedTarget.setCapture())},releaseTarget:function(){e._capturedTarget&&(e._capturedTarget.releaseCapture(),e._capturedTarget=null)},fireEvent:function(e,t){if(e)if(document.createEvent){var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0),e.dispatchEvent(n)}else if(document.createEventObject){var n=document.createEventObject();e.fireEvent("on"+t,n)}else e["on"+t]&&e["on"+t]()},classNameToList:function(e){return e.replace(/^\s+|\s+$/g,"").split(/\s+/)},hasClass:function(e,t){return!!t&&-1!=(" "+e.className.replace(/\s+/g," ")+" ").indexOf(" "+t+" ")},setClass:function(t,n){for(var r=e.classNameToList(n),o=0;o<r.length;o+=1)e.hasClass(t,r[o])||(t.className+=(t.className?" ":"")+r[o])},unsetClass:function(t,n){for(var r=e.classNameToList(n),o=0;o<r.length;o+=1){var i=new RegExp("^\\s*"+r[o]+"\\s*|\\s*"+r[o]+"\\s*$|\\s+"+r[o]+"(\\s+)","g");t.className=t.className.replace(i,"$1")}},getStyle:function(e){return window.getComputedStyle?window.getComputedStyle(e):e.currentStyle},setStyle:function(){var e=document.createElement("div"),t=function(t){for(var n=0;n<t.length;n+=1)if(t[n]in e.style)return t[n]},n={borderRadius:t(["borderRadius","MozBorderRadius","webkitBorderRadius"]),boxShadow:t(["boxShadow","MozBoxShadow","webkitBoxShadow"])};return function(e,t,r){switch(t.toLowerCase()){case"opacity":var o=Math.round(100*parseFloat(r));e.style.opacity=r,e.style.filter="alpha(opacity="+o+")";break;default:e.style[n[t]]=r}}}(),setBorderRadius:function(t,n){e.setStyle(t,"borderRadius",n||"0")},setBoxShadow:function(t,n){e.setStyle(t,"boxShadow",n||"none")},getElementPos:function(t,n){var r=0,o=0,i=t.getBoundingClientRect();if(r=i.left,o=i.top,!n){var s=e.getViewPos();r+=s[0],o+=s[1]}return[r,o]},getElementSize:function(e){return[e.offsetWidth,e.offsetHeight]},getAbsPointerPos:function(e){e||(e=window.event);var t=0,n=0;return"undefined"!=typeof e.changedTouches&&e.changedTouches.length?(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY):"number"==typeof e.clientX&&(t=e.clientX,n=e.clientY),{x:t,y:n}},getRelPointerPos:function(e){e||(e=window.event);var t=e.target||e.srcElement,n=t.getBoundingClientRect(),r=0,o=0,i=0,s=0;return"undefined"!=typeof e.changedTouches&&e.changedTouches.length?(i=e.changedTouches[0].clientX,s=e.changedTouches[0].clientY):"number"==typeof e.clientX&&(i=e.clientX,s=e.clientY),r=i-n.left,o=s-n.top,{x:r,y:o}},getViewPos:function(){var e=document.documentElement;return[(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0),(window.pageYOffset||e.scrollTop)-(e.clientTop||0)]},getViewSize:function(){var e=document.documentElement;return[window.innerWidth||e.clientWidth,window.innerHeight||e.clientHeight]},redrawPosition:function(){if(e.picker&&e.picker.owner){var t,n,r=e.picker.owner;r.fixed?(t=e.getElementPos(r.targetElement,!0),n=[0,0]):(t=e.getElementPos(r.targetElement),n=e.getViewPos());var o,i,s,l=e.getElementSize(r.targetElement),a=e.getViewSize(),d=e.getPickerOuterDims(r);switch(r.position.toLowerCase()){case"left":o=1,i=0,s=-1;break;case"right":o=1,i=0,s=1;break;case"top":o=0,i=1,s=-1;break;default:o=0,i=1,s=1}var c=(l[i]+d[i])/2;if(r.smartPosition)var h=[-n[o]+t[o]+d[o]>a[o]&&-n[o]+t[o]+l[o]/2>a[o]/2&&t[o]+l[o]-d[o]>=0?t[o]+l[o]-d[o]:t[o],-n[i]+t[i]+l[i]+d[i]-c+c*s>a[i]?-n[i]+t[i]+l[i]/2>a[i]/2&&t[i]+l[i]-c-c*s>=0?t[i]+l[i]-c-c*s:t[i]+l[i]-c+c*s:t[i]+l[i]-c+c*s>=0?t[i]+l[i]-c+c*s:t[i]+l[i]-c-c*s];else var h=[t[o],t[i]+l[i]-c+c*s];var p=h[o],u=h[i],m=r.fixed?"fixed":"absolute",v=(h[0]+d[0]>t[0]||h[0]<t[0]+l[0])&&h[1]+d[1]<t[1]+l[1];e._drawPosition(r,p,u,m,v)}},_drawPosition:function(t,n,r,o,i){var s=i?0:t.shadowBlur;e.picker.wrap.style.position=o,e.picker.wrap.style.left=n+"px",e.picker.wrap.style.top=r+"px",e.setBoxShadow(e.picker.boxS,t.shadow?new e.BoxShadow(0,s,t.shadowBlur,0,t.shadowColor):null)},getPickerDims:function(t){var n=!!e.getSliderComponent(t),r=[2*t.insetWidth+2*t.padding+t.width+(n?2*t.insetWidth+e.getPadToSliderPadding(t)+t.sliderSize:0),2*t.insetWidth+2*t.padding+t.height+(t.closable?2*t.insetWidth+t.padding+t.buttonHeight:0)];return r},getPickerOuterDims:function(t){var n=e.getPickerDims(t);return[n[0]+2*t.borderWidth,n[1]+2*t.borderWidth]},getPadToSliderPadding:function(e){return Math.max(e.padding,1.5*(2*e.pointerBorderWidth+e.pointerThickness))},getPadYComponent:function(e){switch(e.mode.charAt(1).toLowerCase()){case"v":return"v"}return"s"},getSliderComponent:function(e){if(e.mode.length>2)switch(e.mode.charAt(2).toLowerCase()){case"s":return"s";case"v":return"v"}return null},onDocumentMouseDown:function(t){t||(t=window.event);var n=t.target||t.srcElement;n._jscLinkedInstance?n._jscLinkedInstance.showOnClick&&n._jscLinkedInstance.show():n._jscControlName?e.onControlPointerStart(t,n,n._jscControlName,"mouse"):e.picker&&e.picker.owner&&e.picker.owner.hide()},onDocumentTouchStart:function(t){t||(t=window.event);var n=t.target||t.srcElement;n._jscLinkedInstance?n._jscLinkedInstance.showOnClick&&n._jscLinkedInstance.show():n._jscControlName?e.onControlPointerStart(t,n,n._jscControlName,"touch"):e.picker&&e.picker.owner&&e.picker.owner.hide()},onWindowResize:function(t){e.redrawPosition()},onParentScroll:function(t){e.picker&&e.picker.owner&&e.picker.owner.hide()},_pointerMoveEvent:{mouse:"mousemove",touch:"touchmove"},_pointerEndEvent:{mouse:"mouseup",touch:"touchend"},_pointerOrigin:null,_capturedTarget:null,onControlPointerStart:function(t,n,r,o){var i=n._jscInstance;e.preventDefault(t),e.captureTarget(n);var s=function(i,s){e.attachGroupEvent("drag",i,e._pointerMoveEvent[o],e.onDocumentPointerMove(t,n,r,o,s)),e.attachGroupEvent("drag",i,e._pointerEndEvent[o],e.onDocumentPointerEnd(t,n,r,o))};if(s(document,[0,0]),window.parent&&window.frameElement){var l=window.frameElement.getBoundingClientRect(),a=[-l.left,-l.top];s(window.parent.window.document,a)}var d=e.getAbsPointerPos(t),c=e.getRelPointerPos(t);switch(e._pointerOrigin={x:d.x-c.x,y:d.y-c.y},r){case"pad":switch(e.getSliderComponent(i)){case"s":0===i.hsv[1]&&i.fromHSV(null,100,null);break;case"v":0===i.hsv[2]&&i.fromHSV(null,null,100)}e.setPad(i,t,0,0);break;case"sld":e.setSld(i,t,0)}e.dispatchFineChange(i)},onDocumentPointerMove:function(t,n,r,o,i){return function(t){var o=n._jscInstance;switch(r){case"pad":t||(t=window.event),e.setPad(o,t,i[0],i[1]),e.dispatchFineChange(o);break;case"sld":t||(t=window.event),e.setSld(o,t,i[1]),e.dispatchFineChange(o)}}},onDocumentPointerEnd:function(t,n,r,o){return function(t){var r=n._jscInstance;e.detachGroupEvents("drag"),e.releaseTarget(),e.dispatchChange(r)}},dispatchChange:function(t){t.valueElement&&e.isElementType(t.valueElement,"input")&&e.fireEvent(t.valueElement,"change")},dispatchFineChange:function(e){if(e.onFineChange){var t;t="string"==typeof e.onFineChange?new Function(e.onFineChange):e.onFineChange,t.call(e)}},setPad:function(t,n,r,o){var i=e.getAbsPointerPos(n),s=r+i.x-e._pointerOrigin.x-t.padding-t.insetWidth,l=o+i.y-e._pointerOrigin.y-t.padding-t.insetWidth,a=s*(360/(t.width-1)),d=100-l*(100/(t.height-1));switch(e.getPadYComponent(t)){case"s":t.fromHSV(a,d,null,e.leaveSld);break;case"v":t.fromHSV(a,null,d,e.leaveSld)}},setSld:function(t,n,r){var o=e.getAbsPointerPos(n),i=r+o.y-e._pointerOrigin.y-t.padding-t.insetWidth,s=100-i*(100/(t.height-1));switch(e.getSliderComponent(t)){case"s":t.fromHSV(null,s,null,e.leavePad);break;case"v":t.fromHSV(null,null,s,e.leavePad)}},_vmlNS:"jsc_vml_",_vmlCSS:"jsc_vml_css_",_vmlReady:!1,initVML:function(){if(!e._vmlReady){var t=document;if(t.namespaces[e._vmlNS]||t.namespaces.add(e._vmlNS,"urn:schemas-microsoft-com:vml"),!t.styleSheets[e._vmlCSS]){var n=["shape","shapetype","group","background","path","formulas","handles","fill","stroke","shadow","textbox","textpath","imagedata","line","polyline","curve","rect","roundrect","oval","arc","image"],r=t.createStyleSheet();r.owningElement.id=e._vmlCSS;for(var o=0;o<n.length;o+=1)r.addRule(e._vmlNS+"\\:"+n[o],"behavior:url(#default#VML);")}e._vmlReady=!0}},createPalette:function(){var t={elm:null,draw:null};if(e.isCanvasSupported){var n=document.createElement("canvas"),r=n.getContext("2d"),o=function(e,t,o){n.width=e,n.height=t,r.clearRect(0,0,n.width,n.height);var i=r.createLinearGradient(0,0,n.width,0);i.addColorStop(0,"#F00"),i.addColorStop(1/6,"#FF0"),i.addColorStop(2/6,"#0F0"),i.addColorStop(.5,"#0FF"),i.addColorStop(4/6,"#00F"),i.addColorStop(5/6,"#F0F"),i.addColorStop(1,"#F00"),r.fillStyle=i,r.fillRect(0,0,n.width,n.height);var s=r.createLinearGradient(0,0,0,n.height);switch(o.toLowerCase()){case"s":s.addColorStop(0,"rgba(255,255,255,0)"),s.addColorStop(1,"rgba(255,255,255,1)");break;case"v":s.addColorStop(0,"rgba(0,0,0,0)"),s.addColorStop(1,"rgba(0,0,0,1)")}r.fillStyle=s,r.fillRect(0,0,n.width,n.height)};t.elm=n,t.draw=o}else{e.initVML();var i=document.createElement("div");i.style.position="relative",i.style.overflow="hidden";var s=document.createElement(e._vmlNS+":fill");s.type="gradient",s.method="linear",s.angle="90",s.colors="16.67% #F0F, 33.33% #00F, 50% #0FF, 66.67% #0F0, 83.33% #FF0";var l=document.createElement(e._vmlNS+":rect");l.style.position="absolute",l.style.left="-1px",l.style.top="-1px",l.stroked=!1,l.appendChild(s),i.appendChild(l);var a=document.createElement(e._vmlNS+":fill");a.type="gradient",a.method="linear",a.angle="180",a.opacity="0";var d=document.createElement(e._vmlNS+":rect");d.style.position="absolute",d.style.left="-1px",d.style.top="-1px",d.stroked=!1,d.appendChild(a),i.appendChild(d);var o=function(e,t,n){switch(i.style.width=e+"px",i.style.height=t+"px",l.style.width=d.style.width=e+1+"px",l.style.height=d.style.height=t+1+"px",s.color="#F00",s.color2="#F00",n.toLowerCase()){case"s":a.color=a.color2="#FFF";break;case"v":a.color=a.color2="#000"}};t.elm=i,t.draw=o}return t},createSliderGradient:function(){var t={elm:null,draw:null};if(e.isCanvasSupported){var n=document.createElement("canvas"),r=n.getContext("2d"),o=function(e,t,o,i){n.width=e,n.height=t,r.clearRect(0,0,n.width,n.height);var s=r.createLinearGradient(0,0,0,n.height);s.addColorStop(0,o),s.addColorStop(1,i),r.fillStyle=s,r.fillRect(0,0,n.width,n.height)};t.elm=n,t.draw=o}else{e.initVML();var i=document.createElement("div");i.style.position="relative",i.style.overflow="hidden";var s=document.createElement(e._vmlNS+":fill");s.type="gradient",s.method="linear",s.angle="180";var l=document.createElement(e._vmlNS+":rect");l.style.position="absolute",l.style.left="-1px",l.style.top="-1px",l.stroked=!1,l.appendChild(s),i.appendChild(l);var o=function(e,t,n,r){i.style.width=e+"px",i.style.height=t+"px",l.style.width=e+1+"px",l.style.height=t+1+"px",s.color=n,s.color2=r};t.elm=i,t.draw=o}return t},leaveValue:1,leaveStyle:2,leavePad:4,leaveSld:8,BoxShadow:function(){var e=function(e,t,n,r,o,i){this.hShadow=e,this.vShadow=t,this.blur=n,this.spread=r,this.color=o,this.inset=!!i};return e.prototype.toString=function(){var e=[Math.round(this.hShadow)+"px",Math.round(this.vShadow)+"px",Math.round(this.blur)+"px",Math.round(this.spread)+"px",this.color];return this.inset&&e.push("inset"),e.join(" ")},e}(),jscolor:function(t,n){function r(e,t,n){e/=255,t/=255,n/=255;var r=Math.min(Math.min(e,t),n),o=Math.max(Math.max(e,t),n),i=o-r;if(0===i)return[null,0,100*o];var s=e===r?3+(n-t)/i:t===r?5+(e-n)/i:1+(t-e)/i;return[60*(6===s?0:s),100*(i/o),100*o]}function o(e,t,n){var r=255*(n/100);if(null===e)return[r,r,r];e/=60,t/=100;var o=Math.floor(e),i=o%2?e-o:1-(e-o),s=r*(1-t),l=r*(1-t*i);switch(o){case 6:case 0:return[r,l,s];case 1:return[l,r,s];case 2:return[s,r,l];case 3:return[s,l,r];case 4:return[l,s,r];case 5:return[r,s,l]}}function i(){e.unsetClass(m.targetElement,m.activeClass),e.picker.wrap.parentNode.removeChild(e.picker.wrap),delete e.picker.owner}function s(){function t(){var e=m.insetColor.split(/\s+/),t=e.length<2?e[0]:e[1]+" "+e[0]+" "+e[0]+" "+e[1];n.btn.style.borderColor=t}m._processParentElementsInDOM(),e.picker||(e.picker={owner:null,wrap:document.createElement("div"),box:document.createElement("div"),boxS:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),padPal:e.createPalette(),cross:document.createElement("div"),crossBY:document.createElement("div"),crossBX:document.createElement("div"),crossLY:document.createElement("div"),crossLX:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),sldGrad:e.createSliderGradient(),sldPtrS:document.createElement("div"),sldPtrIB:document.createElement("div"),sldPtrMB:document.createElement("div"),sldPtrOB:document.createElement("div"),btn:document.createElement("div"),btnT:document.createElement("span")},e.picker.pad.appendChild(e.picker.padPal.elm),e.picker.padB.appendChild(e.picker.pad),e.picker.cross.appendChild(e.picker.crossBY),e.picker.cross.appendChild(e.picker.crossBX),e.picker.cross.appendChild(e.picker.crossLY),e.picker.cross.appendChild(e.picker.crossLX),e.picker.padB.appendChild(e.picker.cross),e.picker.box.appendChild(e.picker.padB),e.picker.box.appendChild(e.picker.padM),e.picker.sld.appendChild(e.picker.sldGrad.elm),e.picker.sldB.appendChild(e.picker.sld),e.picker.sldB.appendChild(e.picker.sldPtrOB),e.picker.sldPtrOB.appendChild(e.picker.sldPtrMB),e.picker.sldPtrMB.appendChild(e.picker.sldPtrIB),e.picker.sldPtrIB.appendChild(e.picker.sldPtrS),e.picker.box.appendChild(e.picker.sldB),e.picker.box.appendChild(e.picker.sldM),e.picker.btn.appendChild(e.picker.btnT),e.picker.box.appendChild(e.picker.btn),e.picker.boxB.appendChild(e.picker.box),e.picker.wrap.appendChild(e.picker.boxS),e.picker.wrap.appendChild(e.picker.boxB));var n=e.picker,r=!!e.getSliderComponent(m),o=e.getPickerDims(m),i=2*m.pointerBorderWidth+m.pointerThickness+2*m.crossSize,s=e.getPadToSliderPadding(m),d=Math.min(m.borderRadius,Math.round(m.padding*Math.PI)),c="crosshair";n.wrap.style.clear="both",n.wrap.style.width=o[0]+2*m.borderWidth+"px",n.wrap.style.height=o[1]+2*m.borderWidth+"px",n.wrap.style.zIndex=m.zIndex,n.box.style.width=o[0]+"px",n.box.style.height=o[1]+"px",n.boxS.style.position="absolute",n.boxS.style.left="0",n.boxS.style.top="0",n.boxS.style.width="100%",n.boxS.style.height="100%",e.setBorderRadius(n.boxS,d+"px"),n.boxB.style.position="relative",n.boxB.style.border=m.borderWidth+"px solid",n.boxB.style.borderColor=m.borderColor,n.boxB.style.background=m.backgroundColor,e.setBorderRadius(n.boxB,d+"px"),n.padM.style.background=n.sldM.style.background="#FFF",e.setStyle(n.padM,"opacity","0"),e.setStyle(n.sldM,"opacity","0"),n.pad.style.position="relative",n.pad.style.width=m.width+"px",n.pad.style.height=m.height+"px",n.padPal.draw(m.width,m.height,e.getPadYComponent(m)),n.padB.style.position="absolute",n.padB.style.left=m.padding+"px",n.padB.style.top=m.padding+"px",n.padB.style.border=m.insetWidth+"px solid",n.padB.style.borderColor=m.insetColor,n.padM._jscInstance=m,n.padM._jscControlName="pad",n.padM.style.position="absolute",n.padM.style.left="0",n.padM.style.top="0",n.padM.style.width=m.padding+2*m.insetWidth+m.width+s/2+"px",n.padM.style.height=o[1]+"px",n.padM.style.cursor=c,n.cross.style.position="absolute",n.cross.style.left=n.cross.style.top="0",n.cross.style.width=n.cross.style.height=i+"px",n.crossBY.style.position=n.crossBX.style.position="absolute",n.crossBY.style.background=n.crossBX.style.background=m.pointerBorderColor,n.crossBY.style.width=n.crossBX.style.height=2*m.pointerBorderWidth+m.pointerThickness+"px",n.crossBY.style.height=n.crossBX.style.width=i+"px",n.crossBY.style.left=n.crossBX.style.top=Math.floor(i/2)-Math.floor(m.pointerThickness/2)-m.pointerBorderWidth+"px",n.crossBY.style.top=n.crossBX.style.left="0",n.crossLY.style.position=n.crossLX.style.position="absolute",n.crossLY.style.background=n.crossLX.style.background=m.pointerColor,n.crossLY.style.height=n.crossLX.style.width=i-2*m.pointerBorderWidth+"px",n.crossLY.style.width=n.crossLX.style.height=m.pointerThickness+"px",n.crossLY.style.left=n.crossLX.style.top=Math.floor(i/2)-Math.floor(m.pointerThickness/2)+"px",n.crossLY.style.top=n.crossLX.style.left=m.pointerBorderWidth+"px",n.sld.style.overflow="hidden",n.sld.style.width=m.sliderSize+"px",n.sld.style.height=m.height+"px",n.sldGrad.draw(m.sliderSize,m.height,"#000","#000"),n.sldB.style.display=r?"block":"none",n.sldB.style.position="absolute",n.sldB.style.right=m.padding+"px",n.sldB.style.top=m.padding+"px",n.sldB.style.border=m.insetWidth+"px solid",n.sldB.style.borderColor=m.insetColor,n.sldM._jscInstance=m,n.sldM._jscControlName="sld",n.sldM.style.display=r?"block":"none",n.sldM.style.position="absolute",n.sldM.style.right="0",n.sldM.style.top="0",n.sldM.style.width=m.sliderSize+s/2+m.padding+2*m.insetWidth+"px",n.sldM.style.height=o[1]+"px",n.sldM.style.cursor="default",n.sldPtrIB.style.border=n.sldPtrOB.style.border=m.pointerBorderWidth+"px solid "+m.pointerBorderColor,n.sldPtrOB.style.position="absolute",n.sldPtrOB.style.left=-(2*m.pointerBorderWidth+m.pointerThickness)+"px",n.sldPtrOB.style.top="0",n.sldPtrMB.style.border=m.pointerThickness+"px solid "+m.pointerColor,n.sldPtrS.style.width=m.sliderSize+"px",n.sldPtrS.style.height=g+"px",n.btn.style.display=m.closable?"block":"none",n.btn.style.position="absolute",n.btn.style.left=m.padding+"px",n.btn.style.bottom=m.padding+"px",n.btn.style.padding="0 15px",n.btn.style.height=m.buttonHeight+"px",n.btn.style.border=m.insetWidth+"px solid",t(),n.btn.style.color=m.buttonColor,n.btn.style.font="12px sans-serif",n.btn.style.textAlign="center";try{n.btn.style.cursor="pointer"}catch(h){n.btn.style.cursor="hand"}n.btn.onmousedown=function(){m.hide()},n.btnT.style.lineHeight=m.buttonHeight+"px",n.btnT.innerHTML="",n.btnT.appendChild(document.createTextNode(m.closeText)),l(),a(),e.picker.owner&&e.picker.owner!==m&&e.unsetClass(e.picker.owner.targetElement,m.activeClass),e.picker.owner=m,e.isElementType(v,"body")?e.redrawPosition():e._drawPosition(m,0,0,"relative",!1),n.wrap.parentNode!=v&&v.appendChild(n.wrap),e.setClass(m.targetElement,m.activeClass)}function l(){switch(e.getPadYComponent(m)){case"s":var t=1;break;case"v":var t=2}var n=Math.round(m.hsv[0]/360*(m.width-1)),r=Math.round((1-m.hsv[t]/100)*(m.height-1)),i=2*m.pointerBorderWidth+m.pointerThickness+2*m.crossSize,s=-Math.floor(i/2);switch(e.picker.cross.style.left=n+s+"px",e.picker.cross.style.top=r+s+"px",e.getSliderComponent(m)){case"s":var l=o(m.hsv[0],100,m.hsv[2]),a=o(m.hsv[0],0,m.hsv[2]),d="rgb("+Math.round(l[0])+","+Math.round(l[1])+","+Math.round(l[2])+")",c="rgb("+Math.round(a[0])+","+Math.round(a[1])+","+Math.round(a[2])+")";e.picker.sldGrad.draw(m.sliderSize,m.height,d,c);break;case"v":var h=o(m.hsv[0],m.hsv[1],100),d="rgb("+Math.round(h[0])+","+Math.round(h[1])+","+Math.round(h[2])+")",c="#000";e.picker.sldGrad.draw(m.sliderSize,m.height,d,c)}}function a(){var t=e.getSliderComponent(m);if(t){switch(t){case"s":var n=1;break;case"v":var n=2}var r=Math.round((1-m.hsv[n]/100)*(m.height-1));e.picker.sldPtrOB.style.top=r-(2*m.pointerBorderWidth+m.pointerThickness)-Math.floor(g/2)+"px"}}function d(){return e.picker&&e.picker.owner===m}function c(){m.importColor()}this.value=null,this.valueElement=t,this.styleElement=t,this.required=!0,this.refine=!0,this.hash=!1,this.uppercase=!0,this.onFineChange=null,this.activeClass="jscolor-active",this.minS=0,this.maxS=100,this.minV=0,this.maxV=100,this.hsv=[0,0,100],this.rgb=[255,255,255],this.width=181,this.height=101,this.showOnClick=!0,this.mode="HSV",this.position="bottom",this.smartPosition=!0,this.sliderSize=16,this.crossSize=8,this.closable=!1,this.closeText="Close",this.buttonColor="#000000",this.buttonHeight=18,this.padding=12,this.backgroundColor="#FFFFFF",this.borderWidth=1,this.borderColor="#BBBBBB",this.borderRadius=8,this.insetWidth=1,this.insetColor="#BBBBBB",this.shadow=!0,this.shadowBlur=15,this.shadowColor="rgba(0,0,0,0.2)",this.pointerColor="#4C4C4C",this.pointerBorderColor="#FFFFFF",this.pointerBorderWidth=1,this.pointerThickness=2,this.zIndex=1e3,this.container=null;for(var h in n)n.hasOwnProperty(h)&&(this[h]=n[h]);if(this.hide=function(){d()&&i()},this.show=function(){s()},this.redraw=function(){d()&&s()},this.importColor=function(){this.valueElement&&e.isElementType(this.valueElement,"input")?this.refine?!this.required&&/^\s*$/.test(this.valueElement.value)?(this.valueElement.value="",this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(e.leaveValue|e.leaveStyle)):this.fromString(this.valueElement.value)||this.exportColor():this.fromString(this.valueElement.value,e.leaveValue)||(this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(e.leaveValue|e.leaveStyle)):this.exportColor()},this.exportColor=function(t){if(!(t&e.leaveValue)&&this.valueElement){var n=this.toString();this.uppercase&&(n=n.toUpperCase()),this.hash&&(n="#"+n),e.isElementType(this.valueElement,"input")?this.valueElement.value=n:this.valueElement.innerHTML=n}t&e.leaveStyle||this.styleElement&&(this.styleElement.style.backgroundImage="none",this.styleElement.style.backgroundColor="#"+this.toString(),this.styleElement.style.color=this.isLight()?"#000":"#FFF"),t&e.leavePad||!d()||l(),t&e.leaveSld||!d()||a()},this.fromHSV=function(e,t,n,r){if(null!==e){if(isNaN(e))return!1;e=Math.max(0,Math.min(360,e))}if(null!==t){if(isNaN(t))return!1;t=Math.max(0,Math.min(100,this.maxS,t),this.minS)}if(null!==n){if(isNaN(n))return!1;n=Math.max(0,Math.min(100,this.maxV,n),this.minV)}this.rgb=o(null===e?this.hsv[0]:this.hsv[0]=e,null===t?this.hsv[1]:this.hsv[1]=t,null===n?this.hsv[2]:this.hsv[2]=n),this.exportColor(r)},this.fromRGB=function(e,t,n,i){if(null!==e){if(isNaN(e))return!1;e=Math.max(0,Math.min(255,e))}if(null!==t){if(isNaN(t))return!1;t=Math.max(0,Math.min(255,t))}if(null!==n){if(isNaN(n))return!1;n=Math.max(0,Math.min(255,n))}var s=r(null===e?this.rgb[0]:e,null===t?this.rgb[1]:t,null===n?this.rgb[2]:n);null!==s[0]&&(this.hsv[0]=Math.max(0,Math.min(360,s[0]))),0!==s[2]&&(this.hsv[1]=null===s[1]?null:Math.max(0,this.minS,Math.min(100,this.maxS,s[1]))),this.hsv[2]=null===s[2]?null:Math.max(0,this.minV,Math.min(100,this.maxV,s[2]));var l=o(this.hsv[0],this.hsv[1],this.hsv[2]);this.rgb[0]=l[0],this.rgb[1]=l[1],this.rgb[2]=l[2],this.exportColor(i)},this.fromString=function(e,t){var n;if(n=e.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i))return 6===n[1].length?this.fromRGB(parseInt(n[1].substr(0,2),16),parseInt(n[1].substr(2,2),16),parseInt(n[1].substr(4,2),16),t):this.fromRGB(parseInt(n[1].charAt(0)+n[1].charAt(0),16),parseInt(n[1].charAt(1)+n[1].charAt(1),16),parseInt(n[1].charAt(2)+n[1].charAt(2),16),t),!0;if(n=e.match(/^\W*rgba?\(([^)]*)\)\W*$/i)){var r,o,i,s=n[1].split(","),l=/^\s*(\d*)(\.\d+)?\s*$/;if(s.length>=3&&(r=s[0].match(l))&&(o=s[1].match(l))&&(i=s[2].match(l))){var a=parseFloat((r[1]||"0")+(r[2]||"")),d=parseFloat((o[1]||"0")+(o[2]||"")),c=parseFloat((i[1]||"0")+(i[2]||""));return this.fromRGB(a,d,c,t),!0}}return!1},this.toString=function(){return(256|Math.round(this.rgb[0])).toString(16).substr(1)+(256|Math.round(this.rgb[1])).toString(16).substr(1)+(256|Math.round(this.rgb[2])).toString(16).substr(1)},this.toHEXString=function(){return"#"+this.toString().toUpperCase()},this.toRGBString=function(){return"rgb("+Math.round(this.rgb[0])+","+Math.round(this.rgb[1])+","+Math.round(this.rgb[2])+")"},this.isLight=function(){return.213*this.rgb[0]+.715*this.rgb[1]+.072*this.rgb[2]>127.5},this._processParentElementsInDOM=function(){if(!this._linkedElementsProcessed){this._linkedElementsProcessed=!0;var t=this.targetElement;do{var n=e.getStyle(t);n&&"fixed"===n.position.toLowerCase()&&(this.fixed=!0),t!==this.targetElement&&(t._jscEventsAttached||(e.attachEvent(t,"scroll",e.onParentScroll),t._jscEventsAttached=!0))}while((t=t.parentNode)&&!e.isElementType(t,"body"))}},"string"==typeof t){var p=t,u=document.getElementById(p);u?this.targetElement=u:e.warn("Could not find target element with ID '"+p+"'")}else t?this.targetElement=t:e.warn("Invalid target element: '"+t+"'");if(this.targetElement._jscLinkedInstance)return void e.warn("Cannot link jscolor twice to the same element. Skipping.");this.targetElement._jscLinkedInstance=this,this.valueElement=e.fetchElement(this.valueElement),this.styleElement=e.fetchElement(this.styleElement);var m=this,v=this.container?e.fetchElement(this.container):document.getElementsByTagName("body")[0],g=3;if(e.isElementType(this.targetElement,"button"))if(this.targetElement.onclick){var y=this.targetElement.onclick;this.targetElement.onclick=function(e){return y.call(this,e),!1}}else this.targetElement.onclick=function(){return!1};if(this.valueElement&&e.isElementType(this.valueElement,"input")){var f=function(){m.fromString(m.valueElement.value,e.leaveValue),e.dispatchFineChange(m)};e.attachEvent(this.valueElement,"keyup",f),e.attachEvent(this.valueElement,"input",f),e.attachEvent(this.valueElement,"blur",c),this.valueElement.setAttribute("autocomplete","off")}this.styleElement&&(this.styleElement._jscOrigStyle={backgroundImage:this.styleElement.style.backgroundImage,backgroundColor:this.styleElement.style.backgroundColor,color:this.styleElement.style.color}),this.value?this.fromString(this.value)||this.exportColor():this.importColor()}};return e.jscolor.lookupClass="jscolor",e.jscolor.installByClassName=function(t){var n=document.getElementsByTagName("input"),r=document.getElementsByTagName("button");e.tryInstallOnElements(n,t),e.tryInstallOnElements(r,t)},e.register(),e.jscolor}());
TOL.Module.Keywordsearch=function(){var e=tolConfig.autocompleteKeyword(),a="",t="",l=[],i=-1,n=function(e){t=$(e).data("params");var a=$(e).data("url");void 0!==a&&"undefined"!==a&&(location=a),$("#modelText, #keyword").val($(e).text()),$("#sugs").hide(),o(t)},o=function(e){var a=$("#keywordParams");if(0!==a.length){a.html("");var t=e.split("&");for(var l in t){var i=t[l].split("=");i.length<2||(name=i[0],value=i[1],a.append('<input type="hidden" name="'+name+'" value="'+value+'"/>'))}}},r=function(t){var l=e.keywordLimit,r=$("div #sugs li").size();if(a=$.trim($("#modelText, #keyword").val().toLowerCase()).replace("-"," "),"mobile"!=device_detection&&"tablet"!=device_detection||"/"==window.location.pathname||(a=$.trim($(".popover-content .sugs-wrapper #modelText").val().toLowerCase()).replace("-"," ")),40==t.keyCode)i>=r-1&&(i=-1),i++,s();else if(38==t.keyCode)i<=0&&(i=r),i--,s();else if(13==t.keyCode)if(i>-1){var d=$("#sugs li").get(i);n(d),t.preventDefault()}else t.preventDefault(),$("#sugs").hide(),$("#index-search-form").submit();else o("keyword="+a),a.length<l?$("#sugs").hide():(c(),a.length>l&&p())},s=function(){var e="";$("#sugs li").removeAttr("style"),e=$("#sugs li").get(i),$(e).css("background-color","#EDEDED")},c=function(){var e="",t=1,l="",i={keyword:a};if($("#makeSelect").length>0?e=$("#makeSelect").val():"undefined"!=typeof affiliate_make&&(e=affiliate_make),$("#classSelect").length>0&&(l=$("#classSelect").val()),l.indexOf("|")!=-1){var n=l.split("|");3==tolConfig.getRealmId()&&4==n.length?i.classes=n[0]+"|"+n[2]:n.length&&(i.classes=l)}e.indexOf("|")!=-1&&(i.makes=e),$.ajax({method:"GET",url:"/keywordsearch/loadkeywords",data:i,dataType:"json",success:function(e){Object.keys(e).length>1&&(p(e),t=0)}})},d=function(){var t,l,i=e.specialKeys;for(var n in i)if(t=i[n].checkfield.toLowerCase(),l=i[n].actualfield.toLowerCase(),a.indexOf(t)>=0){a=a.replace(t,l);break}},u=function(e){e.length>0?($("#sugs").html(e),$(".popover-content #sugs").html(e),$("#sugs").show(),$(".popover-content #sugs").show()):($("#sugs").hide(),$(".popover-content #sugs").hide())},p=function(t){var i=[];l=[],t&&(i=t.result||[]);var n=e.autopopulateLimit,r="",s="",c="",p="",m="",g="",f="",h="",v=0,w="";d(),r=a,s=a,t&&t.params&&(r=t.params.keyword||a,s=t.params.extendedKeyword||a,o(t.params.query?t.params.query:"keyword="+a));var k="keyword="+$("#modelText").val();$("#makeSelect").val()&&""!=$("#makeSelect").val()&&(k="model="+$("#modelText").val());var f="<li data-params='"+k+"' onclick=TOL.Module.Keywordsearch.clickURL(this);><span>"+a+'</span><i class="substring"> - keyword</i></li>',y=new RegExp(r.replace(/([a-zA-Z])([0-9])/g,"$1 ?$2").replace(/([0-9])([a-zA-Z])/g,"$1 ?$2")),x=new RegExp(s.replace(/([a-zA-Z])([0-9])/g,"$1 ?$2").replace(/([0-9])([a-zA-Z])/g,"$1 ?$2"));if("object"==typeof i&&$(i).size()){for(var L in i)if(v<n){l.push(i[L]),p=i[L].text.toLowerCase(),m="data-params='"+i[L].query+"' data-url='"+t.url+"'";var b=getParamSubstring(i[L].query);null!==p.match(y)?(g=i[L].prefix+p.replace(r,"<span>"+r+"</span>"),c!=m&&(w+="<li "+m+" onclick=TOL.Module.Keywordsearch.clickURL(this);>"+$.trim(g)+b+"<br></li>"),v++):null!==p.match(x)&&(g=i[L].prefix+p.replace(s,"<span>"+s+"</span>"),c!=m&&(w+="<li "+m+"' onclick=TOL.Module.Keywordsearch.clickURL(this);>"+$.trim(g)+b+"<br></li>"),v++)}h.length&&(w=h+w),f.length&&(w=f+w),u(w)}else f.length&&(w=f+w),u(w)},m=function(){$("body").on("click",function(e){if(""!=$("div #sugs li")&&$("div #sugs li").length&&$("div #sugs li").is(":visible"))return $("#sugs").hide(),!1})},g=tolConfig.getRealmSearchTerm(),f="find-"+g,h=function(){window.location.pathname.search("/"+f)==-1&&"/"!=window.location.pathname&&window.location.pathname.search("/"+g)==-1||window.location.search.search("vrsn=iframe")!==-1||$("#modelText, #keyword").keyup(r),"/index-partners"==window.location.pathname&&($("input[name=allowed_make]").length&&$("input[name=allowed_make]").val().indexOf(",")==-1||!$("input[name=allowed_make]").length)&&$("#modelText, #keyword").keyup(r),m()},v=function(){return l},w=function(){return t};return getParamSubstring=function(e){var a=e.indexOf("category")!==-1?"category":"type",t="";return e.indexOf(a)!==-1&&e.indexOf("make")==-1&&(t='<i class="substring"> - '+a+"</i>"),t},{init:h,getAutocompleteURL:w,clickURL:n,loadKeyword:r,getSolrData:v}}(jQuery);
function grecaptchaCallback(){var e=$(".g-recaptcha"),a=$("#recaptchaKey").val();e.each(function(e,t){grecaptcha.render(t,{sitekey:a})})}TOL.Module.Listing=function(e){function a(a){if(void 0===e(this).attr("href")){var t=e(this);e.ajax({url:"/gettiledata/addetail_sellerinfo/showphonenumber",data:{adId:e(this).data("adid")},dataType:"json",success:function(e){if(t.is("a.telHref"))t.find(".showPhone").text(e.formattedPhone),t.attr("href","tel:"+e.phone),t.attr("data-track","Listing Phone Number Click");else{var a=t.parent();a.prepend('<i class="fa fa-phone"></i> ',a.text(e.formattedPhone)),a.is("a")&&a.attr("href","tel:"+e.phone)}}})}a.stopPropagation()}function t(){h.html(p.currSlideId+1+" of "+p.numSlides)}function i(){if(e(".rsTmb").removeClass("hide"),e("#Gallery").royalSlider({fullscreen:{enabled:!0,nativeFS:!0},controlNavigation:"thumbnails",autoScaleSlider:!0,autoScaleSliderWidth:770,autoScaleSliderHeight:577,loopRewind:!0,imageScaleMode:"fit",navigateByClick:!1,numImagesToPreload:2,arrowsNav:!0,arrowsNavAutoHide:!1,arrowsNavHideOnTouch:!1,firstMargin:!0,keyboardNavEnabled:!0,fadeinLoadedSlide:!0,globalCaption:!1,globalCaptionInside:!1,video:{autoHideArrows:!0,autoHideControlNav:!1,autoHideBlocks:!0},autoPlay:{enabled:!0,delay:2e3,pauseOnHover:!1}}),e("#Gallery").trigger("initialized"),p=e("#Gallery").data("royalSlider")){if(p.stopAutoPlay(),5===tolConfig.getRealmId())var a="https://cdn.cycletrader.com/cycle";else if(3===tolConfig.getRealmId())var a="https://cdn.rvtrader.com/rv";else var a="https://cdn.cycletrader.com/cycle";brochureBGAudio=new Audio(a+"-bg-music.bin"),brochureBGAudio.volume=.03,"boolean"==typeof brochureBGAudio.loop?brochureBGAudio.loop=!0:brochureBGAudio.addEventListener("ended",function(){this.currentTime=0,this.play()},!1),e("#royalSliderAutoPlay").click(function(a){if(a.stopPropagation(),e(this).find("i").hasClass("fa-play")){e(this).find("i").removeClass("fa-play").addClass("fa-pause"),e(this).find(".hidden-xxs").text(" Pause Brochure"),p.startAutoPlay(),brochureBGAudio.play();var t=e("#brochureText").text();responsiveVoice.speak(t,"US English Male",{volume:.5,rate:1.02})}else e(this).find("i").addClass("fa-play").removeClass("fa-pause"),e(this).find(".hidden-xxs").text(" Play Brochure"),p.stopAutoPlay(),brochureBGAudio.pause(),responsiveVoice.cancel()}),e(".counts").appendTo(e(".rsOverflow")),e("#Gallery").click(function(){e("#royalSliderAutoPlay").find("i").hasClass("fa-pause")&&(e("#royalSliderAutoPlay").find("i").addClass("fa-play").removeClass("fa-pause"),e("#royalSliderAutoPlay").find("span").text(" Play Brochure"),p.stopAutoPlay(),brochureBGAudio.pause(),responsiveVoice.cancel())}),p.ev.on("rsSlideClick",function(){p.currSlide.videoURL?p.playVideo():p.isFullscreen?p.exitFullscreen():p.enterFullscreen()}),h=e('<div class="rsSlideCount"></div>').prependTo(e("#Gallery")),p.ev.on("rsAfterSlideChange",t),t(),p.ev.on("rsAfterContentSet",function(a,t){var i=e(".rsMainSlideImage");e.each(e("#imageData").data(),function(e,a){"alt"===e?i.attr("alt",a):i.attr("data-"+e,a)})}),TOL.Module.Listing.loadSwipe()}e(".videoButton").click(l)}function l(){for(var a in p.slides)if(p.slides[a].videoURL)return e("#single-videoList,#brochureList").hide(),e(".photos,.single-video").show(),void p.goTo(a)}function d(){function a(a){TOL.Module.Modal.loading(),e.ajax({url:"/gettiledata/addetail_loancalculator/loadModal",data:{adId:e(this).data("adid"),dealerId:e(this).data("dlrid")},dataType:"json",success:function(a){TOL.Module.Modal.loadModal(a),TOL.Module.Listing.initLoanCalc(),e('[name="price"]').val(e("#unitPrice").text()),TOL.Module.Listing.updateAmount(),TOL.Module.Listing.loanCalculate(),"undefined"!=typeof googletag&&googletag&&googletag.apiReady&&(0==g.length&&(g=TOL.Module.GoogleAdsInit.defineDelayedSlots()),g.length>0&&deployads.push(function(){console.log("DFP pubadsRefresh"),deployads.gpt.pubadsRefresh(g)}))}}),a.preventDefault(),a.stopPropagation()}function t(a){TOL.Module.ModalWindow.hideAll(),TOL.Module.Modal.loading(),e.ajax({url:"/gettiledata/addetail_emailfriend/loadModal",data:{adId:e(this).data("adid"),dealerId:e(this).data("dealerid")},dataType:"json",success:o}),a.preventDefault()}function i(a){TOL.Module.Modal.loading(),e.ajax({url:"/gettiledata/addetail_emailsellerpage/loadModal",data:{adId:e(this).data("adid"),dealerId:e(this).data("dlrid")},dataType:"json",success:function(e){o.apply(this,[e])}}),a.preventDefault()}e(".title-list").click(function(a){e(this).find("i.title-list-arrow").hasClass("fa-minus-square-o")?e(this).find("i.title-list-arrow").removeClass("fa-minus-square-o").addClass("fa-plus-square-o"):e(this).find("i.title-list-arrow").removeClass("fa-plus-square-o").addClass("fa-minus-square-o")}),e(".modalContent").on("click",".sendToFriend",t),e(".modalContent").on("click",".calculatePaymentsButton",a),e(".sendToFriend").click(t),e(".calculatePaymentsButton").click(a),e(".modalContent").on("click",".learnMore",i),e(".bestPriceButton").click(function(a){TOL.Module.Modal.loading(),e.ajax({url:"/gettiledata/addetail_emailbestpricepage/loadModal",data:{title:e.trim(e(this).text()),adId:e(this).data("adid"),dealerId:e(this).data("dlrid")},dataType:"json",success:o}),a.preventDefault()}),e(".requestPriceButton").click(function(a){TOL.Module.Modal.loading(),e.ajax({url:"/gettiledata/addetail_emailrequestpricepage/loadModal",data:{adId:e(this).data("adid"),dealerId:e(this).data("dlrid")},dataType:"json",success:o}),a.preventDefault()}),e(".tradeInButton").click(function(a){TOL.Module.Modal.loading(),e.ajax({url:"/gettiledata/addetail_emailtradeinpage/loadModal",data:{adId:e(this).data("adid"),dealerId:e(this).data("dlrid")},dataType:"json",success:function(a){o.apply(this,[a]),e("#tradein_type").change(),e(".TradinginInterest").prop("checked",!0)}}),a.preventDefault()}),e(".emailSellerBtn").click(function(a){TOL.Module.Modal.loading(),e.ajax({url:"/gettiledata/addetail_emailsellerpage/loadModal",data:{adId:e(this).data("adid"),dealerId:e(this).data("dlrid")},dataType:"json",success:function(e){o.apply(this,[e])}}),a.preventDefault()})}function o(e){TOL.Module.Modal.loadModal(e);var a=TOL.Module.Modal.getModalElement();a.find("#submitEmail").click(function(e){e.preventDefault(),TOL.Module.Listing.submitEmail.apply(this,[a])});var t=a.find(".g-recaptcha");t.length>0&&grecaptcha.render(a.find(".g-recaptcha")[0],{sitekey:m})}function n(){function a(a){13==a.which&&"textarea"!=this.type&&e("#submitEmail",e(this).parents(".emailForm")).click()}e("form.emailForm :input").keypress(a),e("#modalWindowsContainer").on("keypress","form.emailForm :input",a)}function r(a,t){if(null!==tolConfig.getCriteoTagId()){t?t+="-":t="",window.criteo_q=window.criteo_q||[];var i=/iPad/.test(navigator.userAgent)?"t":/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Silk/.test(navigator.userAgent)?"m":"d",l="0"===e(".detail-price h2 span").length?0:e(".detail-price h2 span").text();""===l&&(l="0"),l=l.replace(/[^\.0-9]/g,"");var d=[{event:"setAccount",account:tolConfig.getCriteoTagId()},{event:"setSiteType",type:i},{event:"trackTransaction",id:t+(new Date).getTime(),item:[{id:a.adId,price:l,quantity:1}]}];a.email&&d.push({event:"setHashedEmail",email:md5(a.email)}),window.criteo_q.push.apply(window.criteo_q,d)}}function s(){TOL.Module.Modal.loadModal({body:e("#binDisclaimer").html(),title:"You are now leaving our site."}),e("#buyItNowConfirm").click(trackBuyItNow)}function c(){e("#messageCheck").slideUp(500).fadeOut(500)}function u(){e("#box").addClass("hide fadeOut").removeClass("fadeIn"),e("#overlay").hide()}var p,h,m=e("#recaptchaKey").val(),f=!1,g=[];return e("#vrview").click(function(){e("#box").removeClass("hide fadeOut").addClass("fadeIn"),e("#overlay").show()}),e("#boxclose").click(function(){u()}),e(document).keyup(function(e){u()}),{init:function(){if(window.location.pathname.search("/listing")!=-1){1==e("#paymentCalc").length&&TOL.Module.Listing.initLoanCalc(),e("input[name='address'],input[name='location']").focus(function(){e(this).val().trim()==e(this).attr("defaultValue")&&e(this).val("")}),e("#submitEmail").click(function(a){a.preventDefault(),TOL.Module.Listing.submitEmail.apply(this,[e("#section1")])}),e("input[name='address'],input[name='location']").change(function(){e("input[name='saddr']").val(""),e("input[name='address'],input[name='location']").each(function(){e(this).val().trim()!=e(this).attr("defaultValue")&&e("input[name='saddr']").val(e("input[name='saddr']").val()+e(this).val().trim()+" ")})}),e("#share").click(function(){TOL.Module.Modal.loadModal({title:"Share This Listing",body:e("#share-body").html()}),e(".modalContent #gigyaShareINIT").attr("id","gigyaShare"),e(".modalContent #share-body").removeClass("hide"),loadGigya()}),e("#morephotos").click(function(){p.enterFullscreen()}),i(),TOL.Module.Listings.featuredCarousel(),d(),TOL.Module.Listing.handleUship(),TOL.Module.Listing.videoPhotoBrochureLink(),e(".callButton").click(a),n(),"#video"==location.hash&&l();var t=TOL.getGet("leadId");null==t&&(t=TOL.getGet("ListId")),null!=t&&(e.ajax({url:"/Gettiledata/emailseller/hotleads/",type:"POST",dataType:"json",data:{adId:e("input[name=adId]").val(),leadId:t},success:function(e){e.success&&TOL.Module.Modal.loadModal({title:"Message Sent",body:"We have notified the seller of your interest."})}}),event.preventDefault()),e("#itemWebsite").click(function(){r({adId:e("input[name=adId]").val()},"WEBSITE")}),e(".directionsLink").click(function(){r({adId:e("input[name=adId]").val()},"DIRECTION")}),e(".dealerWebsiteLink").click(function(){r({adId:e("input[name=adId]").val()},"DEALERSHIP")}),e(".buyItNow").click(s),"#emailSection"!==window.location.hash||"mobile"!=device_detection&&"tablet"!=device_detection||setTimeout(function(){TOL.Module.Modal.loading(),e.ajax({url:"/gettiledata/addetail_emailsellerpage/loadModal",data:{adId:e(".emailSellerBtn").data("adid"),dealerId:e(".emailSellerBtn").data("dlrid")},dataType:"json",success:function(e){o.apply(this,[e])}})},1)}},videoPhotoBrochureLink:function(){e(".photoLink").click(function(){return e("#single-videoList,#brochureList").hide(),e(".photos,.single-video").show(),!1})},handleUship:function(){e("#ushipEstimate").click(function(){e.ajax({url:"/Gettiledata/addetail_uship/getEstimate",data:{adId:e('input[name="adId"]').val(),year:e('input[name="year"]').val(),zipFrom:e('input[name="zip"]').val(),make:e('input[name="make"]').val(),model:e('input[name="model"]').val(),photo:e('input[name="photo"]').val(),zipTo:e("#ushipZip").val(),weight:e("#ushipWeight").val()},success:function(a){e("#estimateResults").html(a).show()}})})},loadSwipe:function(){if(console.log("DFP loadSwipe called"),"undefined"==typeof p)return void console.log("DFP loadSwipe royalSlider not yet loaded.");if(console.log(googletag),"undefined"==typeof googletag||!googletag||!googletag.apiReady)return void console.log("DFP loadSwipe googletag not yet ready");if(1==f)return void console.log("DFP loadSwipe ad already loaded");if(console.log("DFP loadSwipe running"),f=!0,adDisplayed=!1,"block"==e("#oas_photo #gpt-photo-mobiletabletdesktop").css("display")){""!=tolConfig.vdpSliderPromoThumb&&p.appendSlide('<div class="cta center listingAdThin width100p clear">\n<div class="rsContent"><div class="rsTmb"><img src="'+tolConfig.vdpSliderPromoThumb+'">\n</div></div></div>'),t();var a=0;p.ev.on("rsAfterSlideChange",function(t){if(p.numSlides-p.currSlide.id>=1&&e("figure.rsCaption , .counts").show(),p.numSlides-p.currSlide.id>2&&(console.log("DFP resetting CTA"),e("#gpt-photo-mobiletabletdesktop").css("display","block"),adDisplayed=!1),p.currSlide.id==p.numSlides-1&&"undefined"!=typeof googletag&&googletag&&googletag.apiReady&&0==adDisplayed){adDisplayed=!0,e("figure.rsCaption , .counts").hide(),console.log("DFP push CTA"),a++;var i="gpt-photo-mobiletabletdesktop"+a;console.log(t),e(".cta").html('<div id="'+i+'"></div>'),console.log("creating/calling ",i);var l=googletag.defineSlot(TOL.Module.GoogleAdsInit.page,[[300,250]],i);l.setTargeting("pos",["photo"]),l.addService(googletag.pubads()),googletag.display(i),googletag.pubads().refresh([l])}})}},initLoanCalc:function(){e(".financeBtn").click(function(){TOL.Module.ModalWindow.hideAll()}),e(".loanBtn").click(function(){e(".loanBtn").removeClass("btn-primary"),e(".loanBtn").addClass("btn-inverse"),e(this).addClass("btn-primary"),e(this).removeClass("btn-inverse"),e(this).hasClass("years")?e("input[name='years']").val(e(this).val()):e("input[name='years']").val(e(this).val()/12),TOL.Module.Listing.loanCalculate()}),e("input").filter("[name='price'],[name='dwnpymt'],[name='rateInput']").blur(TOL.Module.Listing.updateAmount),e("input").blur(TOL.Module.Listing.loanCalculate)},loanCalculate:function(){loanCalc.calculateForm();var a=!1;(!e.isNumeric(e("input[name='rate']").val())||e("input[name='rate']").val()<0)&&(a=!0),""!=e("input[name='price']").val()&&""!=e("input[name='dwnpymt']").val()||(a=!0),0==a&&e("#pymt").html(e("input[name='payment']").val()+'<sup>/MO</sup><div class="clear"></div><span class="small">for '+12*e("input[name='years']").val()+" months</span>")},updateAmount:function(){e("input[name='amount']").val(e("input[name='price']").val().replace(/[^\.0-9]/g,"")-e("input[name='dwnpymt']").val().replace(/[^\.0-9]/g,"")),e("input[name='rate']").val(e("input[name='rateInput']").val().replace(/[^\.0-9]/g,""))},submitEmail:function(a){var t=!0,i="",l={};"Other"==a.find("#issue").val()?a.find("#reason").attr("required",!0):a.find("#reason").removeAttr("required"),l.source="PORTAL-AD","mobile"==device_detection?l.source="mobile":"tablet"==device_detection&&(l.source="tablet"),TOL.getGet("affilid")&&(l.source+="-affiliate"),l["interestOptions[]"]=[],a.find(":input").each(function(){!e(this).attr("required")||""!=e(this).val().trim()&&e(this).val().trim()!=e(this).attr("defaultValue")?e(this).attr("validation")&&e(this).val().trim().search("^"+e(this).attr("validation")+"$")==-1&&(e(this).attr("required")||""==!e(this).val().trim())?(t=!1,"undefined"!=typeof e(this).attr("defaultValue")?i+=e(this).attr("defaultValue")+" is invalid.\n":(errorText=e(this).attr("placeholder"),i+=errorText.replace("(Required)","")+" is invalid.\n")):e(this).is(":checkbox")?"interestOptions[]"==e(this).attr("name")?e(this).prop("checked")&&l["interestOptions[]"].push(e(this).val()):l[e(this).attr("name")]=e(this).is(":checked"):l[e(this).attr("name")]=jQuery.trim(e(this).val()):(t=!1,"undefined"!=typeof e(this).attr("defaultValue")?i+=e(this).attr("defaultValue")+" is required.\n":(errorText=e(this).attr("placeholder"),i+=errorText.replace("(Required)","")+" is required.\n"))});var d={phone:l.phone,email:l.email,first_name:l.first_name,last_name:l.last_name};if(TOL.cookie.set("contactInfo",JSON.stringify(d),30),""!=i)alert(i);else{e(this).hide(),e(this).parent().find("#ajaxload").show();var o={adId:e(this).data("adid"),email:l.email};if("EmailFriend"==e(this).data("method"))goog_report_emailseller(),e.ajax({url:"/Gettiledata/addetail_emailfriend/sendemail/",type:"POST",data:l,context:e(this).parent(),success:function(e){TOL.Module.Listing.emailFriendCallback.apply(this,[e,a])}});else if("EmailSeller"==e(this).data("method")||"EmailDealer"==e(this).data("method")){goog_report_emailseller();var n=e(this).data("method");e.ajax({url:"/Gettiledata/emailseller/sendemail/",type:"POST",data:l,context:e(this).parent(),success:function(e){TOL.Module.Listing.emailSellerCallback.apply(this,[e,a]),"EmailSeller"==n&&r(o)}})}else"GetBestPrice"==e(this).data("method")?("function"==typeof goog_report_requestprice&&goog_report_requestprice(),l.back=0,l.m="confirmation",l.recaptchaResponse=l["g-recaptcha-response"],l.year=a.find("#year").val(),l.make=a.find("#make").val(),l.model=a.find("#model").val(),e.ajax({type:"POST",url:"/Gettiledata/requestaprice/ajmc/",dataType:"json",data:l,cache:!1,context:e(this).parent(),success:function(e){TOL.Module.Listing.emailGetPriceCallback.apply(this,[e,a]),r(o)}})):"GetTradeInValue"==e(this).data("method")?(goog_report_emailseller(),l.back=0,l.m="confirmation",l.recaptchaResponse=l["g-recaptcha-response"],e.ajax({type:"POST",url:"/Gettiledata/requesttradeinvalue/ajmc/",dataType:"json",data:l,cache:!1,context:e(this).parent(),success:function(e){TOL.Module.Listing.emailGetTradeInCallback.apply(this,[e,a]),r(o)}})):"reportfraud"==e(this).data("method")&&e.ajax({url:"/Gettiledata/addetail_reportfraud/sendemail/",type:"POST",data:l,context:e(this).parent(),success:function(e){TOL.Module.Listing.reportfraudCallback.apply(this,[e,a])}})}e(".TradinginInterest").prop("checked",!1)},emailFriendCallback:function(a,t){try{a=e.parseJSON(a)}catch(i){a={Errors:["Unknown Error"]}}e(this).parent().find("#ajaxload").hide(),0==a.Errors.length?(e(this).html("<div class='text-success center'data-lead-type='Email Lead'data-lead-status='Confirmed'data-lead-cat='Email Friend'><i class='fa fa-check fa-3x'></i><br>Message Sent!<br></div>"),window.rec.UTILS.trigger(document.body,"ConfirmedLead",{type:"Email Friend"}),TOL.Module.Listing.emailSentModal(),setTimeout(c,2500)):(t.find("#submitEmail").show(),alert(a.Errors[0]))},ShowVideo:function(a){if(0===e("#videoiframe").length){var t="<p>Your browser doesn't support this video player.</p>",i="https://www.youtube.com/embed/"+a;e("#video").prepend('<iframe id="videoiframe" class="embed-responsive-item" allowidth100pscreen frameborder="0" src="'+i+'?rel=0">'+t+"</iframe>")}window.scrollTo(0,e("#video").offset().top)},emailSellerCallback:function(a,t){e(this).parent().find("#ajaxload").hide();try{a=e.parseJSON(a)}catch(i){a={Errors:["Unknown Error"]}}0==a.Errors.length?(e(this).html("<div class='text-success center'data-lead-type='Email Lead'data-lead-status='Confirmed'data-lead-cat='Email Seller'><i class='fa fa-check fa-3x'></i><br>Message Sent!<br></div>"),TOL.Module.Listing.emailSentModal(),setTimeout(c,5e3),TOL.Module.sendSilverPopLeadInfo("Standard"),dataLayer.push({event:"Standard Lead"}),window.rec.UTILS.trigger(document.body,"ConfirmedLead",{type:"Email Seller"})):(t.find("#submitEmail").show(),alert(a.Errors[0]))},emailSentModal:function(){TOL.Module.Modal.loading(),e.ajax({url:"/gettiledata/addetail_emailsentpage/loadModal",data:{adId:e(".emailSellerBtn").data("adid"),dealerId:e(".emailSellerBtn").data("dlrid")},dataType:"json",success:function(e){o.apply(this,[e])}})},emailGetPriceCallback:function(a,t){if(e(this).parent().find("#ajaxload").hide(),1==a.success){if(t.find("h2.price").length>0)var i="Get Best Price";else var i="Request Price";e(this).html("<div class='text-success center'data-lead-type='Email Lead'data-lead-status='Confirmed'data-lead-cat='"+i+"'><i class='fa fa-check fa-3x'></i><br>Message Sent!<br></div>"),TOL.Module.Listing.emailSentModal(),setTimeout(c,5e3),TOL.Module.sendSilverPopLeadInfo(i),dataLayer.push({event:i}),window.rec.UTILS.trigger(document.body,"ConfirmedLead",{type:i})}else{t.find("#submitEmail").show();var l=a.sMessage;0==l.length&&(l="Unknown error processing request."),alert(l)}},emailGetTradeInCallback:function(a,t){if(e(this).parent().find("#ajaxload").hide(),1==a.success)e(this).html("<div class='text-success center'data-lead-type='Email Lead'data-lead-status='Confirmed'data-lead-cat='Trade-In'><i class='fa fa-check fa-3x'></i><br>Message Sent!<br></div>"),TOL.Module.Listing.emailSentModal(),setTimeout(c,5e3),TOL.Module.sendSilverPopLeadInfo("Trade-In"),dataLayer.push({event:"Trade In"}),window.rec.UTILS.trigger(document.body,"ConfirmedLead",{type:"Trade-In"});else{t.find("#submitEmail").show();var i=a.sMessage;0==i.length&&(i="Unknown error processing request."),alert(i)}},reportfraudCallback:function(a,t){try{a=e.parseJSON(a)}catch(i){a={Errors:["Unknown Error"]}}e(this).parent().find("#ajaxload").hide(),0==a.Errors.length?(e(this).html("<div class='text-success center'data-lead-type='Report-Fraud'data-lead-status='Confirmed'data-lead-cat='Report-Fraud'><i class='fa fa-check fa-3x'></i><br>Message Sent!<br></div>"),TOL.Module.Listing.emailSentModal(),setTimeout(c,5e3)):(t.find("#submitEmail").show(),alert(a.Errors[0]))},silverpopTracking:function(){var a={make:"view-make",model:"view-model",trim:"view-trim","class":"view-type",category:"view-category",year:"view-year",price:"view-price",state:"view-state",fuelType:"fuel-type",dealer:"view-dealer",length:"view-length",grossVehicleWeight:"view-gross-vehicle-weight"};e.each(a,function(a,t){var i=e("input#"+a);i.length>0&&""!=i.val()&&ewt.trackLink({name:i.val(),type:t})})},handlePrivatePartyCall:a}}(jQuery);
TOL.Module.Listings=function(e){var t,a=e("#recaptchaKey").val(),i=0,n=e("#pageSize").text(),o=e("#listingsContainer"),s=300,r=t=null,l=tolConfig.getRealmSearchTerm(),c="find-"+l,d=tolConfig.getRealmDealersTerm(),h=function(){function i(e){TOL.Module.Modal.loadModal(e);var t=TOL.Module.Modal.getModalElement();t.find("#submitEmail").click(function(){TOL.Module.Listing.submitEmail.apply(this,[t])}),grecaptcha.render(t.find(".g-recaptcha")[0],{sitekey:a})}function n(t){var a=e(t.originalEvent.target);if(!(a.hasClass("saveListing")||a.hasClass("dealerGroupLink")||a.parent().hasClass("saveListing")||a.hasClass("location")||a.hasClass("CAO")||a.hasClass("listing-sponsored")||0!=a.parents(".listing-sponsored").length)){if("undefined"!=typeof Storage&&e(this).find("div.hide")!==!1){var i=e(this).data("adid"),n=e("div[class*=listingContainer]").find("div[class*=listingContainer][data-adid="+i+"]");"undefined"!==n&&(n.find("div.viewedBox").removeClass("hide"),n.find("a:first img").addClass("viewed")),p("adIds",i),e(t).find("div[class*=listingContainer] div").removeClass("hide")}void 0!=e(this).data("url")&&(t.preventDefault(),location=e(this).data("url"))}}if(!(window.location.pathname.search(l)==-1&&window.location.pathname.search("/"+d+"/detail")==-1&&window.location.pathname.search("/dealergroups/detail")==-1&&window.location.pathname.search("/myt/saved-listings")==-1&&window.location.pathname.search("/"+c)==-1&&window.location.pathname.search("/price-checker")==-1&&window.location.pathname.search("/"+d+"/results")==-1||(window.location.pathname.search("/myt/saved-listings")!=-1&&(o=e("#mytSearchPage")),e("#viewAllTopicLinks").click(function(){var t=e("#topicLinks");t.find(".truncate").removeClass("truncated"),e(this).hide(),e("#hideAllTopicLinks").show()}),e("#hideAllTopicLinks").click(function(){var t=e("#topicLinks");t.find(".truncate").addClass("truncated"),e(this).hide(),e("#viewAllTopicLinks").show()}),f(),e(".viewTopicSpecs").click(function(){e("#topicSpecs").toggle(),e(".hidetext").toggle(),e(".viewtext").toggle()}),window.location.pathname.search(l)==-1&&window.location.pathname.search("/"+d+"/detail")==-1&&window.location.pathname.search("/dealergroups/detail")==-1&&window.location.pathname.search("/myt/saved-listings")==-1&&window.location.pathname.search("/"+c)==-1&&window.location.pathname.search("/price-checker")==-1||window.location.search.search("vrsn=links")>=0))){"desktop"==device_detection&&e("#sortbarPOS").length&&e(window).scroll(function(){var t=e("#sortbarPOS").offset().top;e(this).scrollTop()>t?e(".rezDetailsHdr").addClass("sticky"):e(".rezDetailsHdr").removeClass("sticky");var a=e("#refinePOS").offset().top;e(this).scrollTop()>a?e("#refine-main").hasClass("sticky")||(e("#refine-main").addClass("sticky"),e("#admedia-left1").addClass("sticky"),e("#refinePanel").removeClass("in").height("auto"),e("#refineCollapse").removeClass("hide"),e("#refineCollapse i").addClass("fa-caret-down"),e("#refineCollapse i").removeClass("fa-caret-up")):(e("#refine-main").removeClass("sticky"),e("#admedia-left1").removeClass("sticky"),e("#refinePanel").addClass("in").height("auto"),e("#refineCollapse").addClass("hide"))}),"mobile"==device_detection&&window.location.pathname.search(l)&&e(window).scroll(function(){var t=e("#featuredListingsContainer").offset().top;e(this).scrollTop()>t?e("#oas_top_search").fadeIn():e("#oas_top_search").hide()}),"tablet"==device_detection&&window.location.pathname.search(l)&&e(window).scroll(function(){var t=e("#featuredListingsContainer").offset().top;e(this).scrollTop()>t?e("#oas_top_searchtab").fadeIn():e("#oas_top_searchtab").hide()}),e("#refineCollapse, .refineHeaderTxt").click(function(){e("#refinePanel").hasClass("in")?(e("#refineCollapse i").addClass("fa-caret-down"),e("#refineCollapse i").removeClass("fa-caret-up")):(e("#refineCollapse i").addClass("fa-caret-up"),e("#refineCollapse i").removeClass("fa-caret-down"))}),r=t=v(),e(window).bind("popstate",function(e){e.originalEvent.state&&"refine"===e.originalEvent.state.action?TOL.Module.Refinesearch.filterRefineCounts():window.location.pathname.search("/"+c)==-1&&window.location.pathname.search("/price-checker")==-1&&(TOL.Module.Refinesearch.isColumn()||TOL.Module.Refinesearch.cancelRefine(),""!=location.search&&location.search!=t.getQuery()&&(C(),w()))}),C(),m();try{var s=e("#initialPagination").text();s&&S(e.parseJSON(s))}catch(h){}if(o.on("click","#bestPrice",function(t){if(t.stopPropagation(),t.preventDefault(),"desktop"===device_detection)TOL.Module.Modal.loading(),e.ajax({url:"/gettiledata/addetail_emailbestpricepage/loadModal",data:{title:e.trim(e(this).text()),adId:e(this).data("adid"),dealerId:e(this).data("dlrid")},dataType:"json",success:i});else{var a=e(this).parents("div.listingContainer");0===a.length&&(a=e(this).parents(".listingContainer-list")),location=a.data().url.replace("/listing/","/listing/email/bestprice/")}}).on("click",".requestPrice,.gridRequestPrice",function(t){if(t.stopPropagation(),t.preventDefault(),"desktop"===device_detection)TOL.Module.Modal.loading(),e.ajax({url:"/gettiledata/addetail_emailrequestpricepage/loadModal",data:{adId:e(this).data("adid"),dealerId:e(this).data("dlrid")},dataType:"json",success:i});else{var a=e(this).parents("div.listingContainer");0===a.length&&(a=e(this).parents(".listingContainer-list")),location=a.data().url.replace("/listing/","/listing/email/bestprice/")}}).on("click","#emailLink",function(t){t.stopPropagation(),t.preventDefault();var a=e(this).parents("div.listingContainer");0===a.length&&(a=e(this).parents(".listingContainer-list")),"desktop"===device_detection?location=a.data().url+"#emailSection":location=a.data().url.replace("/listing/","/listing/email/seller/")}),"undefined"!=typeof Storage){var k=g("adIds");for(var L in k){var T=e("div#listingsContainer").find("div[class*=listingContainer][data-adid="+k[L]+"]");"undefined"!==T&&(T.find("div.viewedBox").removeClass("hide"),T.find("a:first img").addClass("viewed"))}}e("#listingsContainer").on("click","div.listingContainer",n),e("#listingsContainer").on("click","div.listingContainer-list",n),u(),TOL.Module.Refinesearch.isColumn()||location.search.indexOf("advanced_search")==-1||(e("#refinePage").show(),TOL.Module.Refinesearch.setRefining(!0),TOL.Module.Refinesearch.init(),TOL.Module.Refinesearch.filterRefineCounts()),e("#listingsContainer img").on("error",function(){e(this).attr("src","https://"+tolConfig.cdnDomain+"/image-coming-soon-512.png")}),e("* .refineButtons").filter(":first").attr("data-track",e("* .refineButtons").filter(":first").attr("data-track")+" - Top"),e("* .btnSaveSearch").filter(":first").attr("data-track",e("* .btnSaveSearch").filter(":first").attr("data-track")+" - Top"),e("* #sortButton").filter(":first").attr("data-track",e("* #sortButton").filter(":first").attr("data-track")+" - Top"),e("* .refineButtons").filter(":last").attr("data-track",e("* .refineButtons").filter(":last").attr("data-track")+" - Bottom"),e("* .btnSaveSearch").filter(":last").attr("data-track",e("* .btnSaveSearch").filter(":last").attr("data-track")+" - Bottom"),e("* #sortButton").filter(":last").attr("data-track",e("* #sortButton").filter(":last").attr("data-track")+" - Bottom"),e(".callButton").click(TOL.Module.Listing.handlePrivatePartyCall)}},f=function(){e("#topicLinks");e("#linkList li").length>8?e("#viewAllTopicLinks").show():e("#viewAllTopicLinks").hide(),e("#hideAllTopicLinks").hide()},u=function(t){t=t||!1;var a=e("#featured-demo");if(1==t&&(a=e("#modalCarousel").find("#featured-demo")),0!=a.length){var i=Math.ceil(e(window).width()/s);a.featuredCarousel({items:i,lazyLoad:!0,navigation:!0,itemsDesktopSmall:[979,5],itemsTablet:[768,3],itemsMobile:[479,2]});var n=a.data().featuredCarousel;n.calculateWidth=function(){n.itemWidth=300},n.calculateAll(),e("#featured-demo img").on("error",function(){e(this).attr("src","https://"+tolConfig.cdnDomain+"/image-coming-soon-512.png")})}},p=function(e,t){try{var a=g(e);a.push(t),sessionStorage.setItem(e,JSON.stringify(a))}catch(i){}},g=function(e){try{return JSON.parse(sessionStorage.getItem(e))||[]}catch(t){return[]}},m=function(){function a(){if(TOL.Module.Refinesearch.setRefining(!0),TOL.Module.Refinesearch.setColumn(!1),window.history.pushState){var e=t.getQuery();window.history.pushState({action:"refine"},"title",e)}TOL.Module.Refinesearch.filterRefineCounts()}e("#searchPage").on("change","select#listingsSortSelect",function(){t.set("sort",e(this).val()),w()}),e("#searchPage").on("click",".sortModalButton",function(){TOL.Module.Modal.loadModal({title:"Update Sort",body:e(".sortModal:first").html()}),e(".sortOption").click(function(){t.set("sort",e(this).data("value")),w(),e(".sortOption").removeClass("bold").find("i").addClass("hide"),e('.sortOption[data-value="'+e(this).data("value")+'"]').addClass("bold").find("i").removeClass("hide"),TOL.Module.Modal.close()})}),e("#searchPage").on("click",".sortSelection",function(){var a=e(this).attr("data-val"),i=null,n=a.split(":");if(e(this).find("i.fa-sort").length&&(i=n[1]),e(this).find("i.fa-sort-asc").length&&(i="desc"),e(this).find("i.fa-sort-desc").length&&(i="asc"),e(".sortSelection i.fa-sort").removeClass("fa-sort-asc fa-sort-desc"),null!=i&&(a=n[0]+":"+i,e(this).find("i").addClass("fa-sort-"+i)),e(".sortSelection.btn-gray").removeClass("btn-gray").addClass("btn-default"),null!=TOL.getGet("affilid")){var o=e(this).css("backgroundColor"),s=e(this).css("border-color");e(".sortSelection").css("background-color",o),e(".sortSelection").css("border-color",s)}e(this).removeClass("btn-default").addClass("btn-gray"),t.set("sort",a),t.set("page",1),w()}),e("#searchPage").on("click","a#pageNext",function(){t.nextPage(),w()}),e("#searchPage").on("click","a#pagePrev",function(){t.prevPage(),w()}),e("#searchPage").on("click","a.pageJump",function(){var a=e(this).data("page");t.set("page",a),w()}),e("#searchPage").on("click","*#refineButton",a),e("#searchPage").on("click","*#newButton",a),e(".refineLink").click(a)},v=function(t){var a=new TOL_API_SEARCH(e("#adResource").text(),{view:"full",includeFilterCounts:!0,filterCountLimit:5e3},e("#pageSize").text());for(var i in t)a.set(i,t[i]);if(a.get("sort")||"desktop"!=device_detection&&a.set("sort","distance:asc"),"distance"!=a.get("sort")||a.get("latitude")&&a.get("longitude")||a.get("zip")||(a.set("sort","year"),a.set("sortOrder","descending")),window.location.pathname.search("/"+d+"/detail")>=0||window.location.pathname.search("/dealergroups/detail")!=-1){var n=e("#dealerId").html();n&&n.length&&a.set("dealerid",n.split(","))}return a},C=function(){if(!(window.location.pathname.search("/"+d+"/detail")>=0||window.location.pathname.search("/dealergroups/detail")!=-1)||0!=window.location.search.length){for(var a=/([^?&]*)=([^&]*)/g,i=a.exec(location.href),n=!1,o={};null!=i;){var s=decodeURIComponent(i[1]),l=decodeURIComponent(i[2].replace(/\+/g," "));o[s]=l,i=a.exec(location.href),"savedSearch"==s&&(n=!0)}if(o.sort?"desktop"!=device_detection&&"distance:asc"==o.sort&&e(".sortSelectRez").val("geo_distance:asc"):"desktop"==device_detection?(e(".sortSelectRez").val("featured:asc"),e('.sortSelection[data-val="featured:asc"]').removeClass("btn-default").addClass("btn-gray")):e(".sortSelectRez").val("geo_distance:asc"),r=t=v(o),window.history.replaceState){var c=t.getQuery();location.search!=c&&window.history.replaceState({},document.title,c),TOL.Module.Mobile.storeHref()}n&&w()}},w=function(){k(),window.scrollTo(0,0),e("#ajaxloading").show(),t.isDirty&&e.ajax({url:"/ajax/"+l+t.getQuery(),success:L})},k=function(){o.children(":not(#noListings)").remove()},L=function(a){e("#ajaxloading").hide(),A(t._params),o.html(a),TOL.Module.ContacAtOnce.init(),t.get("zip")||t.get("lat")&&t.get("long")?e('.sortSelection[data-val="geo_distance:asc"]').removeClass("hide"):e('.sortSelection[data-val="geo_distance:asc"]').addClass("hide"),TOL.Module.Refinesearch.isRefining()?(TOL.Module.Refinesearch.filterRefineCounts(),TOL.Module.Refinesearch.isColumn()?x():TOL.Module.GPTAjax.reloadAds(TOL.Module.Listings.getUrlVars())):x(),null!=TOL.getGet("affilid")&&B(),e(".callButton").click(TOL.Module.Listing.handlePrivatePartyCall);var i=e("#topicTitleRefresh"),n=e("#topicDescriptionRefresh"),s=e("#topicLinksRefresh"),r=e("#topicLogoRefresh"),l=e("#topicSeoLinkRefresh"),c=e("#topicViewAllTitleRefresh"),d=e("#topicSpecsRefresh");if(i.length&&e("#topicTitle").html(i.html()),n.length&&e("#topicDescription").html(n.html()),s.length&&e("#linkList").html(s.html()),e("#topicSpecsRefresh").is(":empty")||e("#topicSpecs").is(":empty")?e("#viewTopicSpecsButton").hide():(e("#topicSpecs").html(d.html()),e("#viewTopicSpecsButton").show()),r.length&&e("#topicLogo").attr("src",r.text()).removeClass("noShow"),l.length&&e("#topicSeoLink").html(l.html()),c.length&&e(".topicViewAllTitle").html(c.html()),e("#topic").show(),TOL.Module.ContacAtOnce.init(),f(),parseInt(t.get("page"))>1)e("#featuredListingsContainer").html("");else{var h=e("#featuredListingsRefresh");h.length&&e("#featuredListingsContainer").html(h.html())}var p=e("#breadcrumbsRefresh");p.length&&e(".breadcrumbs").html(p.html());var g=e("#priceCheckerMaxRefresh"),m=e("#priceCheckerMinRefresh"),v=e("#priceCheckerAverageRefresh");g.length>0&&(e("#priceCheckerMax").html(g.html()),e("#priceCheckerMin").html(m.html()),e("#priceCheckerAverage").html(v.html()));var C=e("#initialPagination").text();C&&S(e.parseJSON(C)),e("img.lazy").unveil(300),e("#listingsContainer img").on("error",function(){e(this).attr("src","https://"+tolConfig.cdnDomain+"/image-coming-soon-512.png")}),u();var w=location.href.match(/sort=([^&$]+)/);null!==w&&e(".sortSelectRez").val(decodeURIComponent(w[1])),TOL.Module.Mytrader.getMytraderData(t.getQuery()),o.trigger("ajax_listings_refresh")},S=function(a){var o=a.offset||0,s=a.limit||0;if(i=a.total||0,0==s)"undefined"==typeof t._affilParams.affilid&&e(".pageInfo").hide();else{var r="<span>"+(o+1)+" - "+(o+s)+"</span>",l="<span>"+i+"</span>";e(".pageInfo").html('<div class="listingsTitle customPageInfo">Matches '+r+" of <b>"+l+"</b></div>").show()}var c=parseInt(o/n)+1,d=Math.ceil(i.replace(",","")/n);1==c?e("#pagePrev").hide():e("#pagePrev").show(),c>=d?e("#pageNext").hide():e("#pageNext").show()},T=function(){return t._params},y=function(){return t.getQuery()},M=function(){return t._affilParams},O=function(){return t.clone()},b=function(e){t=e,w()},R=function(){t=new TOL_API_SEARCH(e("#adResource").text(),{view:"full",includeFilterCounts:!0,filterCountLimit:5e3},e("#pageSize").text())},P=function(){return t.results},_=function(){var e=location.search.substr(1).match(/(.*?)=(.*?)(&|$)/g),t={};for(var a in e){var i=e[a].match(/(.*?)=(.*?)(&|$)/);t[i[1]]=i[2]}return t},x=function(){var e=t.getQuery();window.history.pushState&&window.history.replaceState&&(location.search!=e?(window.history.pushState({},document.title,e),TOL.Module.Mobile.storeHref()):window.history.replaceState({},document.title,e)),window.location.pathname.search("/"+c)==-1&&window.location.pathname.search("/price-checker")==-1&&TOL.Module.GPTAjax.reloadAds(TOL.Module.Listings.getUrlVars())},A=function(t){var a="";["make","model","trim"].forEach(function(e){t[e]&&(a+=t[e].split("|")[0]+" ")}),e("#listingBtnGroup h2").text(a.trim())},B=function(){"undefined"!=typeof t._affilParams.primarycolor&&(e(".premiumListing .listing-info-bottom").css("background",hexToRgb("#"+t._affilParams.primarycolor,.8)),e(".media-counts").css("background-color","#"+t._affilParams.primarycolor),e("div.list-buttons").find(".price").css("color","#"+t._affilParams.primarycolor),e(".tagline").css("color","#"+t._affilParams.primarycolor))};return{init:h,setSearchParam:function(e,a){t.set(e,a)},saveSearch:x,featuredCarousel:u,getUrlVars:_,getSearchData:P,getSearchParams:T,getSearchQuery:y,getAffiliateParams:M,resetSearchObject:b,loadSearch:w,cloneSearchObject:O,clearSearchObject:R}}(jQuery);
TOL.Module.LoanCalculator=function(a){return{fields:["amount","rate","years","payment"],emptyFields:0,emptyField:"",init:function(){a("div.loanCalc a#loanCalcCalculate").click(loanCalc.calculateForm),a("div.loanCalc a#loanCalcClear").click(loanCalc.clearForm)},calculateForm:function(){loanCalc.getEmptyFields(),1==loanCalc.emptyFields?loanCalc[loanCalc.emptyField+"Calc"]():0==loanCalc.emptyFields&&loanCalc.paymentCalc()},getEmptyFields:function(){loanCalc.emptyFields=0,loanCalc.emptyField="",a("div.loanCalc").find("input").each(function(){loanCalc.fields[a(this).attr("name")]=loanCalc.clean(a(this).val()),loanCalc.fields.indexOf(a(this).attr("name"))!=-1&&""==a(this).val()&&(loanCalc.emptyFields++,loanCalc.emptyField=a(this).attr("name"))})},clearForm:function(){a("div.loanCalc").find("input").val("")},numberFormat:function(a){var l=(Math.floor(100*a+.5)/100).toString();for(l.search("\\.")==-1&&(l+=".");l.length-l.search("\\.")<3;)l+="0";for(var n=0;n<(l.length+2)/4-2;n++)l=l.substr(0,l.length-6-4*n)+","+l.substr(l.length-6-4*n);return l},clean:function(a){if(!a.replace)return a;var l=a.replace("$","");return l.replace(",","")},paymentCalc:function(){var l=12,n=loanCalc.fields.rate/100,e=loanCalc.fields.years,t=e*l,o=loanCalc.fields.amount,c=1-Math.pow(1+n/l,-t);return n<.01?void a("div.loanCalc input[name='payment']").val("$"+loanCalc.numberFormat(o/t)):void a("div.loanCalc input[name='payment']").val("$"+loanCalc.numberFormat(o*n/(c*l)))},amountCalc:function(){var l=12,n=loanCalc.fields.rate/100,e=loanCalc.fields.years,t=e*l,o=loanCalc.fields.payment,c=1-Math.pow(1+n/l,-t);a("div.loanCalc input[name='amount']").val("$"+loanCalc.numberFormat(o*l*c/n))},rateCalc:function(){""==a("div.loanCalc input[name='rate']").val()&&a("#pymt").html("")},yearsCalc:function(){var l=12,n=loanCalc.fields.amount,e=loanCalc.fields.years,t=e*l,o=loanCalc.fields.payment,c=loanCalc.fields.rate/(100*l);1-Math.pow(1+c/l,-t);a("div.loanCalc input[name='years']").val(loanCalc.numberFormat(Math.log(1+c/(o/n-c))/Math.log(1+c)/l))}}}(jQuery),loanCalc=TOL.Module.LoanCalculator;
TOL.Module.LocatorLeads=function(t){var a=function(){t("#submitForm").click(function(){r()})},r=function(){var a=!0,r="",e={};t(".locator").find(":input").each(function(){!t(this).attr("required")||""!=t(this).val().trim()&&t(this).val().trim()!=t(this).attr("defaultValue")?t(this).attr("validation")&&t(this).val().trim().search("^"+t(this).attr("validation")+"$")==-1&&(t(this).attr("required")||""==!t(this).val().trim())?(a=!1,"undefined"!=typeof t(this).attr("defaultValue")?r+=t(this).attr("defaultValue")+" is invalid.\n":(errorText=t(this).attr("placeholder"),r+=errorText.replace("(Required)","")+"is invalid.\n")):t(this).is(":checkbox")?e[t(this).attr("name")]=t(this).is(":checked"):e[t(this).attr("name")]=jQuery.trim(t(this).val()):(a=!1,"undefined"!=typeof t(this).attr("defaultValue")?r+=t(this).attr("defaultValue")+" is required.\n":(errorText=t(this).attr("placeholder"),r+=errorText.replace("(Required)","")+" is required.\n"))}),""!=r?alert(r):(t(this).hide(),t(this).parent().append("<center><i id='ajaxload' class='fa fa-cog fa-spin fa-2x'></i></center>"),t.ajax({url:"/Gettiledata/locatorleads/sendlead/",type:"POST",data:e,context:t(this).parent(),success:function(t){locatorLeadsCallback.apply(this,[t])}}))};return locatorLeadsCallback=function(a){try{a=t.parseJSON(a)}catch(r){a={Errors:["Unknown Error"]}}t(this).find("#ajaxload").remove(),0==a.Errors.length?t("#errorOther").html(a.Status).show():(t(".locator").find("#submitForm").show(),alert(a.Errors[0]))},{init:a}}(jQuery);
TOL.Module.Mainsearch=function(e){function a(){e("#type-icons li").removeClass("type-selected"),e("#type-icons li i").removeClass("fa-check"),e(this).addClass("type-selected"),e(this).find("i").addClass("fa-check"),e("#classSelect").val(e(this).attr("data-typevalue")),s(),t("type",e(this).attr("data-typevalue"))}function t(a,t){a.search("Price")!=-1&&(a="price",t=e('select[name="minPrice"]').val()+":"+e('select[name="maxPrice"]').val());var o=e("#advancedSearchLink");if(o.length>0){var r=o.attr("href").split("?");1==r.length&&(r[1]=""),params=r[1].split("&"),paramMap={};for(var i in params)paramParts=params[i].split("="),2==paramParts.length&&(paramMap[paramParts[0]]=decodeURIComponent(paramParts[1]));paramMap[a]=decodeURIComponent(t),r[1]=e.param(paramMap),o.attr("href",r.join("?"))}}var o={},r=function(){realmDealersTerm=tolConfig.getRealmDealersTerm();var r=new RegExp("^/"+realmDealersTerm+"/?$");if(window.location.pathname.search(r)!=-1||window.location.pathname.search(/^\/campgrounds\/?$/)!=-1||window.location.pathname.search(/^\/rentals\/?$/)!=-1||window.location.pathname.search(/^\/index-partners\/?$/)!=-1){e("#submit_button, #submit_button_advanced").click(p),e("#searchForm").submit(p),e("#modelText").keydown(function(a){if(13==a.keyCode)return e("#sugs").hide(),!1});var c=TOL.cookie.get("homepageForm");if(c&&(o=JSON.parse(c),o.type&&a.apply(e('#type-icons li[data-typevalue="'+o.type+'"]'))),e("#classSelect").change(s),e(":input").change(function(){t(e(this).attr("name"),e(this).val())}),s(),TOL.Module.Listings.featuredCarousel(),e("#type-icons li").click(a),e('[data-toggle="popover"]').popover(),i(),"desktop"==device_detection){var d=TOL.cookie.get("location");if(d){var m=JSON.parse(d);e("#zip_code").val(m.zipCode)}n()}else l();e("#makeSelect").click(function(){""!=e(this).val()?(e("#modelText").val(""),e("#modelText").attr("placeholder","Enter a Model")):e("#modelText").attr("placeholder","Enter a Keyword"),e("#sugs").hide()}),e("#modelText").on("focus",function(){"mobile"==device_detection&&window.scrollTo(0,e(this).offset().top-20)})}},i=function(){var a=tolConfig.typeIconPopover().types;for(var t in a)a&&e("li."+t).attr("data-content",a[t])},n=function(){var a={device_detection:"desktop"};e.ajax({url:"/gettiledata/listingsFeatured/featuredListings",data:a,success:function(a){e("#listingsFeatured").html(a),TOL.Module.Listings.featuredCarousel()}})},l=function(){e(".useMyLocation").click(function(){TOL.Module.geoLocate.featuredListings()})},s=function(){var a=aurora_manufacturers,t=aurora_cms_manufacturers,r=e("#makeSelect"),i=r.find("option:first").text();r.find("option").remove(),r.find("optgroup").remove(),r.append('<option value="">'+i+"</option>");var n=e("#classSelect").val();if(n.search("\\|")!=-1){var l=n.split("|");n=5==tolConfig.getRealmId()&&4==l.length?"":3==tolConfig.getRealmId()&&4==l.length?l[2]:l[1]}if(t&&t[n]&&t[n].length){var s=e("<optgroup />");s.attr("label","Top Makes"),t[n].sort(function(e,a){return e.name.toLowerCase().localeCompare(a.name.toLowerCase())});for(var c in t[n])s.append('<option value="'+t[n][c].name+"|"+t[n][c].id+'">'+t[n][c].name+"</option>");r.append(s)}var p=e("<optgroup />");p.attr("label","All Makes"),a[n].sort(function(e,a){return e.name.toLowerCase().localeCompare(a.name.toLowerCase())});for(var c in a[n])p.append('<option value="'+a[n][c].name+"|"+a[n][c].id+'">'+a[n][c].name+"</option>");r.append(p),o.make&&r.find('option[value="'+o.make+'"]').attr("selected",!0)},c=function(){var a={};""!=e("input[name='lat']").val()&&""!=e("input[name='long']").val()&&(a.LAT=e("input[name='lat']").val(),a.LONG=e("input[name='long']").val()),void 0!=TOL.getGet("test")&&(a.test=TOL.getGet("test")),TOL.Module.GPTAjax.reloadAds(a)},p=function(){for(var a=e("#searchForm"),t={},o=e(a).find(":input"),r="*",i="*",n=e("#zip_code").val(),l={},s=TOL.Module.Keywordsearch.getAutocompleteURL(),c="",p=0;p<o.length;p++)if(""!=e(o[p]).val())switch(c=e(o[p]).attr("name"),o[p].type){case"select-one":if("minPrice"==c){r=e(o[p]).val();break}if("maxPrice"==c){i=e(o[p]).val();break}case"hidden":case"text":case"number":case"tel":if("zip"===c&&"Near Me"===e(o[p]).val())break;if("model"===c&&0!=s.length)break;if(""!=e(o[p]).val()&&0!=e(o[p]).val()){var d=e(o[p]).val().split("|");5==d.length?(t.type=d[1]+"|"+d[2],t.category=d[3]+"|"+d[4]):4==d.length?(t.type=d[0]+"|"+d[2],"1049212410"!==d[2]&&(t.category=d[1]+"|"+d[3])):("model"==c&&""==e("#makeSelect").val()&&(c="keyword"),t[c]=e(o[p]).val())}"affilid"==c&&(t.vrsn="iframe"),"primarycolor"==c&&(t.primarycolor=e(o[p]).val()),"backgroundcolor"==c&&(t.backgroundcolor=e(o[p]).val()),"allowed_source"==c&&"both"==e(o[p]).val()&&delete t[c]}if("*"!=r||"*"!=i){var m=Number(e("select[name=minPrice] option:last").val());Number(r)>Number(i)?(r==m&&(r="*"),t.price=i+":"+r):(i==m&&(i="*"),t.price=r+":"+i)}if(void 0!=this.id&&"submit_button_advanced"==this.id&&(t.advanced_search=1),void 0==t.sort&&"desktop"==device_detection?window.location.pathname.search(/^\/campgrounds|rentals|dealers\/?$/)!=-1&&(""!=n?t.sort="geo_distance:asc":t.sort="name:asc"):t.sort="distance:asc",!(void 0==n||e.isNumeric(n)&&5==n.length||""==n||"Near Me"==n))return alert("Invalid Zip"),!1;l.zipCode=n,TOL.cookie.set("location",JSON.stringify(l),365),""==n&&delete t.radius;var u=[],v=[];if(""!=t.type&&(u=t.type),""!=t.make&&(v=t.make),TOL.cookie.set("homepageForm",JSON.stringify({type:u||null,make:v||null})),"mobile"!=device_detection)if(e('select[id^="type"]').length)t.type=e('select[id^="type"]').val();else{var f=e("#type-icons .type-selected");if(f.length>0&&f.attr("data-typevalue").length>0){var g=f.attr("data-typevalue").split("|");if(5==tolConfig.getRealmId()&&4==g.length){var h=g[0]+"|"+g[2]+","+g[1]+"|"+g[3];t.type=h}else if(3==tolConfig.getRealmId()&&4==g.length){var h=g[0]+"|"+g[2],y=g[1]+"|"+g[3];t.type=h,t.category=y}else t.type=f.attr("data-typevalue")}}var k="";if(""!==s){parseAutocomplete=s.split("&");for(var p in parseAutocomplete)k=parseAutocomplete[p].split("="),t[k[0]]=k[1]}if(""!=t.model&&void 0==t.trim&&(t.modelkeyword=1),null!==tolConfig.getOverwriteTypeId()){var w=tolConfig.getOverwriteTypeId();301857===w&&window.location.pathname.search(/^\/dealers\/?$/)!=-1?t.type="Snowmobile|301857":9404794===w&&window.location.pathname.search(/^\/dealers\/?$/)!=-1?t.type="Personal Watercraft|9404794":301857!=w&&9404794!=w&&(t.type=w)}return location=e("#searchPage").html()+"?"+e.param(t),!1};return{priority:"last",init:r,loadHomePageAdvertising:c}}(jQuery);
TOL.Module.Modal=function(d){function o(){e=d("#mytraderModal")}function i(d){e.find("#hdrSaveSearch").html(d.title),e.find(".modalContent").html(d.body),d.wide?e.addClass("percent75"):e.removeClass("percent75"),d.title||d.body?TOL.Module.ModalWindow.show(e.attr("id")):TOL.Module.ModalWindow.hide(e.attr("id")),e.find(".modalclose").click(n)}function n(){TOL.Module.ModalWindow.hide(e.attr("id"))}function t(){i({title:"Loading...",body:'<div class="center padding20"><i class="fa fa-cog fa-2x fa-spin"></i></div>'})}var e;return{init:o,close:n,loadModal:i,loading:t,getModalElement:function(){return e}}}(jQuery);
TOL.Module.MytraderListingEdit=function(e){function a(){if(window.location.pathname.search(/\/myt\/listings\/closePaymentModal/)!==-1)return void window.parent.TOL.Module.MytraderListingEdit.processPayment(TOL.getGet("orderId").substr(1));if(window.location.pathname.search(/\/myt\/listings\/confirm/)!=-1)return void D();if(window.location.pathname.search(/\/myt\/listings\/emailleads/)!=-1)return void U();if(window.location.pathname.search(/\/myt\/listings\/(edit|create)/)!=-1){F(),e(".submitCreateEditForm").click(Y),null!==location.pathname.match(/listings\/create\/?$/)&&(e(".modalhdrclose").unbind("click.modalWindow").click(function(){t();var e="/myt/listings/create/customer0",a=TOL.getGet("package");a&&(e+="?package="+a);var o=TOL.getGet("affilid");o&&(e+="&affilid="+o);var i=TOL.getGet("zmc");i&&(e+="&zmc="+i),location=e}),TOL.Module.Mytrader.send("myt/listings/create/newAd","POST",{affilid:TOL.getGet("affilid"),zmc:TOL.getGet("zmc")},"save",function(){e("#skipForNowButton").click(t)})),n(),m(),v(),w(),M(e.parseJSON(e("#listingInfo").text())),e("#upsellPhotos").click(l),e("#upsellVideo").click(l),e(".next-button").click(function(){var a=e(this).data("step"),t=a+1,o=e("#collapseStep"+a);o.collapse("hide"),e("#collapseStep"+t).collapse("show"),e(window).scrollTop(o.offset().top),1===a&&I(z,!0)}),e(".miniPreview").click(function(){e.ajax({url:e(this).data("link"),success:function(a){TOL.Module.Modal.loadModal({title:"Preview",body:a}),TOL.Module.Listing.init(),e("#share").remove(),e(".breadcrumbs").remove(),e(".rsFullscreenBtn").remove(),e("#Gallery").data("royalSlider").isFullscreen=!0}})}),e(".collapseStep").click(function(){var a=[];if(!e(this).hasClass("collapsed")){var t=e(this).data("step"),o=t+1;a=e("#collapseStep"+o)}e(".paa-step .collapse").collapse("hide"),a.length&&a.collapse("show")}),e(".collapseStep").siblings(".collapse").on("shown.bs.collapse",function(){window.scrollTo(0,e("#step1Validation").offset().top),R.refresh()}),e(".collapseStep").siblings(".collapse").on("hidden.bs.collapse",function(){window.scrollTo(0,e("#step1Validation").offset().top)}),e("#myt-paa-summary-mobile").on("shown.bs.collapse",function(){e("#summary-view-hide").html(" Hide")}),e("#myt-paa-summary-mobile").on("hidden.bs.collapse",function(){e("#summary-view-hide").html(" View")}),"#step2"===location.hash&&e("#step2 .collapseStep").click(),"3"===TOL.getGet("step")&&e("#step3 .collapseStep").click(),e(".integerField").keydown(function(e){var a=e.keyCode?e.keyCode:e.which;a>=58&&(a<=95||a>=106)&&8!=a&&e.preventDefault()}),e(".integerField").keyup(function(a){e(this).val().length>e(this).attr("maxlength")&&e(this).val(e(this).val().substr(0,e(this).attr("maxlength")))}),e("#loginWithAd").click(function(){TOL.Module.Mytrader.send("myt/listings/create/newAd","POST",{isSecond:!0,affilid:TOL.getGet("affilid"),zmc:TOL.getGet("zmc")},"save")}),o(),e(".saveButton").click(V),g(e("#class :selected").data("type"));var a=e("#categoryIds").val();a=a?a.split(","):[],C(a,e("#pagCategories select:last"))}}function t(){TOL.Module.Modal.loadModal({title:"Loading, this may take a few seconds",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'})}function o(){e("#paa-additional-details :input").each(function(a,t){(e(t).is(":checked")||!e(t).is(":checkbox")&&e(t).val())&&e("#paa-additional-details").addClass("in")})}function i(a){c()?e.ajax({url:"/myt/listings/verifyPayment/"+c(),success:function(e){if(e.isDraft)TOL.Module.Modal.loadModal({title:"Unable to process payment",body:e.template}),TOL.Module.Modal.getModalElement().find(".submitCreateEditForm").click(Y);else{var t="/myt/listings/confirm/"+c()+"?orderId="+a,o=TOL.getGet("affilid");o&&(t+="&affilid="+o);var i=TOL.getGet("zmc");i&&(t+="&zmc="+i),location=t}}}):e.ajax({url:"/myt/listings/verifyOrder/"+a,success:function(e){if("complete"!==e.status)TOL.Module.Modal.loadModal({title:"Unable to process payment",body:e.template}),TOL.Module.Modal.getModalElement().find(".submitCreateEditForm").click(TOL.Module.Mytrader.retryLastTransaction);else{var t="/myt/listings/confirm/"+e.adId+"?orderId="+a,o=TOL.getGet("affilid");o&&(t+="&affilid="+o);var i=TOL.getGet("zmc");i&&(t+="&zmc="+i),location=t}}})}function s(){e.ajax({url:"/myt/listings/photoHelp",success:function(e){TOL.Module.Modal.loadModal(e)}})}function r(){e.ajax({url:"/myt/listings/videoHelp",success:function(e){TOL.Module.Modal.loadModal(e)}})}function l(){"create"===p()?(TOL.Module.Modal.loadModal({title:"One moment please...",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'}),e.ajax({url:"/myt/listings/upgradeModal/"+c(),success:function(a){a.wide=!0,TOL.Module.Modal.loadModal(a),e("#basicUpgrade").click(function(){k("basic")}),e("#enhancedUpgrade").click(function(){k("enhanced")}),e("#bestUpgrade").click(function(){k("best")})}})):TOL.Module.Mytrader.doUpgrade(c())}function n(){e(".quickUpdate").change(function(){var a={};e(this).is(":checkbox")?a[e(this).data("param")]=e(this).is(":checked")?"yes":"no":a[e(this).data("param")]=e(this).val(),d(a,e(this))}),e("#videoURL").change(function(){var a=e("#addVideo i");a.removeClass("fa-plus").addClass("fa-cog fa-spin"),d({videoUrl:e(this).val()},e(this),function(t){a.addClass("fa-plus").removeClass("fa-cog fa-spin"),t.success&&(e("#videoURL").val(""),e("#videoInput").hide(),e("#videoPreview").show())})}),e("#deleteVideo").click(function(){var a=e(this).find("i");a.removeClass("fa-trash").addClass("fa-cog fa-spin"),d({videoUrl:"delete"},e(this),function(t){a.addClass("fa-trash").removeClass("fa-cog fa-spin"),t.success&&(e("#videoInput").show(),e("#videoPreview").hide())})}),e(".customerUpdate").change(function(){var a=this,t={customer:{}},o=e(this).data("param");t.customer[o]=e(this).val(),d(t,e(a),function(t){"phone"==o&&t.success&&e(a).prop("disabled",!0)})}),e("#showPhone").change(function(){d({customer:{showPhone:!e(this).is(":checked")}},e(this))});var a=e("#options :checkbox");a.change(function(){var t=[];a.each(function(a,o){e(o).is(":checked")&&t.push(e(o).val())}),0===t.length&&(t="empty"),d({options:t},e(this))}),e("#fitmentMake").change(function(){e.ajax({url:"/myt/listings/models",data:{makeId:e(this).val()},success:function(a){x(e("#fitmentModel"),a,null)}})}),e("#fitmentYearFrom").change(function(){var a=e(this).val();e("#fitmentYearTo option").each(function(t,o){a&&e(o).val()&&e(o).val()<a?e(o).prop("disabled",!0):e(o).prop("disabled",!1)})}),e("#fitmentYearTo").change(function(){var a=e(this).val();e("#fitmentYearFrom option").each(function(t,o){a&&e(o).val()&&e(o).val()>a?e(o).prop("disabled",!0):e(o).prop("disabled",!1)})}),e("#addFitment").click(function(){var a=e("#existingFitments ul");e("#fitment-details").collapse("hide"),a.append('<li id="loadingFitment"><i class="fa fa-gear fa-spin"></i></li>');var t={makeId:e("#fitmentMake").val()||null,makeName:e("#fitmentMake").val()?e("#fitmentMake option:selected").text()||null:"",modelId:e("#fitmentModel").val()||null,modelName:e("#fitmentModel").val()?e("#fitmentModel option:selected").text()||null:"",minYear:e("#fitmentYearFrom").val()||null,maxYear:e("#fitmentYearTo").val()||null};if(!t.makeId)return void alert("Please enter a make.");var o=z.fitments;o.push(t),d({fitments:o},e("#fitmentSection :input"),function(){a.find("#loadingFitment").remove()})})}function d(a,t,o){var i=e(t).parents(".collapse").siblings("h4").find("i");t.removeClass("showError"),t.removeClass("failedUpdate"),i.removeClass("fa-check fa-exclamation-circle fa-square-o fa-check-square-o"),i.addClass("fa-cog fa-spin"),H.push(e.ajax({method:"POST",url:location.pathname,data:a,complete:function(a){var s=e.parseJSON(a.responseText);"create"===p()&&"M"!==s.result.listingInfo.status&&("P"===s.result.listingInfo.status?location="/myt/listings":location=location.href.replace("create","edit"));for(var r=0;r<H.length;r++)"pending"!==H[r].state()&&(H.splice(r,1),r--);s.success||(t.addClass("showError"),t.addClass("failedUpdate")),0===H.length&&(i.removeClass("fa-cog fa-spin"),s.success||i.addClass("fa-exclamation-circle"),s.result&&s.result.listingInfo?M(s.result.listingInfo):O()),t.prop("disabled",!1),o&&o(s)}})),t.prop("disabled",!0)}function c(){var e=location.pathname.match(/[0-9]+$/);if(e)return e[0]}function p(){var e=location.pathname.match(/listings\/(.*)\/[0-9]+$/);if(e)return e[1]}function u(a){if(!W){a.find(".deleteBox i").removeClass("fa-trash").addClass("fa-cog fa-spin"),B=!0;var t=e("#imageAddRemove i");t.removeClass("fa-plus fa-camera red").addClass("fa-cog fa-spin"),_.option("disabled",!0),$.push(e.ajax({url:"/myt/listings/removePhoto",method:"POST",data:{adId:c(),mediaId:e(a).data("mediaId")},complete:function(o){for(var i=0;i<$.length;i++)"pending"!==$[i].state()&&($.splice(i,1),i--);if(0===$.length){var s=e.parseJSON(o.responseText);s.success&&(h(s.photos),M(s.listingInfo)),_.option("disabled",!1);var r="fa-plus";"mobile"===device_detection&&(r="fa-camera"),t.removeClass("fa-cog fa-spin red").addClass(r),B=!1}a.remove()}}))}}function m(){var a=e("#imageAddRemove"),t=a.find("i");_=new Sortable(G[0],{group:"photos",filter:"i, .deleteBox, .fa-trash",animation:150,onUpdate:function(){if(!B){W=!0,_.option("disabled",!0),t.removeClass("fa-plus fa-camera red").addClass("fa-cog fa-spin");var a=[];e(this.el).find(".image-uploaded").each(function(t,o){a.push(e(o).data("mediaId"))});var o="fa-plus";"mobile"===device_detection&&(o="fa-camera"),d({photosReorder:a},e(G),function(){t.removeClass("fa-cog fa-spin red").addClass(o),W=!1,_.option("disabled",!1)})}},forceFallback:!0});var o=c();R=new plupload.Uploader({runtimes:"html5,flash,silverlight,html4",browse_button:"pluploadButton",flash_swf_url:"/plupload/Moxie.swf",silverlight_xap_url:"/plupload/Moxie.xap",url:"/myt/listings/addPhoto/"+o,resize:{width:1280,height:1280,quality:90},filters:{max_file_size:"7mb",mime_types:[{title:"Image files",extensions:"jpg,gif,png,bmp,jpeg"}]},drop_element:photoThumbs,init:{FilesAdded:function(a,t){var o=0;for(var i in a.files)a.files[i].status!==plupload.DONE&&o++;if(o>q){var s=o-q,r=a.splice(a.files.length-s);e("#photoPackageDescription").html('Your "'+E(z)+'" package allows up to '+z.maxPhotoCount+" photos."),alert('Your "'+E(z)+'" package allows up to '+z.maxPhotoCount+" photos.  The last "+r.length+" photos will not be uploaded.")}a.start(),f(),setTimeout(function(){a.refresh()},1e3)},FileUploaded:function(a,t,o){var i=e.parseJSON(o.response);i.success?(h(i.photos),M(i.listingInfo),setTimeout(function(){a.refresh()},1e3)):(alert("Error uploading photo.  Please try again or contact customer service."),f())},FilesRemoved:function(){setTimeout(function(){R.refresh()},1e3)},Error:function(e,a){e.removeFile(a.file),alert(a.message+"\nError uploading photo.  Please try again or contact customer service."),f()},PostInit:function(a,t){e(".moxie-shim").click(function(e){q<=0&&(l(),e.preventDefault())})}}}),R.init(),e("#photoUploadTips").click(s),e("#videoUploadTips").click(r)}function h(e){if(f(),e){G.html("");for(var a in e)G.append('<span class="image-uploaded margin-top10 margin-right10 margin-bottom10 margin-left10 borderRadius rel small inlineblock width25p" data-media-id="'+e[a].mediaApiId+'"><img class="width100p" src="'+e[a].url+'?width=512&height=384&quality=60"> <div class="deleteBox"><i class="fa fa-trash"></i></div></span>');f(),setTimeout(function(){R.refresh()},1e3)}}function f(){G.find(".pendingPhoto").remove();for(var e in R.files)R.files[e].status!==plupload.DONE&&G.append('<div class="image-uploaded pendingPhoto realCenter width30p">'+R.files[e].name+'<br><br><i class="fa fa-2x fa-cog fa-spin"></i></div>')}function g(a){a=a||"vehicle",e("#collapseStep1 .collapse").collapse("hide"),e("#collapseStep1 [data-ad-type]").hide(),e("#collapseStep1 [data-ad-type*="+a+"]").show(),"vehicle"===a?(e(".adTypeName").text("Vehicle"),e("#description").attr("placeholder","What should people know about your listing?")):"parts"===a?(e(".adTypeName").text("Part"),e("#description").attr("placeholder","What should people know about your part?")):"accessories"===a&&(e(".adTypeName").text("Gear"),e("#description").attr("placeholder","What should people know about your gear/accessory?"))}function v(){var a=e("#trim");e("#class").change(function(){var t=e(this).val();if(!t)return void x(e("#make"),[],null);var o=e(this).find(":selected").data("type");g(o),d({classId:e(this).val(),adType:y(o)},e(this),function(t){if(t.success&&("AD"==t.result.listingInfo.adType&&(a.attr("disabled",!0),t.result.data&&t.result.data.makes&&x(e("#make"),t.result.data.makes,e("#makeId").val())),t.result.data&&t.result.data.categories)){var o=e("#categoryIds").val();o=o?o.split(","):[],"AD"==t.result.listingInfo.adType?x(e("#category select"),t.result.data.categories,o[0]):x(e('#pagCategories select[data-index="0"]'),t.result.data.categories,o[0])}C([],e("#pagCategories :input"))})}),e("#make").change(function(){var t=e(this).val();t&&(x(e("#model"),null,e("#modelId").val()),d({makeId:t},e(this),function(t){t.success&&(a.attr("disabled",!0),x(e("#model"),t.result.data,e("#modelId").val()))}))}),e("#model").change(function(){var t=e(this).val()||null;return t?(x(a,null,e("#trimId").val()),void d({modelId:t},e(this),function(t){t.success&&(x(a,t.result.data,e("#trimId").val()),t.result.data&&t.result.data.length<2?(a.val(0),a.attr("disabled",!0)):a.attr("disabled",!1))})):(x(a,[{id:"0",name:"None"}],null),a.val(0),void a.attr("disabled",!0))}),a.change(function(){var a=e(this).val()||null;a&&d({trimId:a},e(this))}),e.merge(e("#category"),e("#pagCategories")).on("change",":input",function(){var a=e(this).val();if(a){var t=e("#categoryIds").val();if(t=t?t.split(","):[],1===t.length&&""==t[0]&&(t=[]),e(this).is(":checkbox"))if(e(this).is(":checked"))t.push(a);else{var o=t.indexOf(a);o!==-1&&t.splice(o,1)}else t[e(this).data("index")]=a,t=t.slice(0,e(this).data("index")+1);e("#categoryIds").val(t.join(",")),C(t,e("#pagCategories :input"))}}),a.find("option").length<=2&&a.attr("disabled",!0),e("#year").change(function(){var a=e(this).val()||null;a&&d({year:a},e(this))}),e("#state").change(function(){var a=e(this).val()||null;a&&d({customer:{stateCode:a}},e(this))})}function C(a,t){var o=[];for(var i in a)a[i]&&o.push({id:a[i]});0===o.length&&(o=[""]),d({categories:o},t,function(a){if(a.success&&a.result.data&&a.result.data){var t=[],o=e("#pagCategories").html("");for(var i in a.result.data)a.result.data[i].id&&t.push(a.result.data[i].id);e("#categoryIds").val(t.join(","));for(var i in a.result.data)if(a.result.data[i].subCategories&&a.result.data[i].subCategories.length>0)o.append("<select data-index="+i+'><option value="" class="default">Select a '+(i>0?"Subcategory":"Category")+"</option></select>"),i=parseInt(i),a.result.data[i+1]?x(e('#pagCategories select[data-index="'+i+'"]'),a.result.data[i].subCategories,a.result.data[i+1].id,!0):x(e('#pagCategories select[data-index="'+i+'"]'),a.result.data[i].subCategories,!0);else if(a.result.data[i].multiSubCategories&&a.result.data[i].multiSubCategories.length>0)for(var s in a.result.data[i].multiSubCategories){var r=a.result.data[i].multiSubCategories[s];o.append('<div class="optionCheckBox"><input type="checkbox" value="'+r.id+'"'+(t.indexOf(r.id)===-1?"":" checked")+"></input><span>"+r.name+"</span></div>")}}M(a.result.listingInfo)})}function y(e){var a={vehicles:"AD",parts:"PRT",accessories:"AG"};return a[e]||"AD"}function w(){var a=e.merge(e("#promoCode"),e("#promoCodeMobile")),t=e.merge(e("#checkPromoCodeMobile"),e("#checkPromoCode"));t.click(b),e("#promoCode").change(b),a.focus(function(){promoCodeIcons.addClass("fa-plus").removeClass("fa-exclamation fa-check fa-cog fa-spin")})}function b(){var a=e(".promoCodeIcon"),t=e(".promoCodeError");a.addClass("fa-cog fa-spin").removeClass("fa-exclamation fa-check fa-plus"),d({"package":{promoCode:e("#promoCode").val(),orderId:e("#orderId").val()}},e("#promoCode"),function(e){e.success?(a.addClass("fa-check").removeClass("fa-exclamation fa-cog fa-spin fa-plus"),t.slideUp()):(a.addClass("fa-exclamation").removeClass("fa-check fa-cog fa-spin fa-plus"),t.slideDown().html(e.result.data.error))})}function k(a){TOL.Module.Modal.loadModal({title:"Updating Package",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'}),d({"package":{"package":a,orderId:e("#orderId").val()}},e(this),function(){TOL.Module.Modal.close()})}function x(e,a,t,o){if(e.find("option:not(.default)").remove(),null===a)return e.prepend('<option selected value="">Loading&hellip;</option>'),void e.prop("disabled",!0);if(e.find("optgroup").length){var i=!1,s=e.find("optgroup:first"),r=e.find("optgroup:nth(1)");for(var l in a)i?r.append('<option value="'+a[l].id+'">'+a[l].name+"</option>"):null!==a.id?s.append('<option value="'+a[l].id+'">'+a[l].name+"</option>"):(i=!0,s.after("<option disabled>"+a[l].name+"</option>"))}else for(var l in a)e.append('<option value="'+a[l].id+'">'+a[l].name+"</option>");if(e.prop("disabled",!1),"undefined"!=typeof t){var n=e.find('option[value="'+t+'"]');n.length>0&&n.prop("selected",!0)}o||e.change()}function M(a){if(a){z=a;var t=14,o=!0,i=!1,s=e.merge(e("#totalPrice"),e("#totalPriceMobile"));if("create"===p()){s.text("$"+(a.activeOrder.priceTotal/100).toFixed(2));for(var r in a.activeOrder.packages)t=Math.max(t,a.activeOrder.packages[r].duration);if(t){e("#package-summary").show();var l=t/7+" weeks online";if(365===t)var l="52 weeks - Renew free every 13 weeks";e.merge(e("#duration"),e("#durationMobile")).text(l)}else e("#package-summary").hide();a.maxPhotoCount=a.activeOrder.maxPhotoCount,a.maxVideoCount=a.activeOrder.maxVideoCount}else{var n=(new Date).getTime()/1e3,d=a.offlineDate-n,c=Math.max(0,Math.ceil(d/86400));d&&e.merge(e("#duration"),e("#durationMobile")).text(c+" days left");var m=0;for(var r in a.orders)m=Math.max(m,parseInt(a.orders[r].price));if(s.text("$"+m.toFixed(2)),c<7&&m>0?e(".renewListing").show():e(".renewListing").hide(),a.maxPhotoCount=0,a.maxVideoCount=0,a.features)for(var r in a.features)a.maxPhotoCount+=a.features[r].photos,a.maxVideoCount+=a.features[r].videos}if(void 0!==a.maxPhotoCount&&e.merge(e("#photos"),e("#photosMobile")).html(a.maxPhotoCount+' photos - <span class="subtleText">'+a.photoCount+" Used"),void 0!==a.maxVideoCount){var h="";a.maxVideoCount>0&&(h=a.maxVideoCount+' video - <span class="subtleText">'+a.videoCount+" Used"),e.merge(e("#video"),e("#videoMobile")).html(h)}"best"===E(a).toLowerCase()?e.merge(e("#features"),e("#featuresMobile")).show():e.merge(e("#features"),e("#featuresMobile")).hide(),q=a.maxPhotoCount-a.photoCount;var f=a.maxVideoCount;q>=0?e("#photosLeft").html(q+" of "+a.maxPhotoCount+" photos left"):e("#photosLeft").html("Remove "+-q+" photo"+(q!==-1?"s":"")),e("#photoPackageDescription").html('Your "'+E(a)+'" package allows up to '+a.maxPhotoCount+" photos.");var g=e("#imageAddRemove");if(q<=0?(g.addClass("disabled"),"best"===E(a).toLowerCase()&&(o=!1)):(g.removeClass("disabled"),o=!1),a.price||(a.price="PRICE"),e("#preview-price").text("$"+a.price),"AD"!==a.adType)e("#preview-title").text(a.partTitle||"TITLE");else{var v="";a.year||(a.year="YEAR"),v+=a.year,(!a.makeDisplayName||"OTHER"===a.makeDisplayName.toUpperCase()&&"Other"!==e("#make option:selected").text())&&(a.makeDisplayName="MAKE"),v+=" "+a.makeDisplayName,(!a.modelDisplayName||"OTHER"===a.modelDisplayName.toUpperCase()&&"Other"!==e("#model option:selected").text())&&(a.modelDisplayName="MODEL"),v+=" "+a.modelDisplayName,a.trimName&&(v+=" "+a.trimName),e("#preview-title").text(v)}if(a.photos&&a.photos.length>0?e("#preview-image").attr("src",a.photos[0].url):e("#preview-image").attr("src","https://"+tolConfig.cdnDomain+"/image-coming-soon-512.png"),a.customer&&a.customer.showPhone?e("#seller-info").html("Private Seller&nbsp;-&nbsp;"+a.customer.phone):e("#seller-info").html('Private Seller&nbsp;-&nbsp;<i class="fa fa-envelope-o"></i> Email '),a.city||(a.city="CITY"),a.state||(a.state="STATE"),e("#preview-location").text(a.city+", "+a.state),null!==a.description&&e("#preview-description").html(a.description),a.adVideos&&a.adVideos.length>0){e("#videoInput").hide(),e("#videoPreview").show();var C=e("#videoPreview iframe"),y="https://www.youtube.com/embed/"+a.adVideos[0].youTubeVideoId;C.attr("src")!==y&&C.attr("src",y)}else e("#videoPreview").hide(),e("#videoInput").show();f<=0?(e("#videoInput").hide(),e("#videoHelp").hide(),i=!0):e("#videoHelp").show(),O(a),i?e("#upsellVideo").show():e("#upsellVideo").hide(),o?e("#upsellPhotos").show():e("#upsellPhotos").hide(),o&&i?e("#upsellOr").show():e("#upsellOr").hide(),o||i?e("#upsell").show():e("#upsell").hide(),0===a.maxVideoCount?e("#videoTitle").hide():e("#videoTitle").show(),a.activeOrder&&a.activeOrder.discount>0?(e(".discount").text("-$"+(a.activeOrder.discount/100).toFixed(2)),e(".discountInfo").show()):e(".discountInfo").hide(),e(".deleteBox").on("click touchstart",function(){u(e(this).parent())});var w=E(a);e("#packageName, #packageNameMobile").html(w+" package selected"),"free"===w.toLowerCase()||"basic"===w.toLowerCase()?(e("#sponsoredPackage").length>0?(e("#packageName").hide(),e("#sponsoredPackage").show()):e("#packageName").show(),"free"===w.toLowerCase()&&(e(".promoCode").hide(),e("#promoCodeButton").hide())):(e("#packageName").show(),e("#sponsoredPackage").hide(),e(".promoCode").show(),e("#promoCodeButton").show()),e("#trim option").length<2&&e("#trim").attr("disabled",!0),"AD"===a.adType?1===e("#category option").length?e("#category select").prop("disabled",!0):e("#category select").prop("disabled",!1):1===e("#pagCategories option").length?e("#pagCategories select").prop("disabled",!0):e("#pagCategories select").prop("disabled",!1);var b=e("#existingFitments ul");b.html("");for(var r in a.fitments){var v,k=a.fitments[r];"PRT"===a.adType?(v=(k.minYear||"Any")+" - "+(k.maxYear||"Any")+" ","Any - Any "===v&&(v=""),v+=(k.makeName||"")+" "+(k.modelName||"")):v=k.makeName,b.append("<li><span>Fits a "+v+'</span>&nbsp;<a class="btn btn-danger removeFitment rfloat" data-make-name="'+k.makeName+'" data-model-name="'+k.modelName+'" data-min-year="'+k.minYear+'" data-max-year="'+k.maxYear+'"><i class="fa fa-trash"></i></a><div class="clear"></div></li>')}e(".removeFitment").click(T),a.fitments&&a.fitments.length<5?e("#startFitment").show():e("#startFitment").hide()}}function T(){e(this).find("i").addClass("fa-gear fa-spin").removeClass("fa-trash");var a=z.fitments,t=-1,o=e(this).data();for(var i in a)if(a[i].makeName===o.makeName&&a[i].modelName===o.modelName&&a[i].minYear===o.minYear&&a[i].maxYear===o.maxYear){t=i;break}t!==-1&&(a.splice(t,1),0===a.length&&(a=[""]),d({fitments:a},e("#fitmentSection :input")))}function E(e){var a="basic";return e.activeOrder&&e.activeOrder.packages&&e.activeOrder.packages[0]?a=e.activeOrder.packages[0].name:e.orders&&e.orders[0]&&(a=e.orders[0].programName),!a||"basic"===a&&e.activeOrder&&0===e.activeOrder.priceTotal?"free":a}function O(e,a){var t=I(e,a),o=P(e,a),i=L(e,a);j=t&&o&&i}function I(a,t){var o=!0;a&&("Parts/Accessories"!=a.className&&"YEAR"===a.year?(o=!1,t&&e("#year").addClass("showError")):e("#year").removeClass("showError"),"MAKE"===a.makeDisplayName?(o=!1,t&&e("#make").addClass("showError")):e("#make").removeClass("showError"),"MODEL"===a.modelDisplayName?(o=!1,t&&e("#model").addClass("showError")):e("#model").removeClass("showError"),!a.trimId&&e("#trim option").length>2&&"0"!==e("#trim").val()?(o=!1,t&&e("#trim").addClass("showError")):e("#trim").removeClass("showError"),"PRICE"===a.price?(o=!1,t&&e("#price").addClass("showError")):e("#price").removeClass("showError"),!a.description||A()?(o=!1,t&&e("#descriptionWrapper").addClass("showError")):e("#descriptionWrapper").removeClass("showError"),e("#category option").length>1&&a.categories&&0===a.categories.length&&null===location.hostname.match("rvtrader")?(o=!1,t&&e("#category").addClass("showError")):e("#category").removeClass("showError"),e("#pagCategories option").length>1&&a.categories&&0===a.categories.length&&null===location.hostname.match("rvtrader")?(o=!1,t&&e("#pagCategories").addClass("showError")):e("#pagCategories").removeClass("showError"),e("#class").length&&!a.classId?(o=!1,t&&e("#class").addClass("showError")):e("#class").removeClass("showError"),e("#fuelType").length&&!a.fuelType?(o=!1,t&&e("#fuelType").addClass("showError")):e("#fuelType").removeClass("showError"));var i=e("#step1Errors").hide(),s=e("#step1Validation");if(e("#collapseStep1 .failedUpdate").addClass("showError"),N(s,i,e("#collapseStep1 .failedUpdate")))return!1;var r=t?"fa-exclamation-circle":"fa-square-o";return S(s,[],[],o,r,!0),o}function P(a){var t=[];q<0&&t.push('You must either <a class="offerUpgrade">upgrade your package</a> or remove '+-q+" photos"),a&&a.adVideos&&a.maxVideoCount<a.adVideos.length&&t.push('You must either <a class="offerUpgrade">choose a package</a> that includes video or remove this video');var o=e("#step2Validation");return S(o,e("#step2Errors"),t,0===t.length,"fa-exclamation-circle",!1),e(".offerUpgrade").click(l),0===t.length}function L(a,t){var o=!0,i=e("#step3Validation");if(a&&a.customer)a.customer.firstName?e("#firstName").removeClass("showError"):(o=!1,t&&e("#firstName").addClass("showError")),a.customer.lastName?e("#lastName").removeClass("showError"):(o=!1,t&&e("#lastName").addClass("showError")),a.customer.address1?e("#address").removeClass("showError"):(o=!1,t&&e("#address").addClass("showError")),a.customer.city?e("#city").removeClass("showError"):(o=!1,t&&e("#city").addClass("showError")),a.customer.stateCode?e("#state").removeClass("showError"):(o=!1,t&&e("#state").addClass("showError")),a.customer.zip?a.customer.zip.match(/^\d{5}$/)?e("#zip").removeClass("showError"):(o=!1,e("#zip").addClass("showError")):(o=!1,t&&e("#zip").addClass("showError")),a.customer.phone?e("#phone").removeClass("showError"):(o=!1,t&&e("#phone").addClass("showError"));else if(o=!1,a&&"0"===a.customerId)return e("#collapseStep3").hide(),e("#lateLogin").show(),S(i,[],[],!1,"fa-exclamation-circle",!1),!1;var s=e("#step3Errors").hide();return e("#collapseStep3 .failedUpdate").addClass("showError"),!N(i,s,e("#collapseStep3 .failedUpdate"))&&(S(i,[],[],o,"fa-square-o",!0),o)}function N(a,t,o){if(o.length>0){var i=[];return o.each(function(a,t){e(t).data("errorText")?i.push(e(t).data("errorText")):i.push("Failed to update")}),S(a,t,i,!1,"fa-exclamation-circle",!0),!0}return!1}function S(e,a,t,o,i,s){o?(e.removeClass("fa-cog fa-spin fa-exclamation-circle fa-square-o"),s&&e.addClass("fa-check-square-o"),a.length&&a.slideUp().animate("slow")):(e.removeClass("fa-cog fa-spin fa-exclamation-circle fa-square-o fa-check-square-o").addClass(i),a.length&&0!==t.length&&a.html(t.join("<BR>")).slideDown().animate("slow"))}function D(){function a(){e.ajax({url:"/myt/listings/isLive/"+c(),success:function(a){a.isLive&&(e("#processingAd").hide(),e("#finishedProcessing").show(),e("#shareButton").show(),e("#title").hide(),e("#titleLive").show(),clearInterval(s),clearInterval(r))}})}var t=e("#counter");if(t.is(":visible")){var o=(new Date).getTime(),i=o+36e5,s=setInterval(function(){var e=i-(new Date).getTime();if(e>0){var a=parseInt(e/6e4),o=parseInt(e/1e3%60);o<10&&(o="0"+o),t.text(a+":"+o)}},500),r=setInterval(a,1e4);a()}}function U(){e("#leadTable .myt-lead-item").click(function(a){var t=e(a.originalEvent.target);if(!t.hasClass("leadReply")){var o=e(this).data("leadId");location="/myt/listings/emailleads/replies/"+o}}),e(".reply-message").on("show.bs.collapse",function(){var a=this;e(".reply-message").each(function(t,o){this!==a&&e(this).collapse("hide")}),e(this).prev().find(".collapse-arrow i").addClass("fa-chevron-up").removeClass("fa-chevron-down")}),e(".reply-message").on("hide.bs.collapse",function(){e(this).prev().find(".collapse-arrow i").addClass("fa-chevron-down").removeClass("fa-chevron-up")})}function A(a){if(null!=tinyMCE.get("description")){var t=tinyMCE.get("description").getContent(),o=e("#description").attr("maxlength");if(t.length>o)return a&&alert("The description must be less than (or equal to) "+o+" characters."),!0}return!1}function F(){tinyMCE.PluginManager.add("charcount",function(a){function t(){o.getCount()>o.maxlength?(e(".mce-charcount").html("Characters: "+o.getCount()+' / <span style="color:red;font-weight:bold">'+o.maxlength+"</span>"),e("#descriptionWrapper").hasClass("showError")||e("#descriptionWrapper").addClass("showError")):(a.theme.panel.find("#charcount").text(["Characters: {0} / {1}",o.getCount(),o.maxlength]),e("#descriptionWrapper").removeClass("showError"))}var o=this;a.on("init",function(){var i=a.theme.panel&&a.theme.panel.find("#statusbar")[0],s=e("#description").attr("maxlength");o.maxlength=s,s&&i&&window.setTimeout(function(){i.insert({type:"label",name:"charcount",text:["Characters: {0} / {1}",o.getCount(),o.maxlength],classes:"charcount",disabled:a.settings.readonly},0),a.on("setcontent beforeaddundo",t),a.on("keyup",function(e){t()}),a.on("blur",function(a){tinyMCE.triggerSave(),d({description:e("#description").val()},e("#description"))})},0)}),o.getCount=function(){var e=a.getContent({format:"html"});return e.length}}),tinyMCE.PluginManager.add("placeholder",function(e){e.on("init",function(){function t(){!e.settings.readonly==!0&&s.hide(),e.execCommand("mceFocus",!1)}function o(){""==e.getContent()?s.show():s.hide()}function i(){s.hide()}var s=new a;o(),tinyMCE.DOM.bind(s.el,"click",t),e.on("focus",t),e.on("blur",o),e.on("change",o),e.on("setContent",o),e.on("keydown",i)});var a=function(){var a=e.getElement().getAttribute("placeholder")||e.settings.placeholder,t=e.settings.placeholder_attrs||{style:{position:"absolute",top:"5px",left:0,color:"#888",padding:"1%",width:"98%",overflow:"hidden","white-space":"pre-wrap"}},o=e.getContentAreaContainer();tinyMCE.DOM.setStyle(o,"position","relative"),this.el=tinyMCE.DOM.add(o,e.settings.placeholder_tag||"label",t,a)};a.prototype.hide=function(){tinyMCE.DOM.setStyle(this.el,"display","none")},a.prototype.show=function(){tinyMCE.DOM.setStyle(this.el,"display","")}}),tinyMCE.init({selector:"textarea#description",plugins:["lists, charcount, placeholder, paste"],formats:{bold:{inline:"b"},italic:{inline:"i"}},valid_elements:"b,i,br,ul,li",force_br_newlines:!0,force_p_newlines:!1,inline_styles:!1,forced_root_block:"",menubar:!1,toolbar:"undo redo | bold italic | bullist",entities:"38,amp,34,quot,162,cent,8364,euro,163,pound,165,yen,169,copy,174,reg,8482,trade",paste_preprocess:function(e,a){a.content=a.content.replace(/&lt;\/?strong&gt;/gi,"&lt;b&gt;"),a.content=a.content.replace(/&lt;\/?em&gt;/gi,"&lt;i&gt;"),a.content=a.content.replace(/\s*style=("|\')(.*?)("|\')/gi,""),a.content=a.content.replace(/&lt;(?!((?:\/\s*)?(?:b|i|br|ul|li)))([^&gt;])+&gt;/gi,""),a.content=a.content.replace(/&lt;\/?(t.*?)&gt;/gi,""),a.content=a.content.replace(/&lt;img.*?&gt;/gi,"")}})}function V(){return tinyMCE.get("description").isDirty()&&(tinyMCE.triggerSave(),d({description:e("#description").val()},e("#description"))),0!==H.length?void setTimeout(function(){V()},300):void TOL.Module.Modal.loadModal({title:"Changes saved",body:'<div class="center">Your changes should be reflected within the hour.<BR><a class="btn btn-primary" href="/myt/listings">OK</a></div>'})}function Y(){return tinyMCE.get("description").isDirty()&&(tinyMCE.triggerSave(),d({description:e("#description").val()},e("#description"))),0!==H.length?void setTimeout(function(){Y()},300):(O(z,!0),j?((e("#subscribeNewsletter").is(":visible:checked")||e("#subscribeNewsletterMobile").is(":visible:checked"))&&e.ajax({url:"/Gettiledata/newslettersubscription/addsubscription/",type:"POST",data:{emailAddress:e("#emailaddress").val(),weeklyOptin:"PAA"},success:function(a){a=e.parseJSON(a),a.success&&e(".subscriptionContainer").hide()}}),e.ajax({url:"/myt/listings/checkout",method:"POST",data:{adId:c()},success:function(e){e.success&&(null!==e.paymentUrl?TOL.Module.Modal.loadModal({title:"Checkout",body:'<iframe height="1150px" width ="100%" src="'+e.paymentUrl+'" />'}):i(e.orderId));
},error:function(){"create"===p()&&"M"!==z.status&&("P"===z.status?location="/myt/listings":location=location.href.replace("create","edit")),TOL.Module.Modal.loadModal({title:"Unable to process payment",body:"Please try again"})}}),void TOL.Module.Modal.loadModal({title:"One moment please...",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'})):void alert("You are missing required fields and/or you are not logged into an account."))}var _,R,j,z,G=e("#photoThumbs"),q=0,B=!1,W=!1,$=[],H=[];return{init:a,processPayment:i}}(jQuery);
TOL.Module.MytraderReplies=function(a){function l(){window.location.pathname.search(/\/myt\/listings\/emailleads/)!=-1&&a(".leadReply").click(function(){TOL.Module.Modal.loading(),a.ajax({url:"/myt/listings/emailreply/loadModal",data:a(this).data(),dataType:"json",success:function(l){TOL.Module.Modal.loadModal(l),a("#replyButton").click(e)}})})}function e(l){l.preventDefault();var e=a(this).data();e.message=a("#message").val(),a.ajax({url:"/myt/listings/emailreply/sendReply",data:e,dataType:"json",success:function(a){TOL.Module.Modal.close(),location.reload()}})}return{init:l}}(jQuery);
TOL.Module.MytSavedListings=function(e){var t=function(){window.location.pathname.search("/myt/saved-listings")!=-1&&(e(".deleteListing").click(function(){var t=e(this).data("savedListingId");e.ajax({url:"/myt/saved-listings/delete",data:{savedListingId:t},dataType:"json",type:"POST",success:function(a){return a.message&&alert(a.message),a.success?void e('li[data-saved-listing-id="'+t+'"]').remove():a.redirect?void(location=a.redirect):void(a.message||alert("Unable to delete listing.  Please try again later."))}})}),e(".updateSavedListingShouldEmail").change(function(){e.ajax({url:"/myt/saved-listings/update",data:{savedListingId:e(this).data("savedListingId"),shouldEmail:e(this).val()},dataType:"json",type:"POST",success:function(e){if(e.message&&alert(e.message),!e.success)return e.redirect?void(location=e.redirect):void(e.message||alert("Unable to update listing.  Please try again later."))}})}),e("#mytSearchPage img").on("error",function(){e(this).attr("src","https://"+tolConfig.cdnDomain+"/image-coming-soon-512.png")}))};return{init:t}}(jQuery);
TOL.Module.MytSearches=function(e){var t=function(){window.location.pathname.search("/myt/searches")!=-1&&(e(".deleteSearch").click(function(){var t=e(this).data("searchId");e.ajax({url:"/myt/searches/delete",data:{searchId:t},dataType:"json",type:"POST",success:function(a){return a.success?void e('li[data-search-id="'+t+'"]').slideUp(200,function(){e(this).remove()}):a.redirect?void(location=a.redirect):void alert("Unable to delete search.  Please try again later.")}})}),e(".emailSelect").change(function(t){lastEvent=t;var a=e(this).data("searchId");e.ajax({url:"/myt/searches/modify",data:{searchId:a,shouldEmail:"true"===e(lastEvent.originalEvent.target).find(":selected").val()},dataType:"json",type:"POST",success:function(e){if(!e.success)return e.redirect?void(location=e.redirect):void alert("Unable to update search.  Please try again later.")}})}),e(".searchTitleBox").click(function(t){var a=e(this).find(".searchTitle").data("searchId"),i=e('li[data-search-id="'+a+'"]');i.find(".searchTitleBox").hide(),i.find(".titleInputBox").show(),i.find(".titleInput").focus()}),e(".titleInput").blur(function(t){a(e(this).data("searchId"))}),e(".emailSelect").change(function(t){a(e(this).data("searchId"))}))},a=function(t){var a=e('li[data-search-id="'+t+'"]'),i=a.find(".titleInput").val(),d=a.find(".defaultTitle").text();a.find(".saving-indicator").removeClass("hide").fadeIn("slow"),""===i&&(i=d),e.ajax({url:"/myt/searches/modify",data:{searchId:t,title:i},dataType:"json",type:"POST",success:function(e){return setTimeout(function(){a.find(".saving-indicator").fadeOut("slow").addClass("hide")},1e3),e.success?(a.find(".searchTitle").text(i),a.find(".titleInputBox").hide(),a.find(".searchTitleBox").show(),void(i===d?(a.find(".criteria").hide(),a.find(".titleInput").val(d)):a.find(".criteria").show())):e.redirect?void(location=e.redirect):(setTimeout(function(){a.find(".saving-indicator").fadeOut("slow").addClass("hide")},1e3),void alert("Unable to update search.  Please try again later."))}})};return{init:t}}(jQuery);
TOL.Module.Mytrader=function(a){function e(e,i,d,l,r){d.packageName=TOL.getGet("package"),d.search_url=window.location.href,d.adId=Z,d.classId=_,F&&(d.email=F.email,d.uid=F.UID,d.signature=F.UIDSignature,d.timestamp=F.signatureTimestamp),a.ajax({type:i,url:"/"+e+"/"+l+"/",dataType:"json",data:d,cache:!1,success:function(i){if(TOL.Module.Modal.loadModal(i.modal),a(".sign-toggle").click(function(){a("#dividerText").removeClass("join-rule").addClass("social-rule")}),a(".join-toggle").click(function(){a("#dividerText").removeClass("social-rule").addClass("join-rule")}),TOL.Module.Gigya.showUi(p(e)),"function"==typeof r&&r(i),"savelisting"===e){var l=a('.saveListing[data-adid="'+d.adId+'"] i');l.removeClass("fa-cog fa-spin"),window.location.pathname.search("-for-sale")!=-1||window.location.pathname.search("/"+realmDealersTerm+"/detail")!=-1?s(i.modal,d):window.location.pathname.search("/myt/saved-listings")!=-1?s(i.modal,d):(s(i.modal,d),n(i.modal,d))}if("savesearch"===e){var l=a(".btnSaveSearch i");l.removeClass("fa-cog fa-spin"),o(i.modal)}if("myt/listings/create/newAd"===e){var c=i.modal.adId,f=TOL.getGet("package");if(c){var u="/myt/listings/create/"+c+"?";f&&(u+="&package="+f);var m=TOL.getGet("affilid");m&&(u+="&affilid="+m);var v=TOL.getGet("zmc");v&&(u+="&zmc="+v),i.modal.step&&(u+="&step="+i.modal.step),location=u}}t()}}),"unsave"!=l&&TOL.Module.Modal.loadModal({title:"One moment please...",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'})}function t(){TOL.cookie.get("mytLoggedIn")?(a("#hamburgerButton").addClass("logged-in"),a(".navHeartIcon i").addClass("logged-in fa-heart").removeClass("fa-heart-o"),a(".navHeartIcon .smallest").text("Saved").addClass("logged-in"),a("li.logged-in").show(),a("li.not-logged-in").hide(),i()):(a("#hamburgerButton").removeClass("logged-in"),a(".navHeartIcon i").removeClass("logged-in fa-heart").addClass("fa-heart-o"),a(".navHeartIcon .smallest").text("Log In").removeClass("logged-in"),a("li.logged-in").hide(),a("li.not-logged-in").show())}function i(){a.ajax({url:"/mytraderCounts",cache:!1,success:function(e){var t;t=e.listings>1?"s":"",a(".savedListingsCount").text(e.savedListings),a(".searchesCount").text(e.searches),a(".totalSavedCount").text(e.savedListings+e.searches),a("#listingCount").text(e.listings),a("#plural").text(t)}})}function s(t,i){t.savedListingAdId,t.savedListingId&&($[t.savedListingId]=t.savedListingAdId,f(t.savedListingAdId,t.savedListingId)),t.unsavedListing&&(delete $[i.savedListingId],u(t.unsavedListing)),a("#modalSaveListingButton").click(function(){e("savelisting","POST",{shouldEmail:"true"===a("#mytraderModal .emailSelect").val()},"save")})}function n(a,e){a.savedListingId&&m(e.adId,a.savedListingId),a.unsavedListing&&v(e.adId)}function o(t){void 0!==t.savedSearch&&M(t.savedSearch),a("#modalSaveSearchButton").click(function(){e("savesearch","POST",{title:a("#mytraderModal .titleInput").val(),shouldEmail:"true"===a("#mytraderModal .emailSelect").val()},"save")})}function d(){a("#searchPage, #mytSearchPage, #listingsFeatured, .toolbarContainer, #featured-demo, #modalWindowsContainer").unbind("click",l).on("click",".saveListing",l)}function l(){var t=a(this);t.find("i:first").addClass("fa-cog fa-spin"),Z=t.data("adid"),_=t.data("classid");var i=function(){t.find("i:first").removeClass("fa-cog fa-spin")};if(a(this).find("i").hasClass("saved"))e("savelisting","POST",{savedListingId:t.data("savedListingId")},"unsave",i);else{var s={};"true"===a("#mytraderModal .emailSelect").val()&&(s.shouldEmail=!0),e("savelisting","POST",s,"save",i)}}function r(){var e=a(this);Z=e.data("adid"),TOL.Module.Modal.loadModal({title:"Loading...",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'}),a.ajax({url:"/listing/report-fraud/"+Z,success:function(a){TOL.Module.Modal.loadModal({title:"Report This Ad",body:a});var e=TOL.Module.Modal.getModalElement();grecaptcha.render(e.find(".g-recaptcha")[0],{sitekey:W}),e.find("#submitEmail").click(function(){TOL.Module.Listing.submitEmail.apply(this,[e])})}})}function c(){var e=a("#saveListing");Z=e.data("adid"),a.ajax({url:"/myt/saved-listings/myListings",success:function(e){a.each(e,function(a,e){e==Z&&m(Z,a)})}})}function f(e,t){var i=a('.saveListing[data-adid="'+e+'"]');i.data("savedListingId",t),i.attr("data-original-title")?i.attr("data-original-title","Unsave This Listing"):i.attr("title","Unsave This Listing"),i.find(".saveListingText").text("Saved");var s=i.find("i");s.addClass("fa-heart fa-yellow saved"),s.removeClass("fa-heart-o fa-cog fa-spin"),s.hasClass("whiteWhenOff")&&s.removeClass("fa-white")}function u(e){var t=a('.saveListing[data-adid="'+e+'"]');t.each(function(e,t){var i=a(t),s=i.find("i");i.attr("data-original-title")?i.attr("data-original-title","Save This Listing"):i.attr("title","Save This Listing"),i.find(".saveListingText").text("Save Listing"),s.removeClass("fa-heart fa-yellow saved fa-cog fa-spin"),s.addClass("fa-heart-o"),s.hasClass("whiteWhenOff")&&s.addClass("fa-white")})}function m(e,t){var i=a("#saveListing");i.each(function(i,s){var n=a(s),o=a(".saveThisListing"),d=a("#bottomSaveButton");if(n.data("adid")==e){n.find("span").text("Saved"),d.find(".saving-text").text("Saved"),d.addClass("btn-primary").removeClass("btn-default"),o.find(".saving-text").text("Listing Saved");var l=a.merge(a.merge(n.find("i"),o.find(".save-listing")),d.find("i"));l.addClass("saved saved-color fa-heart").removeClass("fa-cog fa-spin fa-heart-o"),a.merge(a.merge(n,o),d).data("savedListingId",t)}})}function v(e){var t=a("#saveListing");t.each(function(t,i){var s=a(i),n=a(".saveThisListing"),o=a("#bottomSaveButton");if(s.data("adid")==e){s.find("span").text("Save"),o.find(".saving-text").text("Save"),o.addClass("btn-default").removeClass("btn-primary"),n.find(".saving-text").text("Save This Listing");var d=a.merge(a.merge(s.find("i"),n.find(".save-listing")),o.find("i"));d.addClass("fa-heart-o").removeClass("fa-cog fa-heart saved saved-color fa-spin")}})}function g(){a("#searchPage").on("click",".btnSaveSearch",function(){var t=a(this);t.find("i").addClass("fa-cog fa-spin"),t.data("searchId")?e("savesearch","POST",{searchId:t.data("searchId")},"unsave"):e("savesearch","POST",{},"save")})}function h(){a("#signUpButton").click(function(){TOL.Module.Mytrader.send("myt","GET",{},"join")})}function p(a){return function(t){F=t,F.isSiteUID?e(a,"POST",{},"save"):e(a,"GET",{},"join",y(a))}}function y(e){TOL.Module.Gigya.showUi(p(e));var t={firstName:"firstName",lastName:"lastName",email1:"email",username:"email"};for(inputId in t)a("#mytraderModal").find("#"+inputId).val(F[t[inputId]])}function L(){return"1"===TOL.cookie.get("mytLoggedIn")}function w(e){a.ajax({url:"/myt/searches/searchStatus",cache:!1,data:{search_url:e},success:function(a){M(a.id)}}),C()}function C(){a.ajax({url:"/myt/saved-listings/myListings",cache:!1,success:x})}function M(e){var t=a(".btnSaveSearch");t.data("searchId",e).find("#searchAction").text(e?"Saved":"Save"),e?(t.find("i").addClass("fa-heart").removeClass("fa-heart-o fa-cog fa-spin"),t.addClass("saved-color"),t.find("#saving-text").text("Saved")):(t.find("i").removeClass("fa-heart fa-cog fa-spin").addClass("fa-heart-o"),t.removeClass("saved-color"),t.find("#saving-text").text("Save"))}function x(a){$=a,T()}function T(){for(var a in $)f($[a],a)}function I(e){if(F=e,!e.isSiteUID){var t=a("<form>").attr("method","POST").attr("action","/myt/login"),i=a("<input>").attr("type","hidden").attr("name","socialData").attr("value",JSON.stringify(F));return t.append(i),a("body").append(t),void t.submit()}var s={email:F.email,uid:F.UID,signature:F.UIDSignature,timestamp:F.signatureTimestamp};a.ajax({type:"POST",url:"/myt/login",data:s,dataType:"json",success:function(a){a.redirect&&(location=a.redirect)}})}function S(e){if(F=e,e.isSiteUID)return void I(F);var t=O();a("#firstName").val(F.firstName),a("#lastName").val(F.lastName),a("#email1").val(F.email),a("#password").val(t),a("#password2").val(t),a("#uid").val(F.UID),a("#signature").val(F.UIDSignature),a("#timestamp").val(F.signatureTimestamp),a("#joinForm").submit()}function O(){for(var a=16,e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="",i=0,s=e.length;i<a;++i)t+=e.charAt(Math.floor(Math.random()*s));return t}function b(){a("#btnJoin").bind("click",function(e){e.preventDefault(),a("#divSsErr").hide();var t="",i={firstName:"Please enter your first name.",lastName:"Please enter your last name.",password:"Please choose a password.",password2:"Please verify by re-entering your chosen password.",zip:"Please enter your zip code."};for(var s in i)""==a("#"+s).val()&&(t+=i[s]+"<BR>");var n=a("#email1"),o=a.trim(n.val());n.val(o),o.match(/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/)||(t+="Please enter a valid email address.<BR>");var d=a("#password").val();(d.length<6||!d.match(/\d/)||!d.match(/[a-zA-Z]/))&&(t+="Password must be a minimum of 6 characters and a combination of letters and numbers.<BR>"),d!==a("#password2").val()&&(t+="Both passwords must match<BR>"),""==t?a("#joinForm").submit():(a("#divSsErr").show().html(t),window.scroll(0,0))})}function k(){a("#submitAccountInfo").bind("click",function(){a("#divSsErr").hide();var e="",t={firstName:"Please enter your first name.",lastName:"Please enter your last name.",address1:"Please enter your address.",city:"Please enter your city.",state:"Please choose a state.",zip:"Please enter your zip code.",countryId:"Please enter your country."};for(var i in t)""==a("#"+i).val()&&(e+=t[i]+"<BR>");var s=a("#zip").val();s.match(/^\d{5}$/)||(e+="Zip code must be a 5 digit US zip code.<BR>"),""==e?a("#mytAccountForm").submit():(a("#divSsErr").show().html(e),window.scroll(0,0))})}function P(){a("div[data-search-id]").click(function(e){a(e.target).is(":not(option)")&&a(e.target).is(":not(select)")&&a(e.target).is(":not(a)")&&(location=a(this).find(".runSearch").attr("href"))})}function j(){a(".deleteListing").click(function(){var e=a(this).data("savedListingId"),t=a(this).find("i");t.removeClass("fa-trash").addClass("fa-cog fa-spin"),confirm("Are you sure you want to permanently delete this ad?")?a.ajax({url:"/myt/deleteListing",data:{adId:e},success:function(t){a('li.myt-listing[data-listing-id="'+e+'"]').remove(),0===a(".pendingListing").length&&a("#addResumeButton").html(a("#addResumeButton").html().replace("Resume","Add")).attr("href","/sell")}}):t.addClass("fa-trash").removeClass("fa-cog fa-spin")})}function U(e){H=this,TOL.Module.Modal.loadModal({title:"One moment please...",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'});var e=a(this).data("adId")||e;a(this).find("i").removeClass("fa-cart-plus").addClass("fa-cog fa-spin"),a.ajax({url:"/myt/listings/upgrade/"+e,success:B,context:this})}function B(e){a(this).find("i").length&&a(this).find("i").addClass("fa-cart-plus").removeClass("fa-cog fa-spin"),e.success&&(e.paymentUrl?TOL.Module.Modal.loadModal({title:"Checkout",body:'<iframe height="1150px" width ="100%" src="'+e.paymentUrl+'" />'}):e.modal&&(TOL.Module.Modal.loadModal(e.modal),a("#enhancedUpgrade").click(function(){D("enhanced",e.adId)}),a("#bestUpgrade").click(function(){D("best",e.adId)})))}function D(e,t){TOL.Module.Modal.loadModal({title:"One moment please...",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'}),a.ajax({url:"/myt/listings/upgrade/"+t,data:{"package":e},success:B})}function A(){a(".renewListing").click(function(){TOL.Module.Modal.loadModal({title:"One moment please...",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'}),H=this;var e=a(this).data("adId"),t=a(this).find("i");t.removeClass("fa-calendar-plus-o").addClass("fa-cog fa-spin"),a.ajax({url:"/myt/listings/renew/"+e,success:function(a){t.addClass("fa-calendar-plus-o").removeClass("fa-cog fa-spin"),a.success&&(a.paymentUrl?TOL.Module.Modal.loadModal({title:"Checkout",body:'<iframe height="1150px" width ="100%" src="'+a.paymentUrl+'" />'}):a.orderId&&TOL.Module.MytraderListingEdit.processPayment(a.orderId))}})})}function z(){a.ajaxSetup({cache:!1}),a(".addVideos").click(function(){TOL.Module.Modal.loadModal({title:"One moment please...",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'}),N(a(this).data("listingId"))})}function E(){a("#sliderCheckBox").click(function(){a(this).is(":checked")?(a("#infoIcon").show(),a("#slickBox").show()):(a("#infoIcon").hide(),a("#slickBox").hide())})}function N(e){a.ajax({url:"/myt/addVideo",data:{adId:e},success:function(t){TOL.Module.Modal.loadModal({body:t,title:"Manage your video"});var i=TOL.Module.Modal.getModalElement().find("iframe");i.length?(a('.myt-listing[data-listing-id="'+e+'"] span#videoCount').text("1"),a('.myt-listing[data-listing-id="'+e+'"] span#videosLeft').text("0")):(a('.myt-listing[data-listing-id="'+e+'"] span#videoCount').text("0"),a('.myt-listing[data-listing-id="'+e+'"] span#videosLeft').text("1")),R()}})}function R(){a("#removeVideoButton").click(function(){var e=a(this).data("adId");a.ajax({url:"/myt/removeVideo",data:{adId:e},complete:function(){N(e)}}),TOL.Module.Modal.loadModal({title:"One moment please...",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'})}),a("#linkVideoButton").click(function(){var e=a(this).data("adId");a.ajax({url:"/myt/linkVideo",data:{adId:e,videoUrl:a("#videoUrl").val()},complete:function(){N(e)}}),TOL.Module.Modal.loadModal({title:"One moment please...",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'})});var e=a("#uploadVideo"),t=e.data("adId");e.ocupload({name:"videofile",action:"/myt/uploadVideo",enctype:"multipart/form-data",params:{adId:t},accept:"video/*",autoSubmit:!0,onSubmit:function(){var a=e.parents(".modalContent");a.children().hide(),a.append('<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>')},onComplete:function(){TOL.Module.Modal.loadModal({title:"One moment please...",body:'<div class="center"><i class="fa fa-cog fa-spin fa-3x"></i></div>'}),N(t)}})}function G(){if(a("#forgotPasswordLink").click(function(e){location="/myt/forgotpassword?email="+a('input[name="username"]').val(),e.preventDefault()}),realmDealersTerm=tolConfig.getRealmDealersTerm(),window.location.pathname.search("-for-sale")==-1&&window.location.pathname.search("/"+realmDealersTerm+"/detail")==-1||(g(),d(),L()&&w(window.location.href),C()),window.location.pathname.search("/myt/login")!=-1&&(TOL.Module.Gigya.showUi(I),h()),window.location.pathname.search("/myt/saved-listings")!=-1&&(d(),w(window.location.href)),window.location.pathname.search("/myt/searches")!=-1&&P(),window.location.pathname.search("/myt/join")!=-1&&(TOL.Module.Gigya.showUi(S),b()),window.location.pathname.search("/myt/account")!=-1&&k(),window.location.pathname.search("/myt/listings")!=-1&&(z(),j(),a(".upgradeListing").click(U),A()),window.location.pathname.search("/myt/listings/edit")!=-1&&E(),window.location.pathname.search("/listing/")!=-1&&(a("#saveListing").click(l),a(".saveThisListing").click(l),a("#bottomSaveButton").click(l),a(".reportThisListing").click(r),d(),C(),L()&&c()),"/"==window.location.pathname&&(d(),C(),L()&&c()),window.location.pathname.search("/myt$")!=-1&&a.ajax({url:"/mytraderCounts",cache:!1,success:function(e){a(".savedListingsCount").text(e.savedListings),a("#listingsCount").text(e.listings),a(".searchesCount").text(e.searches)}}),window.location.pathname.search("/myt/forgotpassword$")!=-1){var e=a("#email_addr");a("#forgotpassword").submit(function(t){var i=a.trim(e.val());e.val(i);var s=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;s.test(i)||(a("#email_addr_error").text("Please enter a valid email address").show(),t.preventDefault())})}t()}function V(){H.click()}var Z,_,F,H,$={},W=a("#recaptchaKey").val();return a(function(){a(".sign-in-tooltip").delay(1e4).fadeOut(),a(".paa-package").click(function(){a(this).toggleClass("selected")}),a(".paa-upgrades ul li").click(function(){a(this).toggleClass("selected")})}),setTimeout(function(){a('[data-toggle="tooltip"]').tooltip()},1e3),{send:e,getMytraderData:w,retryLastTransaction:V,doUpgrade:U,init:G}}(jQuery);
TOL.Module.Netacuity=function(){return{init:function(){var a=tolConfig.getRealmSearchTerm(),e="find-"+a,t=tolConfig.getRealmDealersTerm();window.location.pathname.search("/"+a)==-1&&window.location.pathname.search("/"+t+"/results")==-1&&window.location.pathname.search("/"+t+"/detail")==-1&&window.location.pathname.search("/listing")==-1&&window.location.pathname.search("/"+e)==-1&&window.location.pathname.search("/")==-1||"desktop"==device_detection&&void 0===TOL.cookie.get("userLocation")&&$.ajax({url:"/gettiledata/netacuity/locationdetails"})}}}(jQuery);
TOL.Module.Partners=function(r){var t=function(){r("#submitPartnerForm").click(e),r("#resetPrimaryColor").click(function(){resetPrimaryColor()}),r("#resetBackgroundColor").click(function(){resetBackgroundColor()}),r("select").on("change",function(){this.selectedOptions.length<=5?(r(this).find(":selected").addClass("selected"),r(this).find(":not(:selected)").removeClass("selected")):r(this).find(":selected:not(.selected)").prop("selected",!1)})},e=function(){var t=!0,e="",a={};r("#partners").find(":input").each(function(){!r(this).attr("required")||""!=r(this).val().trim()&&r(this).val().trim()!=r(this).attr("defaultValue")?r(this).attr("validation")&&r(this).val().trim().search("^"+r(this).attr("validation")+"$")==-1&&(r(this).attr("required")||""==!r(this).val().trim())?(t=!1,e+=r(this).attr("defaultValue")+" is invalid.\n"):r(this).is(":checkbox")?a[r(this).attr("name")]=r(this).is(":checked"):r(this).is(":radio")?a[r(this).attr("name")]=r("input[name="+r(this).attr("name")+"]:checked").val():a[r(this).attr("name")]=jQuery.trim(r(this).val()):(t=!1,"undefined"!=typeof r(this).attr("defaultValue")?e+=r(this).attr("defaultValue")+" is required.\n":(errorText=r(this).attr("placeholder"),e+=errorText.replace("(Required)","")+" is required.\n"))}),""!=e?alert(e):(r(this).hide(),r(this).parent().append("<center><i id='ajaxload' class='fa fa-cog fa-spin fa-2x'></i></center>"),r.ajax({url:"/Gettiledata/partners/createpartner/",type:"POST",data:a,context:r(this).parent(),success:function(r){partnersCallback.apply(this,[r])}}))};return partnersCallback=function(t){try{t=r.parseJSON(t)}catch(e){t={Errors:["Unknown Error"]}}r(this).find("#ajaxload").remove(),0==t.Errors.length?r("#errorOther").html(t.Status).show():(r("#partners").find("#submitPartnerForm").show(),alert(t.Errors),r(this).find("#submitPartnerForm").show())},resetPrimaryColor=function(){var t=r("#primarycolor").data("realmcolor");r("#primarycolor").val(t),r("#primarycolor").css("background-color","#"+t)},resetBackgroundColor=function(){var t=r("#backgroundcolor").data("backgroundcolor");r("#backgroundcolor").val(t),r("#backgroundcolor").css("background-color","#"+t)},{init:t}}(jQuery);
TOL.Module.Refinesearch=function(e){if(!e(".price-checker").length){var a,t={},i={},r={},n={topMakes:"Top Makes",selectedCategories:{field:"category",title:"Selected Categories",mainTitle:"Select All Categories"},selectedMakes:{field:"make",title:"Selected Makes",mainTitle:"Select All Makes"},selectedModels:{field:"model",title:"Selected Models",mainTitle:"Select All Models"},selectedTrims:{field:"trim",title:"Selected Trims",mainTitle:"Select All Trims"},make:"All Makes",model:"All Models",trim:"All Trims",category:"All Categories"},o={make:"selectedMakes",model:"selectedModels",trim:"selectedTrims",category:"selectedCategories"},l=(tolConfig.nicheSites,!1),s=!1,c=null,d=null,f=null,p=null,m=null,u="Near Me",h=tolConfig.schemeCodes,v=tolConfig.getRangeParams(),g=tolConfig.paramTranslation,k=tolConfig.getRealmSearchTerm(),w="find-"+k,y=tolConfig.getRealmDealersTerm(),O=function(){window.location.pathname.search("/"+k)==-1&&window.location.pathname.search("/"+y+"/detail")==-1&&window.location.pathname.search("/dealergroups/detail")==-1&&window.location.pathname.search("/myt/saved-listings")==-1&&window.location.pathname.search("/"+w)==-1&&window.location.pathname.search("/price-checker")==-1||window.location.search.search("vrsn=links")>=0||("mobile"==device_detection||"tablet"==device_detection?(e("#refinePage").html(e("#refine-main").html()),e(".refine-column.hidden-sm").remove(),e("i.fa-chevron-down").removeClass("fa-chevron-down").addClass("hidden"),e("i.fa-chevron-right").removeClass("fa-chevron-right").addClass("hidden")):s=!0,s||window.location.pathname.search("/"+w)==-1&&window.location.pathname.search("/price-checker")==-1||(e("#refine-main").remove(),e("#refinePage").show(),e(".keyword").keyup(TOL.Module.Keywordsearch.loadKeyword)),G(),"desktop"==device_detection&&window.location.pathname.search("/"+w)==-1&&window.location.pathname.search("/price-checker")==-1&&(TOL.Module.Refinesearch.setRefining(!0),TOL.Module.Refinesearch.setColumn(!0),TOL.Module.Refinesearch.filterRefineCounts()),window.location.pathname.search("/"+w)==-1&&window.location.pathname.search("/price-checker")==-1||(TOL.Module.Refinesearch.setRefining(!0),TOL.Module.Refinesearch.loadRefineData()))},T=function(){var a=e("#filterCounts").text();if(a){var t=e.parseJSON(a).counts;r=t}S(t),window.location.pathname.search("/price-checker")!=-1?TOL.Module.Refinesearch.loadRefineData():TOL.Module.Refinesearch.initialize(t)},S=function(a){var t=["make","model","trim","category"],i=TOL.Module.Listings.getSearchParams();for(var r in t){var n=t[r],o=i[n];if(e.isNumeric(o))for(var l in a[n])a[n][l].id!=o||(TOL.Module.Listings.setSearchParam("allowed_"+n,a[n][l].name+"|"+a[n][l].id),TOL.Module.Listings.setSearchParam(n,a[n][l].name+"|"+a[n][l].id))}},P=function(e){r=e,TOL.Module.Refinesearch.initialize(e)},M=function(r){var n="right",o="body";if(s||(n=null,o="#refinePage"),window.location.pathname.search("/"+w)==-1&&window.location.pathname.search("/price-checker")==-1||(n="auto top"),e(".desktopPop").popover({html:!0,container:o,placement:n,trigger:"manual",content:function(){var a=e(e(this).data("target")),t=a.attr("data-param");return'<div data-param="'+t+'">'+a.html()+"</div>"}}),s?e(".desktopCollapse").click(function(a){e(e(this).data("target")).collapse("toggle")}):e(".desktopCollapse").popover({html:!0,container:o,placement:n,trigger:"manual",content:function(){var a=e(e(this).data("target")),t=a.attr("data-param");return'<div data-param="'+t+'">'+a.html()+"</div>"}}),r){if(r.updatedParams)for(var l in r.updatedParams)setSearchParam(l,r.updatedParams[l]);e(".searchCount").html(r.total)}a=TOL.Module.Listings.getSearchParams(),TOL.Module.ModalWindow.hide("loadingModal"),s||window.scrollTo(0,0),t={},i={selectedMakes:[],topMakes:[],selectedCategories:[],selectedModels:[],selectedTrims:[]};for(var c in r)C(r,c);m||(m=TOL.Module.Listings.cloneSearchObject()),R(),s||(e("#refinePage").show(),e(".mobHdr").fadeOut(),e("#pageContainer").fadeOut())},L=function(){e.ajax({url:"/Gettiledata/refine_search/loadbyajax"+TOL.Module.Listings.getSearchQuery(),dataType:"json",success:P})},C=function(e,a){t[a]={},i[a]=[];for(j in e[a])filterData=e[a][j],"condition"==a?(filterData.parameters={condition:filterData.name},filterData.name="N"==filterData.name?"New":"Used",t[a][filterData.name]=filterData,i[a].push(filterData.name)):filterData.id?(t[a][filterData.id]=filterData,i[a].push(filterData.id)):filterData.name&&(t[a][filterData.name]=filterData,i[a].push(filterData.name))},b=function(a,i){var r=e(i),n=r.data("refine");if("radius"==n)return void K();if("keyword"==n)return void V();var o=!isEditable(n),l=!1,s=N(n);U(n,s),""==s&&(x(n),D(t[n])<1&&!v[n]&&(l=!0,window.location.pathname.search("/"+y+"/detail")!=-1&&["topMakes","make","model","trim","category","class","condition","price","year","mileage","fuelType","length"].indexOf(n)!=-1||(o=!0))),location.href.search("schemecode=")==-1||location.href.search("schemecode=AD")!=-1||"year"!=n&&"mileage"!=n||(o=!1,l=!0),3===tolConfig.getRealmId()&&"category"===n&&N("type").indexOf("Toy Hauler")==-1&&N("type").indexOf("Fifth Wheel")==-1&&(l=!0),o?r.addClass("disabled"):l?r.hide():(r.show(),r.removeClass("disabled"),["category","make","model","trim"].indexOf(n)!=-1?E(n):J(n))},R=function(){e("[data-refine]").each(b)},x=function(a){t[a]&&e.each(t[a],function(e,i){0==i.count&&delete t[a][e]})},D=function(a){var t=0;return void 0!=a&&e.each(a,function(){t++}),t},N=function(e){var i="";if(v[e])i=A(e);else if(a[e])if("condition"==e)i="N"==a[e]?"New":"Used";else if("seller_type"==e)i=a[e].search("OD")!=-1?"Dealer":"Private Party";else if("type"==e&&a[e].indexOf("|")==-1){var r=a[e];i=t[e][r]&&t[e][r].name?t[e][r].name:r}else if("type"==e&&5==tolConfig.getRealmId()){var n=a[e].split(",");n.length>1||(i=le(a[e]))}else if(["topMakes","make","model","trim","category"].indexOf(e)!=-1){var n=a[e].split(",");currentParts=[];for(var o in n)currentParts.push(le(n[o]));i=currentParts.join(", ")}else i=le(a[e]);return i},A=function(e){if(a[e]){var t=a[e];if(t.search(":")!=-1){var i=t.split(":"),r="*"==i[0]?"":i[0],n="*"==i[1]?"":i[1];return"price"==e&&(r&&(r="$"+r),n&&(n="$"+n)),r?n?r+" to "+n:r+" and Over":n>0?n+" And Under":n}return t}return""},G=function(){e("#refinePanel").on("shown.bs.collapse",function(a){if("refinePanel"!=a.target.id){var t="#"+a.target.id.replace("Detail","Option");e(t).find("i").removeClass("fa-chevron-down"),e(t).find("i").addClass("fa-chevron-up");var i=0,r=0;null!=c&&c!=a.target.id&&(s||(i=e("#"+c).offset().top,r=e("#"+c).height()),e("#"+c).collapse("hide")),c=a.target.id,null!=d&&(e("#"+d).popover("hide"),d=null),i>e(t).offset().top&&(r=0);var n=e(t).offset().top-e("#refineHdr").offset().top-r;window.location.pathname.search("/"+w)==-1&&window.location.pathname.search("/price-checker")==-1||"desktop"==device_detection?s||e("#refinePage").scrollTop(n):window.scrollTo(0,n)}}),e("#refinePanel").on("hidden.bs.collapse",function(a){if("refinePanel"!=a.target.id){var t="#"+a.target.id.replace("Detail","Option");e(t).find("i").removeClass("fa-chevron-up"),e(t).find("i").addClass("fa-chevron-down"),c==a.target.id&&(c=null),null!=d&&(e("#"+d).popover("hide"),d=null),null!=f&&(d=f,f=null,e("#"+d).popover("show"))}});var a=".desktopPop";s||(a=".desktopPop, .desktopCollapse"),e(a).click(function(){var a=e(this).attr("id"),t=e(this).parent().hasClass("disabled");t||(null==d&&null==c?(e(this).popover("show"),d=a,e("#modelText, #keyword").keyup(TOL.Module.Keywordsearch.loadKeyword)):d==a?(e(this).popover("hide"),d=null):(f=a,null!=d&&e("#"+d).popover("hide"),null!=c&&e("#"+c).collapse("hide")))}),e(a).on("hidden.bs.popover",function(){"desktop"==device_detection&&e("#tolMask").fadeOut("fast"),e(this).removeClass("filterSelection-selected"),d=null,null!=f&&(d=f,f=null,e("#"+d).popover("show"))}),e(a).on("shown.bs.popover",function(){"desktop"==device_detection&&e("#tolMask").fadeIn("fast"),e(this).addClass("filterSelection-selected"),z()}),e(".runRefineSearch").click(I),e(".resetRefineSearch").click(H),e(".cancelRefineSearch").click(_),e(".resetFilter").click(re),e(".updateLocation").click(Z),e(".useMyLocation").click(F),e(".updateKeyword").click(q),e("#refine-main").on("click",".refineOption",re),e("body").on("keypress",".keyword",function(a){13==a.which&&e(a.target).parent().parent().find(".updateKeyword").click()})},z=function(){e(".popover-content .updateLocation").click(Z),e(".popover-content .useMyLocation").click(F),e(".popover-content .updateKeyword").click(q),e(".popover-content .updateRange").click(te),e(".popover-content .addToSearchDetails").click(B),e(".popover-content .selectOption").click(re),e(".popover-content .refineOption").click(re),e(".popover-content .closePopup").click(function(){null!=d&&(e("#"+d).popover("hide"),d=null)}),e("#tolMask").click(function(){null!=d&&(e("#"+d).popover("hide"),d=null)})},F=function(){null!=TOL.getGet("lat")&&(setSearchParam("lat",TOL.getGet("lat")),setSearchParam("long",TOL.getGet("long")),setSearchParam("zip",null)),e(".updateZip").attr("value",u)},H=function(){var a=TOL.Module.Listings.getSearchParams().sort;TOL.Module.Listings.clearSearchObject(),e("#modelname",".keyword").attr("value",""),a&&setSearchParam("sort",a);var t=TOL.getGet("lat");null!=t&&setSearchParam("lat",t);var i=TOL.getGet("long");null!=i&&setSearchParam("long",i);var r=TOL.getGet("dealerid");null!=r&&setSearchParam("dealerid",r);var n=TOL.getGet("vrsn");null!=n&&setSearchParam("vrsn",n);var o=TOL.getGet("affilid");if(null!=o){setSearchParam("affilid",o);var l=TOL.getGet("primarycolor");null!=l&&setSearchParam("primarycolor",l);var s=TOL.getGet("backgroundcolor");null!=s&&setSearchParam("backgroundcolor",s);for(var c=["make","model","price","condition","zip","radius"],d=c.length,f=0;f<d;f++){var p="allowed_"+c[f],m=TOL.getGet(p);null!=m&&(setSearchParam(c[f],TOL.getGet(c[f])),setSearchParam(p,m))}}refreshOptions()},I=function(){W(),setSearchParam("page",1),window.location.pathname.search("/"+w)!=-1?window.location.href="/"+k+location.search:window.location.pathname.search("/price-checker")!=-1&&(window.location.href="/price-checker"+location.search+"&pricecheck=true"),setSearchParam("adFeatureId",null),s||(e("#refinePage").fadeIn(),e("#refinePage").fadeOut(),e(".mobHdr").fadeIn(),e("#pageContainer").fadeIn()),TOL.Module.Listings.saveSearch()},_=function(){null!==m&&TOL.Module.Listings.resetSearchObject(m),W(),s||(e("#refinePage").fadeOut(),e(".mobHdr").fadeIn(),e("#pageContainer").fadeIn())},W=function(){s||(l=!1,m=null)},E=function(e){if(void 0!=e){var a,t={},i={category:["category"],make:["make","model","trim"],model:["model","trim"],trim:["trim"]}[e],n=TOL.Module.Listings.getSearchParams();for(var o in i)a=i[o],n[a]&&(t[a]=n[a]),setSearchParam(a,null);"make"==e&&C(r,"topMakes"),C(r,e);for(var o in t)setSearchParam(o,t[o]);Q(e,r[e]),J(e)}},K=function(){if(location.href.search("dealer")!=-1&&location.href.search("dealergroups")==-1||!isEditable("zip")||!isEditable("radius"))return void e("#locationOption").hide();e("#locationOption").show();var t=a.radius,i=a.zip,r=a.lat,n="",o="lat",l=!1;i?t&&"any"!=t?(n=t+"mi. of "+i,o="zip",l=!0):n="Nationwide of "+i:r&&t?(n="any"!=t?t+"mi. near you":"Nationwide",l=!0):n="Nationwide",U("location",n,l);var s=TOL.Module.Listings.getSearchParams().zip;!s&&TOL.Module.Listings.getSearchParams().lat&&(s=u),null!=TOL.getGet("lat")&&null!=TOL.getGet("long")?e(".useMyLocation").show():e(".useMyLocation").hide(),$(TOL.Module.Listings.getSearchParams().radius,s)},U=function(a,t,i){void 0==i&&(i=""!=t),i?e("#"+a+"Option .resetFilter").removeClass("hide"):e("#"+a+"Option .resetFilter").addClass("hide"),"846577726,846577727"==t&&(t="Motorcycle Parts & Motorcycle Accessories, Gear, and More"),""!=t&&(t="<span> - "+t+"</span>"),t=e(t),t.find("script").remove(),e("#"+a+"Option .subText").html(t)},V=function(){var t="";a.keywords?t=a.keywords:a.keyword&&(t=a.keyword),U("keyword",t),e(".keyword").attr("value",t)},Z=function(a){a.stopPropagation();var t=e(a.delegateTarget).parent().parent(),i=t.find(".updateZip").val(),r=t.find(".updateRadius").val(),n=""==r,o=null!=t.find(".updateZip").val().match(/^[0-9]{5}$/);n&&!o&&(i=""),i===u&&(o=!0,i=!1),n||o?(i&&setSearchParam("zip",i),$(r,i),setSearchParam("radius",r),setSearchParam("page",1),refreshOptions()):alert("Invalid Zip")},$=function(a,t){e(".updateZip").attr("value",t),e(".updateRadius option").attr("selected",!1);var i=a;null!=a&&""!=a||(i="any"),e('.updateRadius option[value="'+i+'"]').attr("selected",!0),e(".updateRadius").val(i)},q=function(a){a.stopPropagation();var t=TOL.Module.Keywordsearch.getAutocompleteURL();if(""!==t){parseAutocomplete=t.split("&");for(var i in parseAutocomplete)keywordFields=parseAutocomplete[i].split("="),setSearchParam(keywordFields[0],keywordFields[1]);t.indexOf("trim")==-1&&setSearchParam("modelkeyword",1)}else{var r=e(a.delegateTarget).parent().parent().find(".keyword").val();e(".keyword").attr("value",r),setSearchParam("keyword",r)}refreshOptions()},B=function(a){a.stopPropagation();var t=se(e(this)),i=ce(t);if("radius"!=i&&"keyword"!=i){var r=[];switch(e(".checkSelection > label > input:checkbox:checked",t).map(function(){r.push(e(this).attr("id"))}),"trim"==i&&0!=D(r)&&setSearchParam("modelkeyword",null),"model"==i&&""!=t.find("#modelname").val()?(r.push(t.find("#modelname").val()),setSearchParam("modelkeyword",1)):setSearchParam("modelkeyword",null),setSearchParam("page",1),i){case"make":setSearchParam("model",null);case"model":setSearchParam("trim",null)}setSearchParam(i,r.join(",")),refreshOptions()}},J=function(a){var i=a,r=e("#"+a+"Detail .refineOptions").empty();if("undefined"!=typeof v[i]&&ee(e("#"+a+"Detail"),v[i]),"undefined"!=typeof t[i]){if(void 0!=o[i]){var n=o[i];X(r,n)}"make"==i&&X(r,"topMakes"),X(r,i)}},Q=function(a,r){var n=TOL.Module.Listings.getSearchParams()[a];if(p=null,n){var l=n.split(","),s=(t[a],[]);for(var c in l)l[c].indexOf("|")!=-1?s.push(l[c].split("|")[1]):"model"==a&&(p=n);var d=[];for(var c in r)e.inArray(r[c].id,s)!=-1&&d.push(r[c]);d=d.sort(function(e){return e.fullName}).reverse();for(var c in d){var f=d[c];if(i[a]&&i[a].indexOf(f.id)!=-1)if(i[a].splice(i[a].indexOf(f.id),1),t[a][f.id].checked=!0,void 0!=o[a]){var m=o[a];i[m].unshift(f.id),i.topMakes.indexOf(f.id)!=-1&&(i.topMakes.splice(i.topMakes.indexOf(f.id),1),t.topMakes[f.id].checked=!0)}else i[a].unshift(f.id)}}},X=function(a,r){var o=t[r];if(["selectedMakes","selectedModels","selectedTrims","selectedCategories"].indexOf(r)!=-1){var l=n[r].field;o=t[l]}if("selectedModels"==r){var s=p||decodeURIComponent(TOL.getGet("model"));if(e("#modelname").attr("value",""),"undefined"!=s){var c=s.split(","),d=[];for(var f in c)s=c[f],s.indexOf("|")==-1&&1==TOL.getGet("modelkeyword")&&(d=s.split("|"),e("#modelname").attr("value",d[0]))}}if(["selectedMakes","selectedModels","selectedTrims","selectedCategories"].indexOf(r)!=-1||["topMakes","category","make","model","trim"].indexOf(r)==-1,["selectedMakes","selectedModels","selectedTrims","selectedCategories","topMakes","make"].indexOf(r)!=-1&&D(i[r])){var m="";if(void 0!=n[r].title?m=n[r].title:void 0!=n[r]&&(m=n[r]),""!=m){var u=e("#refineTitleTemplate").clone();u.find("span").text(m),a.append(u.html())}}var h=0,v=!1;for(var f in o)h++,0!=o[f].count&&(v=!0);var g,k=h>=60,w=0,l=!1;i[r]=e.unique(i[r]);for(var y in i[r]){var f=i[r][y];if("undefined"!=typeof o[f]&&0!=o[f].count){var O=o[f].name;o[f].id?O=o[f].id:o[f].parameters&&(O=ie(o[f].parameters));var T="";if(v&&(T=le(o[f].count)),["selectedMakes","selectedModels","selectedTrims","selectedCategories","topMakes","make","model","trim","category"].indexOf(r)!=-1){if(l=!!o[f].checked,g!=o[f].parentName&&!l){var u=e("#refineTitleTemplate").clone();u.find("span").text(o[f].parentName),a.append(u.html()),g=o[f].parentName}var S="";""!=o[f].name.trim()&&void 0!==o[f].name&&null!=o[f].name.trim()&&(S=o[f].name),l&&o[f].fullName&&(S=o[f].fullName),ne(a,S,O,T,"refineOption",!1,l)}else"state"==r?oe(a,o[f].name,o[f].name+"|"+O,T,"refineOption",!1):oe(a,o[f].name,O,T,"refineOption",!1);if(w++,"type"==r&&("Toy Hauler"==o[f].name||"Fifth Wheel"==o[f].name)){var P=t.allCategories,M=0;i.allCategories=e.unique(i.allCategories);for(var L in i.allCategories){var C=i.allCategories[L];if("undefined"!=typeof P[C]&&0!=P[C].catCount){var b=P[C].name;if(P[C].id?b=P[C].id:P[C].parameters&&(b=ie(P[C].parameters)),"Fifth Wheel"==o[f].name&&"Horse/Livestock Trailer"==P[C].name){b="Fifth Wheel|"+O+"|"+P[C].name+"|"+b,T=le(P[C].count);var R="Fifth Wheel "+P[C].name;oe(a,R,b,T,"refineOption",!1),M++}else if("Toy Hauler"==o[f].name&&"Horse/Livestock Trailer"!=P[C].name){b="Toy Hauler|"+O+"|"+P[C].name+"|"+b,T=le(P[C].count);var R="Toy Hauler "+P[C].name;oe(a,R,b,T,"refineOption",!1),M++}}}}}}["make","model","trim","category"].indexOf(r)!=-1,k&&(e(".refineShowall i").remove(),e(".refineShowall").click(Y))},Y=function(){e(".rezDetails").show(),e(this).parent().hide()},ee=function(a,t){var i=e(".minValue",a),r=e(".maxValue",a);i.find("option.refineDynamic").remove(),r.find("option.refineDynamic").remove();var n=[],o=[],l=!1,s="",c=!1;e.each(t,function(e,a){for(var t=a.min;t<a.max;)n.push(t),o.push(t),t+=a.increment;a.reverse&&(n.push(t),o.push(t),l=!0),a.format&&(c=a.format),a.prepend&&(s=a.prepend)}),o=o.reverse(),l&&(n=n.reverse()),e.each(n,function(e,a){ae(i,a,s+(c?a.toLocaleString():a))}),e.each(o,function(e,a){ae(r,a,s+(c?a.toLocaleString():a))})},ae=function(e,a,t){var i='<option class="refineDynamic" value=\''+a+"'>"+t+"</option>";e.append(i)},te=function(a){a.stopPropagation();var t=se(e(this)),i=ce(t),r=e(".minValue option:selected",t).val(),n=e(".maxValue option:selected",t).val();if(Number(r)>Number(n)){var o=r;r=n,n=o}setSearchParam(i,r+":"+n),refreshOptions()},ie=function(e){for(param in e)"min"==param.substr(0,3)?e[param.replace("min","max")]||(e[param.replace("min","max")]=null):"max"==param.substr(0,3)&&(e[param.replace("max","min")]||(e[param.replace("max","min")]=null));return e},re=function(a){if(!e(this).closest(".rezDetailsRefine, .desktopCollapse").hasClass("disabled")){a.stopPropagation(),a.preventDefault();var t=ce(e(this)),i=e(this).data("value"),r=e(this).data("name");if(void 0==i&&(i=null),"radius"==t&&null==i&&(i="any",setSearchParam("lat",null),setSearchParam("long",null),e(".updateZip").val("")),"object"==typeof i&&null!=i)for(name in i)setSearchParam(name,i[name]);else if(e.inArray(t,g)!=-1&&null!=i){var n=[];if("string"==typeof i&&i.indexOf("|")!=-1&&(n=i.split("|")),"type"==t&&4==n.length){var o=n[0]+"|"+n[1];setSearchParam("type",o);var l=n[2]+"|"+n[3];setSearchParam("category",l)}else nameid=r+"|"+i,setSearchParam(t,nameid),"undefined"!=typeof h[i]?setSearchParam("schemecode",h[i]):setSearchParam("schemecode",null)}else{switch(setSearchParam(t,i),t){case"make":setSearchParam("model",null),setSearchParam("modelkeyword",null);case"model":setSearchParam("trim",null),setSearchParam("modelkeyword",null);break;case"type":setSearchParam("schemecode",null)}"type"==t&&3==tolConfig.getRealmId()&&setSearchParam("category",null)}"trim"==t&&setSearchParam("modelkeyword",null),setSearchParam("page",1),refreshOptions()}},ne=function(a,t,i,r,n,o,l){var s=e("#refineCheckboxTemplate").children(":first").clone();a.append(s);var c=s.find("div.checkSelection > label");c.find("input").attr("id",t+"|"+i).attr("data-track","Refine By "+le(t)),l&&c.find("input").attr("id",t+"|"+i).attr("checked","checked"),c.find("span.subText").text(le(t)),""!=r&&(r=TOL.numberFormat(r),c.find("span.facetCount").text(" ("+r+")")),c.find("label").attr("for",t+"|"+i)},oe=function(a,t,i,r,n,o,l){var s=e("#refineOptionTemplate").children(":first").clone();a.append(s);var c=s.find("div.filterSelection");"object"==typeof i&&(i=JSON.stringify(i)),c.addClass(n).attr("data-value",i).attr("data-name",t),c.find("a.itemName").text(le(t)),c.find("a.itemName").attr("data-track","Refine By "+le(t)),""!=r&&(r=TOL.numberFormat(r),c.find("span.subText").html(" ("+r+")")),"undefined"!=typeof l&&l==t&&s.addClass("disabled").children(":first").removeClass("refineParameter")},le=function(e){return"fuelType"==e?"Fuel Type":"sellerType"==e?"Seller Type":"grossVehicleWeight"==e?"Gross Vehicle Weight":"sleepingCapacity"==e?"Sleeping Capacity":"propellerHours"==e?"Propeller Hours":"airframeTime"==e?"Airframe Time":"engineHours"==e?"Engine Hours":"engineSize"==e?"Engine Size":"lat"==e?"Location":"class"==e?"Type":(e+"").split("|")[0].replace(/_/g," ").replace(encodeURIComponent("&"),"&").replace(/^([a-z])|\s+([a-z])/g,function(e){return e.toUpperCase()})},se=function(e,a){var t=e.attr("data-param"),i=e.data("refine");return void 0!=t||void 0!=i?e:a>5?null:se(e.parent(),a+1)},ce=function(e){var a=se(e,0),t=null;return null!=a&&(t=a.attr("data-param"),null==t&&(t=a.data("refine"))),t};return setSearchParam=function(e,a){TOL.Module.Listings.setSearchParam(e,a)},isEditable=function(e){if(location.href.search("allowed_"+e)!=-1)return!1;if("trim"==e&&""==N("model"))return!1;if(v[e]){var a=e.charAt(0).toUpperCase()+e.slice(1),t="min"+a,i="max"+a;return isEditable(t)&&isEditable(i)}return!0},refreshOptions=function(){s&&(setSearchParam("page",1),setSearchParam("adFeatureId",null)),null!=d&&(e("#"+d).popover("hide"),d=null),null!=c&&(e("#"+c).collapse("hide"),c=null),TOL.Module.ModalWindow.show("loadingModal"),e("#loadingModal").css({height:"","overflow-y":""}),window.location.pathname.search("/"+w)!=-1||window.location.pathname.search("/price-checker")!=-1?(TOL.Module.Refinesearch.isRefining()&&(TOL.Module.Refinesearch.loadRefineData(),TOL.Module.Listings.saveSearch()),TOL.Module.Refinesearch.isColumn()&&TOL.Module.Listings.saveSearch()):TOL.Module.Listings.loadSearch()},{init:O,initialize:M,loadRefineData:L,filterRefineCounts:T,cancelRefine:_,setRefining:function(e){l=e},isRefining:function(){return l},setColumn:function(e){s=e},isColumn:function(){return s},getTypeName:function(){return r.type[0]?r.type[0].name||null:null}}}}(jQuery);
TOL.Module.RequestTradeInValue=function(e){var t=function(){window.location.pathname.search("/listing/email/tradein")!==-1&&(e("#selected_contacttime").length&&e("#contacttime").val(e("#selected_contacttime").val()),e("#selected_type").length&&e("#tradein_type").val(e("#selected_type").val()),e("#selected_slideouts").length&&e("#tradein_slideouts").val(e("selected_slideouts").val()),e("#tradein_make").length&&a())},a=function(){e.ajax({type:"POST",url:"/Gettiledata/requesttradeinvalue/getmakes",dataType:"json",data:{vehicleType:e("#tradein_type").val()},cache:!1}).done(function(t){e("#tradein_make").empty(),e("#tradein_make").append('<option value="">Select</option>'),e.each(t,function(t,a){e("#tradein_make").append(e("<option></option>").attr("value",t).text(a))}),e("#selected_make").val()&&(e("#tradein_make").val(e("#selected_make").val()),TOL.Module.RequestTradeInValue.getYears(),e("#selected_make").remove())})},l=function(){var t=e("#tradein_make option:selected").val().replace(/(.+\|)(\d+)$/,"$2");t.length<1||(e("#tradein_year").val(""),e("#selected_year").val()&&(e("#tradein_year").val(e("#selected_year").val()),TOL.Module.RequestTradeInValue.getModels(),e("#selected_make").remove()))},d=function(){var t=e("#tradein_make option:selected").val().replace(/(.+\|)(\d+)$/,"$2"),a=e("#tradein_year").val();t.length<1||a.length<1||(e.ajax({type:"POST",url:"/Gettiledata/requesttradeinvalue/getmodels",dataType:"json",data:{makeId:t,year:a},cache:!1}).done(function(t){e("#tradein_model").empty(),e("#tradein_model").append('<option val="">Select</option>'),e.each(t,function(t,a){e("#tradein_model").append(e("<option></option").attr("value",t).text(a))})}),e("#tradein_model").val(""),e("#selected_model").val()&&(e("#tradein_model").val(e("#selected_model").val()),n(),e("#selected_model").remove()))},n=function(){var t={};t.modelId=parseInt(e("#tradein_model option:selected").val().replace(/(.+\|)(\d+)$/,"$2")),t.modelId.length<1||(e.ajax({type:"POST",url:"/Gettiledata/requesttradeinvalue/gettrims",dataType:"json",data:t,cache:!1}).done(function(t){e("#tradein_trim").empty(),e.isEmptyObject(t)?e("#model_trim").addClass("hidden"):(e("#tradein_trim").append('<option val="">Select</option>'),e.each(t,function(t,a){e("#tradein_trim").append(e("<option></option").attr("value",t).text(a))}),e("#model_trim").removeClass("hidden"))}),e("#tradein_trim").val(""),e("#selected_trim").val()&&(e("#tradein_trim").val(e("#selected_trim").val()),e("#selected_trim").remove()))};return{priority:"last",init:t,getMakes:a,getYears:l,getModels:d,getTrims:n}}(jQuery);
TOL.Module.Styleguide=function(n){function r(){n(".color-box").each(function(r,e){var t=n(e).css("backgroundColor"),a=o(n(e).css("backgroundColor"));n(e).append('<br><span class="small">'+a+"<br>"+t+"</span>")})}function o(n){var r=n.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);delete r[0];for(var o=1;o<=3;++o)r[o]=parseInt(r[o]).toString(16),1==r[o].length&&(r[o]="0"+r[o]);return"#"+r.join("")}return{init:r,hexc:o}}(jQuery);
!function(e,t){t.TOL_API_SEARCH=function(e,t){this._isDirty=!0,this.results=null,this._type=e,this._stringVal="",this._affilParams={},this._params={};for(name in t)this.set(name,t[name])};var i=["vrsn","affilid","headertitle","primarycolor","backgroundcolor"],r=["keyword","type","make","model","trim","category","price","condition","year","seller_type","mileage","engineSize","length","fuelType","grossVehicleWeight","sleepingCapacity","slideouts","propellerHours","airframeTime","engineHours","zip","lat","long","radius","city","state","sort","modelkeyword","page","dealerid","view","class","sortOrder","adType","includeFilterCounts","filterCountLimit","selectedFilters","hasPhoto","hasVideo","suggestionRulesId","suggestionMinCount","dealerFeatureId","schemecode","test","ref","testint","keywords","advanced_search","adFeatureId","layoutView","pricecheck","zmc","cmp","utm_source","utm_medium","utm_campaign","utm_term","utm_content","gclid"];TOL_API_SEARCH.prototype.clone=function(){var t=new TOL_API_SEARCH(this._type,e.extend({},this._params));return t.results=this.results,t.dirty=this._isDirty,t._affilParams=this._affilParams,t},TOL_API_SEARCH.prototype.set=function(t,a){if(a=decodeURIComponent(a),"zip"==t&&(delete this._params.state,delete this._params.city),"null"==a||""==a)delete this._params[t];else if(e.inArray(t,r)!=-1)this._params[t]=a.replace("&",encodeURIComponent("&"));else{if(e.inArray(t,i)==-1&&e.inArray(t.replace(/^allowed_/,""),r)==-1)return;this._affilParams[t]=a}this._isDirty=!0},TOL_API_SEARCH.prototype.nextPage=function(){if(!this.isLastPage()){var e=parseInt(this.get("page"));(isNaN(e)||e<1)&&(e=1),this.set("page",e+1)}},TOL_API_SEARCH.prototype.prevPage=function(){var e=this.get("page");e>1&&this.set("page",e-1)},TOL_API_SEARCH.prototype.get=function(e){return this._params[e]},TOL_API_SEARCH.prototype.getParams=function(){return this._params},TOL_API_SEARCH.prototype.getQuery=function(){for(var t="?",i=["limit","includeFilterCounts","filterCountLimit","selectedFilters","view","longitude"],a={},s=r.length,n=0;n<s;n++)r[n]in this._params&&"function"!=typeof this._params[r[n]]&&(a[r[n]]=this._params[r[n]]);this._params=a;for(var o in this._params){var p=this._params[o];if(e.inArray(o,i)==-1&&("page"!=o||"1"!==p))if("latitude"==o)this.get("longitude")&&(t+="geoLocation=true&",t+="latitude="+encodeURIComponent(this.get("latitude"))+"&",t+="longitude="+encodeURIComponent(this.get("longitude"))+"&");else{var l=p;try{l=decodeURIComponent(p)}catch(u){l=p}t+=encodeURIComponent(o)+"="+encodeURIComponent(l)+"&"}}for(var o in this._affilParams){var p=this._affilParams[o];t+=encodeURIComponent(o)+"="+encodeURIComponent(p)+"&"}return t.length>1&&(t=t.substring(0,t.length-1)),t},TOL_API_SEARCH.prototype.isDirty=function(){return this._isDirty},TOL_API_SEARCH.prototype.getCurrentPage=function(){return this._params.page},TOL_API_SEARCH.prototype.isLastPage=function(){return!1}}(jQuery,window);
+function(t){"use strict";function e(e){var a,s=e.attr("data-target")||(a=e.attr("href"))&&a.replace(/.*(?=#[^\s]+$)/,"");return t(s)}function a(e){return this.each(function(){var a=t(this),i=a.data("bs.collapse"),n=t.extend({},s.DEFAULTS,a.data(),"object"==typeof e&&e);!i&&n.toggle&&/show|hide/.test(e)&&(n.toggle=!1),i||a.data("bs.collapse",i=new s(this,n)),"string"==typeof e&&i[e]()})}var s=function(e,a){this.$element=t(e),this.options=t.extend({},s.DEFAULTS,a),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};s.VERSION="3.3.7",s.TRANSITION_DURATION=350,s.DEFAULTS={toggle:!0},s.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},s.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,i=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(i&&i.length&&(e=i.data("bs.collapse"),e&&e.transitioning))){var n=t.Event("show.bs.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){i&&i.length&&(a.call(i,"hide"),e||i.data("bs.collapse",null));var l=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[l](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var o=function(){this.$element.removeClass("collapsing").addClass("collapse in")[l](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return o.call(this);var r=t.camelCase(["scroll",l].join("-"));this.$element.one("bsTransitionEnd",t.proxy(o,this)).emulateTransitionEnd(s.TRANSITION_DURATION)[l](this.$element[0][r])}}}},s.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var a=this.dimension();this.$element[a](this.$element[a]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return t.support.transition?void this.$element[a](0).one("bsTransitionEnd",t.proxy(i,this)).emulateTransitionEnd(s.TRANSITION_DURATION):i.call(this)}}},s.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},s.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(a,s){var i=t(s);this.addAriaAndCollapsedClass(e(i),i)},this)).end()},s.prototype.addAriaAndCollapsedClass=function(t,e){var a=t.hasClass("in");t.attr("aria-expanded",a),e.toggleClass("collapsed",!a).attr("aria-expanded",a)};var i=t.fn.collapse;t.fn.collapse=a,t.fn.collapse.Constructor=s,t.fn.collapse.noConflict=function(){return t.fn.collapse=i,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(s){var i=t(this);i.attr("data-target")||s.preventDefault();var n=e(i),l=n.data("bs.collapse"),o=l?"toggle":i.data();a.call(n,o)})}(jQuery);
+function(t){"use strict";function a(a){return this.each(function(){var n=t(this),i=n.data("bs.tab");i||n.data("bs.tab",i=new e(this)),"string"==typeof a&&i[a]()})}var e=function(a){this.element=t(a)};e.VERSION="3.3.7",e.TRANSITION_DURATION=150,e.prototype.show=function(){var a=this.element,e=a.closest("ul:not(.dropdown-menu)"),n=a.data("target");if(n||(n=a.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),!a.parent("li").hasClass("active")){var i=e.find(".active:last a"),r=t.Event("hide.bs.tab",{relatedTarget:a[0]}),s=t.Event("show.bs.tab",{relatedTarget:i[0]});if(i.trigger(r),a.trigger(s),!s.isDefaultPrevented()&&!r.isDefaultPrevented()){var d=t(n);this.activate(a.closest("li"),e),this.activate(d,d.parent(),function(){i.trigger({type:"hidden.bs.tab",relatedTarget:a[0]}),a.trigger({type:"shown.bs.tab",relatedTarget:i[0]})})}}},e.prototype.activate=function(a,n,i){function r(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),a.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),d?(a[0].offsetWidth,a.addClass("in")):a.removeClass("fade"),a.parent(".dropdown-menu").length&&a.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}var s=n.find("> .active"),d=i&&t.support.transition&&(s.length&&s.hasClass("fade")||!!n.find("> .fade").length);s.length&&d?s.one("bsTransitionEnd",r).emulateTransitionEnd(e.TRANSITION_DURATION):r(),s.removeClass("in")};var n=t.fn.tab;t.fn.tab=a,t.fn.tab.Constructor=e,t.fn.tab.noConflict=function(){return t.fn.tab=n,this};var i=function(e){e.preventDefault(),a.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery);
+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),n=o.data("bs.tooltip"),s="object"==typeof e&&e;!n&&/destroy|hide/.test(e)||(n||o.data("bs.tooltip",n=new i(this,s)),"string"==typeof e&&n[e]())})}var i=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};i.VERSION="3.3.7",i.TRANSITION_DURATION=150,i.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},i.prototype.init=function(e,i,o){if(this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(o),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var n=this.options.trigger.split(" "),s=n.length;s--;){var r=n[s];if("click"==r)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=r){var l="hover"==r?"mouseenter":"focusin",a="hover"==r?"mouseleave":"focusout";this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},i.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,o){i[t]!=o&&(e[t]=o)}),e},i.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusin"==e.type?"focus":"hover"]=!0),i.tip().hasClass("in")||"in"==i.hoverState?void(i.hoverState="in"):(clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show())},i.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},i.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusout"==e.type?"focus":"hover"]=!1),!i.isInStateTrue())return clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide()},i.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var o=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!o)return;var n=this,s=this.tip(),r=this.getUID(this.type);this.setContent(),s.attr("id",r),this.$element.attr("aria-describedby",r),this.options.animation&&s.addClass("fade");var l="function"==typeof this.options.placement?this.options.placement.call(this,s[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,p=a.test(l);p&&(l=l.replace(a,"")||"top"),s.detach().css({top:0,left:0,display:"block"}).addClass(l).data("bs."+this.type,this),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var h=this.getPosition(),f=s[0].offsetWidth,c=s[0].offsetHeight;if(p){var u=l,d=this.getPosition(this.$viewport);l="bottom"==l&&h.bottom+c>d.bottom?"top":"top"==l&&h.top-c<d.top?"bottom":"right"==l&&h.right+f>d.width?"left":"left"==l&&h.left-f<d.left?"right":l,s.removeClass(u).addClass(l)}var g=this.getCalculatedOffset(l,h,f,c);this.applyPlacement(g,l);var v=function(){var t=n.hoverState;n.$element.trigger("shown.bs."+n.type),n.hoverState=null,"out"==t&&n.leave(n)};t.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",v).emulateTransitionEnd(i.TRANSITION_DURATION):v()}},i.prototype.applyPlacement=function(e,i){var o=this.tip(),n=o[0].offsetWidth,s=o[0].offsetHeight,r=parseInt(o.css("margin-top"),10),l=parseInt(o.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(l)&&(l=0),e.top+=r,e.left+=l,t.offset.setOffset(o[0],t.extend({using:function(t){o.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),o.addClass("in");var a=o[0].offsetWidth,p=o[0].offsetHeight;"top"==i&&p!=s&&(e.top=e.top+s-p);var h=this.getViewportAdjustedDelta(i,e,a,p);h.left?e.left+=h.left:e.top+=h.top;var f=/top|bottom/.test(i),c=f?2*h.left-n+a:2*h.top-s+p,u=f?"offsetWidth":"offsetHeight";o.offset(e),this.replaceArrow(c,o[0][u],f)},i.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},i.prototype.hide=function(e){function o(){"in"!=n.hoverState&&s.detach(),n.$element&&n.$element.removeAttr("aria-describedby").trigger("hidden.bs."+n.type),e&&e()}var n=this,s=t(this.$tip),r=t.Event("hide.bs."+this.type);if(this.$element.trigger(r),!r.isDefaultPrevented())return s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",o).emulateTransitionEnd(i.TRANSITION_DURATION):o(),this.hoverState=null,this},i.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},i.prototype.hasContent=function(){return this.getTitle()},i.prototype.getPosition=function(e){e=e||this.$element;var i=e[0],o="BODY"==i.tagName,n=i.getBoundingClientRect();null==n.width&&(n=t.extend({},n,{width:n.right-n.left,height:n.bottom-n.top}));var s=window.SVGElement&&i instanceof window.SVGElement,r=o?{top:0,left:0}:s?null:e.offset(),l={scroll:o?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},a=o?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},n,l,a,r)},i.prototype.getCalculatedOffset=function(t,e,i,o){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-o,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-o/2,left:e.left-i}:{top:e.top+e.height/2-o/2,left:e.left+e.width}},i.prototype.getViewportAdjustedDelta=function(t,e,i,o){var n={top:0,left:0};if(!this.$viewport)return n;var s=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(t)){var l=e.top-s-r.scroll,a=e.top+s-r.scroll+o;l<r.top?n.top=r.top-l:a>r.top+r.height&&(n.top=r.top+r.height-a)}else{var p=e.left-s,h=e.left+s+i;p<r.left?n.left=r.left-p:h>r.right&&(n.left=r.left+r.width-h)}return n},i.prototype.getTitle=function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},i.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},i.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},i.prototype.enable=function(){this.enabled=!0},i.prototype.disable=function(){this.enabled=!1},i.prototype.toggleEnabled=function(){this.enabled=!this.enabled},i.prototype.toggle=function(e){var i=this;e&&(i=t(e.currentTarget).data("bs."+this.type),i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),e?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)},i.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null})};var o=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=i,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=o,this}}(jQuery);
+function(t){"use strict";function o(o){return this.each(function(){var n=t(this),r=n.data("bs.popover"),i="object"==typeof o&&o;!r&&/destroy|hide/.test(o)||(r||n.data("bs.popover",r=new e(this,i)),"string"==typeof o&&r[o]())})}var e=function(t,o){this.init("popover",t,o)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");e.VERSION="3.3.7",e.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),e.prototype.constructor=e,e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.setContent=function(){var t=this.tip(),o=this.getTitle(),e=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](o),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof e?"html":"append":"text"](e),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},e.prototype.hasContent=function(){return this.getTitle()||this.getContent()},e.prototype.getContent=function(){var t=this.$element,o=this.options;return t.attr("data-content")||("function"==typeof o.content?o.content.call(t[0]):o.content)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var n=t.fn.popover;t.fn.popover=o,t.fn.popover.Constructor=e,t.fn.popover.noConflict=function(){return t.fn.popover=n,this}}(jQuery);
+function(n){"use strict";function t(){var n=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==n.style[i])return{end:t[i]};return!1}n.fn.emulateTransitionEnd=function(t){var i=!1,r=this;n(this).one("bsTransitionEnd",function(){i=!0});var e=function(){i||n(r).trigger(n.support.transition.end)};return setTimeout(e,t),this},n(function(){n.support.transition=t(),n.support.transition&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function(t){if(n(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery);
(function(){"use strict";function e(){}function t(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function n(e){return function(){return this[e].apply(this,arguments)}}var i=e.prototype,r=this,s=r.EventEmitter;i.getListeners=function(e){var t,n,i=this._getEvents();if("object"==typeof e){t={};for(n in i)i.hasOwnProperty(n)&&e.test(n)&&(t[n]=i[n])}else t=i[e]||(i[e]=[]);return t},i.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},i.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},i.addListener=function(e,n){var i,r=this.getListenersAsObject(e),s="object"==typeof n;for(i in r)r.hasOwnProperty(i)&&-1===t(r[i],n)&&r[i].push(s?n:{listener:n,once:!1});return this},i.on=n("addListener"),i.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},i.once=n("addOnceListener"),i.defineEvent=function(e){return this.getListeners(e),this},i.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},i.removeListener=function(e,n){var i,r,s=this.getListenersAsObject(e);for(r in s)s.hasOwnProperty(r)&&(i=t(s[r],n),-1!==i&&s[r].splice(i,1));return this},i.off=n("removeListener"),i.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},i.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},i.manipulateListeners=function(e,t,n){var i,r,s=e?this.removeListener:this.addListener,o=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(i=n.length;i--;)s.call(this,t,n[i]);else for(i in t)t.hasOwnProperty(i)&&(r=t[i])&&("function"==typeof r?s.call(this,i,r):o.call(this,i,r));return this},i.removeEvent=function(e){var t,n=typeof e,i=this._getEvents();if("string"===n)delete i[e];else if("object"===n)for(t in i)i.hasOwnProperty(t)&&e.test(t)&&delete i[t];else delete this._events;return this},i.removeAllListeners=n("removeEvent"),i.emitEvent=function(e,t){var n,i,r,s,o=this.getListenersAsObject(e);for(r in o)if(o.hasOwnProperty(r))for(i=o[r].length;i--;)n=o[r][i],n.once===!0&&this.removeListener(e,n.listener),s=n.listener.apply(this,t||[]),s===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},i.trigger=n("emitEvent"),i.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},i.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},i._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},i._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return r.EventEmitter=s,e},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.EventEmitter=e}).call(this),function(e){function t(t){var n=e.event;return n.target=n.target||n.srcElement||t,n}var n=document.documentElement,i=function(){};n.addEventListener?i=function(e,t,n){e.addEventListener(t,n,!1)}:n.attachEvent&&(i=function(e,n,i){e[n+i]=i.handleEvent?function(){var n=t(e);i.handleEvent.call(i,n)}:function(){var n=t(e);i.call(e,n)},e.attachEvent("on"+n,e[n+i])});var r=function(){};n.removeEventListener?r=function(e,t,n){e.removeEventListener(t,n,!1)}:n.detachEvent&&(r=function(e,t,n){e.detachEvent("on"+t,e[t+n]);try{delete e[t+n]}catch(i){e[t+n]=void 0}});var s={bind:i,unbind:r};"function"==typeof define&&define.amd?define("eventie/eventie",s):e.eventie=s}(this),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(n,i){return t(e,n,i)}):"object"==typeof module&&module.exports?module.exports=t(e,require("wolfy87-eventemitter"),require("eventie")):e.imagesLoaded=t(e,e.EventEmitter,e.eventie)}(window,function(e,t,n){function i(e,t){for(var n in t)e[n]=t[n];return e}function r(e){return"[object Array]"==f.call(e)}function s(e){var t=[];if(r(e))t=e;else if("number"==typeof e.length)for(var n=0;n<e.length;n++)t.push(e[n]);else t.push(e);return t}function o(e,t,n){if(!(this instanceof o))return new o(e,t,n);"string"==typeof e&&(e=document.querySelectorAll(e)),this.elements=s(e),this.options=i({},this.options),"function"==typeof t?n=t:i(this.options,t),n&&this.on("always",n),this.getImages(),u&&(this.jqDeferred=new u.Deferred);var r=this;setTimeout(function(){r.check()})}function h(e){this.img=e}function a(e,t){this.url=e,this.element=t,this.img=new Image}var u=e.jQuery,c=e.console,f=Object.prototype.toString;o.prototype=new t,o.prototype.options={},o.prototype.getImages=function(){this.images=[];for(var e=0;e<this.elements.length;e++){var t=this.elements[e];this.addElementImages(t)}},o.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),this.options.background===!0&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&d[t]){for(var n=e.querySelectorAll("img"),i=0;i<n.length;i++){var r=n[i];this.addImage(r)}if("string"==typeof this.options.background){var s=e.querySelectorAll(this.options.background);for(i=0;i<s.length;i++){var o=s[i];this.addElementBackgroundImages(o)}}}};var d={1:!0,9:!0,11:!0};o.prototype.addElementBackgroundImages=function(e){for(var t=l(e),n=/url\(['"]*([^'"\)]+)['"]*\)/gi,i=n.exec(t.backgroundImage);null!==i;){var r=i&&i[1];r&&this.addBackground(r,e),i=n.exec(t.backgroundImage)}};var l=e.getComputedStyle||function(e){return e.currentStyle};return o.prototype.addImage=function(e){var t=new h(e);this.images.push(t)},o.prototype.addBackground=function(e,t){var n=new a(e,t);this.images.push(n)},o.prototype.check=function(){function e(e,n,i){setTimeout(function(){t.progress(e,n,i)})}var t=this;if(this.progressedCount=0,this.hasAnyBroken=!1,!this.images.length)return void this.complete();for(var n=0;n<this.images.length;n++){var i=this.images[n];i.once("progress",e),i.check()}},o.prototype.progress=function(e,t,n){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emit("progress",this,e,t),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&c&&c.log("progress: "+n,e,t)},o.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emit(e,this),this.emit("always",this),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},h.prototype=new t,h.prototype.check=function(){var e=this.getIsImageComplete();return e?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,n.bind(this.proxyImage,"load",this),n.bind(this.proxyImage,"error",this),n.bind(this.img,"load",this),n.bind(this.img,"error",this),void(this.proxyImage.src=this.img.src))},h.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},h.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("progress",this,this.img,t)},h.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},h.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},h.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},h.prototype.unbindEvents=function(){n.unbind(this.proxyImage,"load",this),n.unbind(this.proxyImage,"error",this),n.unbind(this.img,"load",this),n.unbind(this.img,"error",this)},a.prototype=new h,a.prototype.check=function(){n.bind(this.img,"load",this),n.bind(this.img,"error",this),this.img.src=this.url;var e=this.getIsImageComplete();e&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},a.prototype.unbindEvents=function(){n.unbind(this.img,"load",this),n.unbind(this.img,"error",this)},a.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("progress",this,this.element,t)},o.makeJQueryPlugin=function(t){t=t||e.jQuery,t&&(u=t,u.fn.imagesLoaded=function(e,t){var n=new o(this,e,t);return n.jqDeferred.promise(u(this))})},o.makeJQueryPlugin(),o});
+function(t){"use strict";function s(e,i){this.$body=t(document.body),this.$scrollElement=t(t(e).is(document.body)?window:e),this.options=t.extend({},s.DEFAULTS,i),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function e(e){return this.each(function(){var i=t(this),o=i.data("bs.scrollspy"),r="object"==typeof e&&e;o||i.data("bs.scrollspy",o=new s(this,r)),"string"==typeof e&&o[e]()})}s.VERSION="3.3.7",s.DEFAULTS={offset:10},s.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},s.prototype.refresh=function(){var s=this,e="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(e="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var s=t(this),o=s.data("target")||s.attr("href"),r=/^#./.test(o)&&t(o);return r&&r.length&&r.is(":visible")&&[[r[e]().top+i,o]]||null}).sort(function(t,s){return t[0]-s[0]}).each(function(){s.offsets.push(this[0]),s.targets.push(this[1])})},s.prototype.process=function(){var t,s=this.$scrollElement.scrollTop()+this.options.offset,e=this.getScrollHeight(),i=this.options.offset+e-this.$scrollElement.height(),o=this.offsets,r=this.targets,l=this.activeTarget;if(this.scrollHeight!=e&&this.refresh(),s>=i)return l!=(t=r[r.length-1])&&this.activate(t);if(l&&s<o[0])return this.activeTarget=null,this.clear();for(t=o.length;t--;)l!=r[t]&&s>=o[t]&&(void 0===o[t+1]||s<o[t+1])&&this.activate(r[t])},s.prototype.activate=function(s){this.activeTarget=s,this.clear();var e=this.selector+'[data-target="'+s+'"],'+this.selector+'[href="'+s+'"]',i=t(e).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},s.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var i=t.fn.scrollspy;t.fn.scrollspy=e,t.fn.scrollspy.Constructor=s,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=i,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var s=t(this);e.call(s,s.data())})})}(jQuery);
+function(t){"use strict";function i(i){return this.each(function(){var o=t(this),f=o.data("bs.affix"),n="object"==typeof i&&i;f||o.data("bs.affix",f=new e(this,n)),"string"==typeof i&&f[i]()})}var e=function(i,o){this.options=t.extend({},e.DEFAULTS,o),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(i),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};e.VERSION="3.3.7",e.RESET="affix affix-top affix-bottom",e.DEFAULTS={offset:0,target:window},e.prototype.getState=function(t,i,e,o){var f=this.$target.scrollTop(),n=this.$element.offset(),s=this.$target.height();if(null!=e&&"top"==this.affixed)return f<e&&"top";if("bottom"==this.affixed)return null!=e?!(f+this.unpin<=n.top)&&"bottom":!(f+s<=t-o)&&"bottom";var a=null==this.affixed,h=a?f:n.top,r=a?s:i;return null!=e&&f<=e?"top":null!=o&&h+r>=t-o&&"bottom"},e.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(e.RESET).addClass("affix");var t=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-t},e.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var i=this.$element.height(),o=this.options.offset,f=o.top,n=o.bottom,s=Math.max(t(document).height(),t(document.body).height());"object"!=typeof o&&(n=f=o),"function"==typeof f&&(f=o.top(this.$element)),"function"==typeof n&&(n=o.bottom(this.$element));var a=this.getState(s,i,f,n);if(this.affixed!=a){null!=this.unpin&&this.$element.css("top","");var h="affix"+(a?"-"+a:""),r=t.Event(h+".bs.affix");if(this.$element.trigger(r),r.isDefaultPrevented())return;this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(e.RESET).addClass(h).trigger(h.replace("affix","affixed")+".bs.affix")}"bottom"==a&&this.$element.offset({top:s-i-n})}};var o=t.fn.affix;t.fn.affix=i,t.fn.affix.Constructor=e,t.fn.affix.noConflict=function(){return t.fn.affix=o,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var e=t(this),o=e.data();o.offset=o.offset||{},null!=o.offsetBottom&&(o.offset.bottom=o.offsetBottom),null!=o.offsetTop&&(o.offset.top=o.offsetTop),i.call(e,o)})})}(jQuery);
!function(t){t.fn.unveil=function(i,e){function n(){var i=a.filter(function(){var i=t(this),e=o.scrollTop(),n=e+o.height(),r=i.offset().top,u=r+i.height();return u>=e-s&&r<=n+s});r=i.trigger("unveil"),a=a.not(r)}var r,o=t(window),s=i||0,u=window.devicePixelRatio>1,c=u?"data-src-retina":"data-src",a=this;return this.one("unveil",function(){var t=this.getAttribute(c);t=t||this.getAttribute("data-src"),t&&(this.setAttribute("src",t),"function"==typeof e&&e.call(this))}),o.scroll(n),o.resize(n),n(),this}}(window.jQuery||window.Zepto);
!function(t){"use strict";"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=t():window.Sortable=t()}(function(){"use strict";function t(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(t);this.el=t,this.options=e=_({},e),t[V]=this;var n={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(t.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0}};for(var i in n)!(i in e)&&(e[i]=n[i]);at(e);for(var o in this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!e.forceFallback&&K,r(t,"mousedown",this._onTapStart),r(t,"touchstart",this._onTapStart),r(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(r(t,"dragover",this),r(t,"dragenter",this)),ot.push(this._onDragOver),e.store&&this.sort(e.store.get(this))}function e(t,e){"clone"!==t.lastPullMode&&(e=!0),S&&S.state!==e&&(l(S,"display",e?"none":""),e||S.state&&(t.options.group.revertClone?(E.insertBefore(S,x),t._animate(w,S)):E.insertBefore(S,w)),S.state=e)}function n(t,e,n){if(t){n=n||z;do if(">*"===e&&t.parentNode===n||m(t,e))return t;while(t=i(t))}return null}function i(t){var e=t.host;return e&&e.nodeType?e:t.parentNode}function o(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.preventDefault()}function r(t,e,n){t.addEventListener(e,n,J)}function a(t,e,n){t.removeEventListener(e,n,J)}function s(t,e,n){if(t)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(H," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(H," ")}}function l(t,e,n){var i=t&&t.style;if(i){if(void 0===n)return z.defaultView&&z.defaultView.getComputedStyle?n=z.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in i||(e="-webkit-"+e),i[e]=n+("string"==typeof n?"":"px")}}function c(t,e,n){if(t){var i=t.getElementsByTagName(e),o=0,r=i.length;if(n)for(;o<r;o++)n(i[o],o);return i}return[]}function d(t,e,n,i,o,r,a){t=t||e[V];var s=z.createEvent("Event"),l=t.options,c="on"+n.charAt(0).toUpperCase()+n.substr(1);s.initEvent(n,!0,!0),s.to=e,s.from=o||e,s.item=i||e,s.clone=S,s.oldIndex=r,s.newIndex=a,e.dispatchEvent(s),l[c]&&l[c].call(t,s)}function h(t,e,n,i,o,r,a,s){var l,c,d=t[V],h=d.options.onMove;return l=z.createEvent("Event"),l.initEvent("move",!0,!0),l.to=e,l.from=t,l.dragged=n,l.draggedRect=i,l.related=o||e,l.relatedRect=r||e.getBoundingClientRect(),l.willInsertAfter=s,t.dispatchEvent(l),h&&(c=h.call(d,l,a)),c}function u(t){t.draggable=!1}function f(){tt=!1}function p(t,e){var n=t.lastElementChild,i=n.getBoundingClientRect();return e.clientY-(i.top+i.height)>5||e.clientX-(i.left+i.width)>5}function g(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;n--;)i+=e.charCodeAt(n);return i.toString(36)}function v(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t&&(t=t.previousElementSibling);)"TEMPLATE"===t.nodeName.toUpperCase()||">*"!==e&&!m(t,e)||n++;return n}function m(t,e){if(t){e=e.split(".");var n=e.shift().toUpperCase(),i=new RegExp("\\s("+e.join("|")+")(?=\\s)","g");return!(""!==n&&t.nodeName.toUpperCase()!=n||e.length&&((" "+t.className+" ").match(i)||[]).length!=e.length)}return!1}function b(t,e){var n,i;return function(){void 0===n&&(n=arguments,i=this,setTimeout(function(){1===n.length?t.call(i,n[0]):t.apply(i,n),n=void 0},e))}}function _(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function D(t){return Q?Q(t).clone(!0)[0]:Z&&Z.dom?Z.dom(t).cloneNode(!0):t.cloneNode(!0)}function y(t){for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var i=e[n];i.checked&&it.push(i)}}if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var w,T,C,S,E,x,N,k,B,Y,O,X,A,M,P,R,I,L,F,U,j={},H=/\s+/g,W=/left|right|inline/,V="Sortable"+(new Date).getTime(),q=window,z=q.document,G=q.parseInt,Q=q.jQuery||q.Zepto,Z=q.Polymer,J=!1,K=!!("draggable"in z.createElement("div")),$=function(t){return!navigator.userAgent.match(/Trident.*rv[ :]?11\./)&&(t=z.createElement("x"),t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents)}(),tt=!1,et=Math.abs,nt=Math.min,it=[],ot=[],rt=b(function(t,e,n){if(n&&e.scroll){var i,o,r,a,s,l,c=n[V],d=e.scrollSensitivity,h=e.scrollSpeed,u=t.clientX,f=t.clientY,p=window.innerWidth,g=window.innerHeight;if(B!==n&&(k=e.scroll,B=n,Y=e.scrollFn,k===!0)){k=n;do if(k.offsetWidth<k.scrollWidth||k.offsetHeight<k.scrollHeight)break;while(k=k.parentNode)}k&&(i=k,o=k.getBoundingClientRect(),r=(et(o.right-u)<=d)-(et(o.left-u)<=d),a=(et(o.bottom-f)<=d)-(et(o.top-f)<=d)),r||a||(r=(p-u<=d)-(u<=d),a=(g-f<=d)-(f<=d),(r||a)&&(i=q)),j.vx===r&&j.vy===a&&j.el===i||(j.el=i,j.vx=r,j.vy=a,clearInterval(j.pid),i&&(j.pid=setInterval(function(){return l=a?a*h:0,s=r?r*h:0,"function"==typeof Y?Y.call(c,s,l,t):void(i===q?q.scrollTo(q.pageXOffset+s,q.pageYOffset+l):(i.scrollTop+=l,i.scrollLeft+=s))},24)))}},30),at=function(t){function e(t,e){return void 0!==t&&t!==!0||(t=n.name),"function"==typeof t?t:function(n,i){var o=i.options.group.name;return e?t:t&&(t.join?t.indexOf(o)>-1:o==t)}}var n={},i=t.group;i&&"object"==typeof i||(i={name:i}),n.name=i.name,n.checkPull=e(i.pull,!0),n.checkPut=e(i.put),n.revertClone=i.revertClone,t.group=n};t.prototype={constructor:t,_onTapStart:function(t){var e,i=this,o=this.el,r=this.options,a=r.preventOnFilter,s=t.type,l=t.touches&&t.touches[0],c=(l||t).target,h=t.target.shadowRoot&&t.path[0]||c,u=r.filter;if(y(o),!w&&!("mousedown"===s&&0!==t.button||r.disabled)&&(c=n(c,r.draggable,o),c&&N!==c)){if(e=v(c,r.draggable),"function"==typeof u){if(u.call(this,t,c,this))return d(i,h,"filter",c,o,e),void(a&&t.preventDefault())}else if(u&&(u=u.split(",").some(function(t){if(t=n(h,t.trim(),o))return d(i,t,"filter",c,o,e),!0})))return void(a&&t.preventDefault());r.handle&&!n(h,r.handle,o)||this._prepareDragStart(t,l,c,e)}},_prepareDragStart:function(t,e,n,i){var o,a=this,l=a.el,h=a.options,f=l.ownerDocument;n&&!w&&n.parentNode===l&&(L=t,E=l,w=n,T=w.parentNode,x=w.nextSibling,N=n,R=h.group,M=i,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,w.style["will-change"]="transform",o=function(){a._disableDelayedDrag(),w.draggable=a.nativeDraggable,s(w,h.chosenClass,!0),a._triggerDragStart(t,e),d(a,E,"choose",w,E,M)},h.ignore.split(",").forEach(function(t){c(w,t.trim(),u)}),r(f,"mouseup",a._onDrop),r(f,"touchend",a._onDrop),r(f,"touchcancel",a._onDrop),r(f,"pointercancel",a._onDrop),r(f,"selectstart",a),h.delay?(r(f,"mouseup",a._disableDelayedDrag),r(f,"touchend",a._disableDelayedDrag),r(f,"touchcancel",a._disableDelayedDrag),r(f,"mousemove",a._disableDelayedDrag),r(f,"touchmove",a._disableDelayedDrag),r(f,"pointermove",a._disableDelayedDrag),a._dragStartTimer=setTimeout(o,h.delay)):o())},_disableDelayedDrag:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),a(t,"mouseup",this._disableDelayedDrag),a(t,"touchend",this._disableDelayedDrag),a(t,"touchcancel",this._disableDelayedDrag),a(t,"mousemove",this._disableDelayedDrag),a(t,"touchmove",this._disableDelayedDrag),a(t,"pointermove",this._disableDelayedDrag)},_triggerDragStart:function(t,e){e=e||("touch"==t.pointerType?t:null),e?(L={target:w,clientX:e.clientX,clientY:e.clientY},this._onDragStart(L,"touch")):this.nativeDraggable?(r(w,"dragend",this),r(E,"dragstart",this._onDragStart)):this._onDragStart(L,!0);try{z.selection?setTimeout(function(){z.selection.empty()}):window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(){if(E&&w){var e=this.options;s(w,e.ghostClass,!0),s(w,e.dragClass,!1),t.active=this,d(this,E,"start",w,E,M)}else this._nulling()},_emulateDragOver:function(){if(F){if(this._lastX===F.clientX&&this._lastY===F.clientY)return;this._lastX=F.clientX,this._lastY=F.clientY,$||l(C,"display","none");var t=z.elementFromPoint(F.clientX,F.clientY),e=t,n=ot.length;if(e)do{if(e[V]){for(;n--;)ot[n]({clientX:F.clientX,clientY:F.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);$||l(C,"display","")}},_onTouchMove:function(e){if(L){var n=this.options,i=n.fallbackTolerance,o=n.fallbackOffset,r=e.touches?e.touches[0]:e,a=r.clientX-L.clientX+o.x,s=r.clientY-L.clientY+o.y,c=e.touches?"translate3d("+a+"px,"+s+"px,0)":"translate("+a+"px,"+s+"px)";if(!t.active){if(i&&nt(et(r.clientX-this._lastX),et(r.clientY-this._lastY))<i)return;this._dragStarted()}this._appendGhost(),U=!0,F=r,l(C,"webkitTransform",c),l(C,"mozTransform",c),l(C,"msTransform",c),l(C,"transform",c),e.preventDefault()}},_appendGhost:function(){if(!C){var t,e=w.getBoundingClientRect(),n=l(w),i=this.options;C=w.cloneNode(!0),s(C,i.ghostClass,!1),s(C,i.fallbackClass,!0),s(C,i.dragClass,!0),l(C,"top",e.top-G(n.marginTop,10)),l(C,"left",e.left-G(n.marginLeft,10)),l(C,"width",e.width),l(C,"height",e.height),l(C,"opacity","0.8"),l(C,"position","fixed"),l(C,"zIndex","100000"),l(C,"pointerEvents","none"),i.fallbackOnBody&&z.body.appendChild(C)||E.appendChild(C),t=C.getBoundingClientRect(),l(C,"width",2*e.width-t.width),l(C,"height",2*e.height-t.height)}},_onDragStart:function(t,e){var n=t.dataTransfer,i=this.options;this._offUpEvents(),R.checkPull(this,this,w,t)&&(S=D(w),S.draggable=!1,S.style["will-change"]="",l(S,"display","none"),s(S,this.options.chosenClass,!1),E.insertBefore(S,w),d(this,E,"clone",w)),s(w,i.dragClass,!0),e?("touch"===e?(r(z,"touchmove",this._onTouchMove),r(z,"touchend",this._onDrop),r(z,"touchcancel",this._onDrop),r(z,"pointermove",this._onTouchMove),r(z,"pointerup",this._onDrop)):(r(z,"mousemove",this._onTouchMove),r(z,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(n&&(n.effectAllowed="move",i.setData&&i.setData.call(this,n,w)),r(z,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(i){var o,r,a,s,c=this.el,d=this.options,u=d.group,g=t.active,v=R===u,m=!1,b=d.sort;if(void 0!==i.preventDefault&&(i.preventDefault(),!d.dragoverBubble&&i.stopPropagation()),!w.animated&&(U=!0,g&&!d.disabled&&(v?b||(s=!E.contains(w)):I===this||(g.lastPullMode=R.checkPull(this,g,w,i))&&u.checkPut(this,g,w,i))&&(void 0===i.rootEl||i.rootEl===this.el))){if(rt(i,d,this.el),tt)return;if(o=n(i.target,d.draggable,c),r=w.getBoundingClientRect(),I!==this&&(I=this,m=!0),s)return e(g,!0),T=E,void(S||x?E.insertBefore(w,S||x):b||E.appendChild(w));if(0===c.children.length||c.children[0]===C||c===i.target&&p(c,i)){if(0!==c.children.length&&c.children[0]!==C&&c===i.target&&(o=c.lastElementChild),o){if(o.animated)return;a=o.getBoundingClientRect()}e(g,v),h(E,c,w,r,o,a,i)!==!1&&(w.contains(c)||(c.appendChild(w),T=c),this._animate(r,w),o&&this._animate(a,o))}else if(o&&!o.animated&&o!==w&&void 0!==o.parentNode[V]){O!==o&&(O=o,X=l(o),A=l(o.parentNode)),a=o.getBoundingClientRect();var _=a.right-a.left,D=a.bottom-a.top,y=W.test(X.cssFloat+X.display)||"flex"==A.display&&0===A["flex-direction"].indexOf("row"),N=o.offsetWidth>w.offsetWidth,k=o.offsetHeight>w.offsetHeight,B=(y?(i.clientX-a.left)/_:(i.clientY-a.top)/D)>.5,Y=o.nextElementSibling,M=!1;if(y){var P=w.offsetTop,L=o.offsetTop;M=P===L?o.previousElementSibling===w&&!N||B&&N:o.previousElementSibling===w||w.previousElementSibling===o?(i.clientY-a.top)/D>.5:L>P}else m||(M=Y!==w&&!k||B&&k);var F=h(E,c,w,r,o,a,i,M);F!==!1&&(1!==F&&F!==-1||(M=1===F),tt=!0,setTimeout(f,30),e(g,v),w.contains(c)||(M&&!Y?c.appendChild(w):o.parentNode.insertBefore(w,M?Y:o)),T=w.parentNode,this._animate(r,w),this._animate(a,o))}}},_animate:function(t,e){var n=this.options.animation;if(n){var i=e.getBoundingClientRect();1===t.nodeType&&(t=t.getBoundingClientRect()),l(e,"transition","none"),l(e,"transform","translate3d("+(t.left-i.left)+"px,"+(t.top-i.top)+"px,0)"),e.offsetWidth,l(e,"transition","all "+n+"ms"),l(e,"transform","translate3d(0,0,0)"),clearTimeout(e.animated),e.animated=setTimeout(function(){l(e,"transition",""),l(e,"transform",""),e.animated=!1},n)}},_offUpEvents:function(){var t=this.el.ownerDocument;a(z,"touchmove",this._onTouchMove),a(z,"pointermove",this._onTouchMove),a(t,"mouseup",this._onDrop),a(t,"touchend",this._onDrop),a(t,"pointerup",this._onDrop),a(t,"touchcancel",this._onDrop),a(t,"pointercancel",this._onDrop),a(t,"selectstart",this)},_onDrop:function(e){var n=this.el,i=this.options;clearInterval(this._loopId),clearInterval(j.pid),clearTimeout(this._dragStartTimer),a(z,"mousemove",this._onTouchMove),this.nativeDraggable&&(a(z,"drop",this),a(n,"dragstart",this._onDragStart)),this._offUpEvents(),e&&(U&&(e.preventDefault(),!i.dropBubble&&e.stopPropagation()),C&&C.parentNode&&C.parentNode.removeChild(C),E!==T&&"clone"===t.active.lastPullMode||S&&S.parentNode&&S.parentNode.removeChild(S),w&&(this.nativeDraggable&&a(w,"dragend",this),u(w),w.style["will-change"]="",s(w,this.options.ghostClass,!1),s(w,this.options.chosenClass,!1),d(this,E,"unchoose",w,E,M),E!==T?(P=v(w,i.draggable),P>=0&&(d(null,T,"add",w,E,M,P),d(this,E,"remove",w,E,M,P),d(null,T,"sort",w,E,M,P),d(this,E,"sort",w,E,M,P))):w.nextSibling!==x&&(P=v(w,i.draggable),P>=0&&(d(this,E,"update",w,E,M,P),d(this,E,"sort",w,E,M,P))),t.active&&(null!=P&&P!==-1||(P=M),d(this,E,"end",w,E,M,P),this.save()))),this._nulling()},_nulling:function(){E=w=T=C=x=S=N=k=B=L=F=U=P=O=X=I=R=t.active=null,it.forEach(function(t){t.checked=!0}),it.length=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragover":case"dragenter":w&&(this._onDragOver(t),o(t));break;case"selectstart":t.preventDefault()}},toArray:function(){for(var t,e=[],i=this.el.children,o=0,r=i.length,a=this.options;o<r;o++)t=i[o],n(t,a.draggable,this.el)&&e.push(t.getAttribute(a.dataIdAttr)||g(t));return e},sort:function(t){var e={},i=this.el;this.toArray().forEach(function(t,o){var r=i.children[o];n(r,this.options.draggable,i)&&(e[t]=r)},this),t.forEach(function(t){e[t]&&(i.removeChild(e[t]),i.appendChild(e[t]))})},save:function(){var t=this.options.store;t&&t.set(this)},closest:function(t,e){return n(t,e||this.options.draggable,this.el)},option:function(t,e){var n=this.options;return void 0===e?n[t]:(n[t]=e,void("group"===t&&at(n)))},destroy:function(){var t=this.el;t[V]=null,a(t,"mousedown",this._onTapStart),a(t,"touchstart",this._onTapStart),a(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(a(t,"dragover",this),a(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),ot.splice(ot.indexOf(this._onDragOver),1),this._onDrop(),this.el=t=null}},r(z,"touchmove",function(e){t.active&&e.preventDefault()});try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){J={capture:!1,passive:!1}}}))}catch(st){}return t.utils={on:r,off:a,css:l,find:c,is:function(t,e){return!!n(t,e,t)},extend:_,throttle:b,closest:n,toggleClass:s,clone:D,index:v},t.create=function(e,n){return new t(e,n)},t.version="1.6.0",t});
!function(t,e){"function"==typeof define&&define.amd?define("bloodhound",["jquery"],function(n){return t.Bloodhound=e(n)}):"object"==typeof exports?module.exports=e(require("jquery")):t.Bloodhound=e(jQuery)}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){return!!(i=n.call(null,r,t,e))&&void 0}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){return!(i=n.call(null,r,t,e))&&void 0}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var s,o,u=this,a=arguments;return s=function(){i=null,n||(r=t.apply(u,a))},o=n&&!i,clearTimeout(i),i=setTimeout(s,e),o&&(r=t.apply(u,a)),r}},throttle:function(t,e){var n,i,r,s,o,u;return o=0,u=function(){o=new Date,r=null,s=t.apply(n,i)},function(){var a=new Date,c=e-(a-o);return n=this,i=arguments,0>=c?(clearTimeout(r),r=null,o=a,s=t.apply(n,i)):r||(r=setTimeout(u,c)),s}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n="0.11.1",i=function(){"use strict";function t(t){return t=e.toStr(t),t?t.split(/\s+/):[]}function n(t){return t=e.toStr(t),t?t.split(/\W+/):[]}function i(t){return function(n){return n=e.isArray(n)?n:[].slice.call(arguments,0),function(i){var r=[];return e.each(n,function(n){r=r.concat(t(e.toStr(i[n])))}),r}}}return{nonword:n,whitespace:t,obj:{nonword:i(n),whitespace:i(t)}}}(),r=function(){"use strict";function n(n){this.maxSize=e.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=t.noop)}function i(){this.head=this.tail=null}function r(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(n.prototype,{set:function(t,e){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key],this.size--),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new r(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];return e?(this.list.moveToFront(e),e.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new i}}),e.mixin(i.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),n}(),s=function(){"use strict";function n(t,n){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix)),this.ls=n||u,!this.ls&&this._noop()}function i(){return(new Date).getTime()}function r(t){return JSON.stringify(e.isUndefined(t)?null:t)}function s(e){return t.parseJSON(e)}function o(t){var e,n,i=[],r=u.length;for(e=0;r>e;e++)(n=u.key(e)).match(t)&&i.push(n.replace(t,""));return i}var u;try{u=window.localStorage,u.setItem("~~~","!"),u.removeItem("~~~")}catch(a){u=null}return e.mixin(n.prototype,{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=e.noop},_safeSet:function(t,e){try{this.ls.setItem(t,e)}catch(n){"QuotaExceededError"===n.name&&(this.clear(),this._noop())}},get:function(t){return this.isExpired(t)&&this.remove(t),s(this.ls.getItem(this._prefix(t)))},set:function(t,n,s){return e.isNumber(s)?this._safeSet(this._ttlKey(t),r(i()+s)):this.ls.removeItem(this._ttlKey(t)),this._safeSet(this._prefix(t),r(n))},remove:function(t){return this.ls.removeItem(this._ttlKey(t)),this.ls.removeItem(this._prefix(t)),this},clear:function(){var t,e=o(this.keyMatcher);for(t=e.length;t--;)this.remove(e[t]);return this},isExpired:function(t){var n=s(this.ls.getItem(this._ttlKey(t)));return!!(e.isNumber(n)&&i()>n)}}),n}(),o=function(){"use strict";function n(t){t=t||{},this.cancelled=!1,this.lastReq=null,this._send=t.transport,this._get=t.limiter?t.limiter(this._get):this._get,this._cache=t.cache===!1?new r(0):u}var i=0,s={},o=6,u=new r(10);return n.setMaxPendingRequests=function(t){o=t},n.resetCache=function(){u.reset()},e.mixin(n.prototype,{_fingerprint:function(e){return e=e||{},e.url+e.type+t.param(e.data||{})},_get:function(t,e){function n(t){e(null,t),h._cache.set(a,t)}function r(){e(!0)}function u(){i--,delete s[a],h.onDeckRequestArgs&&(h._get.apply(h,h.onDeckRequestArgs),h.onDeckRequestArgs=null)}var a,c,h=this;a=this._fingerprint(t),this.cancelled||a!==this.lastReq||((c=s[a])?c.done(n).fail(r):o>i?(i++,s[a]=this._send(t).done(n).fail(r).always(u)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(n,i){var r,s;i=i||t.noop,n=e.isString(n)?{url:n}:n||{},s=this._fingerprint(n),this.cancelled=!1,this.lastReq=s,(r=this._cache.get(s))?i(null,r):this._get(n,i)},cancel:function(){this.cancelled=!0}}),n}(),u=window.SearchIndex=function(){"use strict";function n(n){n=n||{},n.datumTokenizer&&n.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.identify=n.identify||e.stringify,this.datumTokenizer=n.datumTokenizer,this.queryTokenizer=n.queryTokenizer,this.reset()}function i(t){return t=e.filter(t,function(t){return!!t}),t=e.map(t,function(t){return t.toLowerCase()})}function r(){var t={};return t[a]=[],t[u]={},t}function s(t){for(var e={},n=[],i=0,r=t.length;r>i;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}function o(t,e){var n=0,i=0,r=[];t=t.sort(),e=e.sort();for(var s=t.length,o=e.length;s>n&&o>i;)t[n]<e[i]?n++:t[n]>e[i]?i++:(r.push(t[n]),n++,i++);return r}var u="c",a="i";return e.mixin(n.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var n=this;t=e.isArray(t)?t:[t],e.each(t,function(t){var s,o;n.datums[s=n.identify(t)]=t,o=i(n.datumTokenizer(t)),e.each(o,function(t){var e,i,o;for(e=n.trie,i=t.split("");o=i.shift();)e=e[u][o]||(e[u][o]=r()),e[a].push(s)})})},get:function(t){var n=this;return e.map(t,function(t){return n.datums[t]})},search:function(t){var n,r,c=this;return n=i(this.queryTokenizer(t)),e.each(n,function(t){var e,n,i,s;if(r&&0===r.length)return!1;for(e=c.trie,n=t.split("");e&&(i=n.shift());)e=e[u][i];return e&&0===n.length?(s=e[a].slice(0),void(r=r?o(r,s):s)):(r=[],!1)}),r?e.map(s(r),function(t){return c.datums[t]}):[]},all:function(){var t=[];for(var e in this.datums)t.push(this.datums[e]);return t},reset:function(){this.datums={},this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),a=function(){"use strict";function t(t){this.url=t.url,this.ttl=t.ttl,this.cache=t.cache,this.prepare=t.prepare,this.transform=t.transform,this.transport=t.transport,this.thumbprint=t.thumbprint,this.storage=new s(t.cacheKey)}var n;return n={data:"data",protocol:"protocol",thumbprint:"thumbprint"},e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(t){this.cache&&(this.storage.set(n.data,t,this.ttl),this.storage.set(n.protocol,location.protocol,this.ttl),this.storage.set(n.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var t,e={};return this.cache?(e.data=this.storage.get(n.data),e.protocol=this.storage.get(n.protocol),e.thumbprint=this.storage.get(n.thumbprint),t=e.thumbprint!==this.thumbprint||e.protocol!==location.protocol,e.data&&!t?e.data:null):null},fromNetwork:function(t){function e(){t(!0)}function n(e){t(null,r.transform(e))}var i,r=this;t&&(i=this.prepare(this._settings()),this.transport(i).fail(e).done(n))},clear:function(){return this.storage.clear(),this}}),t}(),c=function(){"use strict";function t(t){this.url=t.url,this.prepare=t.prepare,this.transform=t.transform,this.transport=new o({cache:t.cache,limiter:t.limiter,transport:t.transport})}return e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(t,e){function n(t,n){e(t?[]:r.transform(n))}var i,r=this;if(e)return t=t||"",i=this.prepare(t,this._settings()),this.transport.get(i,n)},cancelLastRequest:function(){this.transport.cancel()}}),t}(),h=function(){"use strict";function i(i){var r;return i?(r={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:e.identity,transform:e.identity,transport:null},i=e.isString(i)?{url:i}:i,i=e.mixin(r,i),!i.url&&t.error("prefetch requires url to be set"),i.transform=i.filter||i.transform,i.cacheKey=i.cacheKey||i.url,i.thumbprint=n+i.thumbprint,i.transport=i.transport?u(i.transport):t.ajax,i):null}function r(n){var i;if(n)return i={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:e.identity,transport:null},n=e.isString(n)?{url:n}:n,n=e.mixin(i,n),!n.url&&t.error("remote requires url to be set"),n.transform=n.filter||n.transform,n.prepare=s(n),n.limiter=o(n),n.transport=n.transport?u(n.transport):t.ajax,delete n.replace,delete n.wildcard,delete n.rateLimitBy,delete n.rateLimitWait,n}function s(t){function e(t,e){return e.url=s(e.url,t),e}function n(t,e){return e.url=e.url.replace(o,encodeURIComponent(t)),e}function i(t,e){return e}var r,s,o;return r=t.prepare,s=t.replace,o=t.wildcard,r?r:r=s?e:t.wildcard?n:i}function o(t){function n(t){return function(n){return e.debounce(n,t)}}function i(t){return function(n){return e.throttle(n,t)}}var r,s,o;return r=t.limiter,s=t.rateLimitBy,o=t.rateLimitWait,r||(r=/^throttle$/i.test(s)?i(o):n(o)),r}function u(n){return function(i){function r(t){e.defer(function(){o.resolve(t)})}function s(t){e.defer(function(){o.reject(t)})}var o=t.Deferred();return n(i,r,s),o}}return function(n){var s,o;return s={initialize:!0,identify:e.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,sorter:null,local:[],prefetch:null,remote:null},n=e.mixin(s,n||{}),!n.datumTokenizer&&t.error("datumTokenizer is required"),!n.queryTokenizer&&t.error("queryTokenizer is required"),o=n.sorter,n.sorter=o?function(t){return t.sort(o)}:e.identity,n.local=e.isFunction(n.local)?n.local():n.local,n.prefetch=i(n.prefetch),n.remote=r(n.remote),n}}(),l=function(){"use strict";function n(t){t=h(t),this.sorter=t.sorter,this.identify=t.identify,this.sufficient=t.sufficient,this.local=t.local,this.remote=t.remote?new c(t.remote):null,this.prefetch=t.prefetch?new a(t.prefetch):null,this.index=new u({identify:this.identify,datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),t.initialize!==!1&&this.initialize()}var r;return r=window&&window.Bloodhound,n.noConflict=function(){return window&&(window.Bloodhound=r),n},n.tokenizers=i,e.mixin(n.prototype,{__ttAdapter:function(){function t(t,e,i){return n.search(t,e,i)}function e(t,e){return n.search(t,e)}var n=this;return this.remote?t:e},_loadPrefetch:function(){function e(t,e){return t?n.reject():(r.add(e),r.prefetch.store(r.index.serialize()),void n.resolve())}var n,i,r=this;return n=t.Deferred(),this.prefetch?(i=this.prefetch.fromCache())?(this.index.bootstrap(i),n.resolve()):this.prefetch.fromNetwork(e):n.resolve(),n.promise()},_initialize:function(){function t(){e.add(e.local)}var e=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(t),this.initPromise},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){return this.index.add(t),this},get:function(t){return t=e.isArray(t)?t:[].slice.call(arguments),this.index.get(t)},search:function(t,n,i){function r(t){var n=[];e.each(t,function(t){!e.some(s,function(e){return o.identify(t)===o.identify(e)})&&n.push(t)}),i&&i(n)}var s,o=this;return s=this.sorter(this.index.search(t)),n(this.remote?s.slice():s),this.remote&&s.length<this.sufficient?this.remote.get(t,r):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return o.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),n}();return l}),function(t,e){"function"==typeof define&&define.amd?define("typeahead.js",["jquery"],function(t){return e(t)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){return!!(i=n.call(null,r,t,e))&&void 0}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){return!(i=n.call(null,r,t,e))&&void 0}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var s,o,u=this,a=arguments;return s=function(){i=null,n||(r=t.apply(u,a))},o=n&&!i,clearTimeout(i),i=setTimeout(s,e),o&&(r=t.apply(u,a)),r}},throttle:function(t,e){var n,i,r,s,o,u;return o=0,u=function(){o=new Date,r=null,s=t.apply(n,i)},function(){var a=new Date,c=e-(a-o);return n=this,i=arguments,0>=c?(clearTimeout(r),r=null,o=a,s=t.apply(n,i)):r||(r=setTimeout(u,c)),s}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n=function(){"use strict";function t(t){var o,u;return u=e.mixin({},s,t),o={css:r(),classes:u,html:n(u),selectors:i(u)},{css:o.css,html:o.html,classes:o.classes,selectors:o.selectors,mixin:function(t){e.mixin(t,o)}}}function n(t){return{wrapper:'<span class="'+t.wrapper+'"></span>',menu:'<div class="'+t.menu+'"></div>'}}function i(t){var n={};return e.each(t,function(t,e){n[e]="."+t}),n}function r(){var t={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return e.isMsie()&&e.mixin(t.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),t}var s={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return t}(),i=function(){"use strict";function n(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}var i,r;return i="typeahead:",r={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},e.mixin(n.prototype,{_trigger:function(e,n){var r;return r=t.Event(i+e),(n=n||[]).unshift(r),this.$el.trigger.apply(this.$el,n),r},before:function(t){var e,n;return e=[].slice.call(arguments,1),n=this._trigger("before"+t,e),n.isDefaultPrevented()},trigger:function(t){var e;this._trigger(t,[].slice.call(arguments,1)),(e=r[t])&&this._trigger(e,[].slice.call(arguments,1))}}),n}(),r=function(){"use strict";function t(t,e,n,i){var r;if(!n)return this;for(e=e.split(a),n=i?u(n,i):n,this._callbacks=this._callbacks||{};r=e.shift();)this._callbacks[r]=this._callbacks[r]||{sync:[],async:[]},this._callbacks[r][t].push(n);return this}function e(e,n,i){return t.call(this,"async",e,n,i)}function n(e,n,i){return t.call(this,"sync",e,n,i)}function i(t){var e;if(!this._callbacks)return this;for(t=t.split(a);e=t.shift();)delete this._callbacks[e];return this}function r(t){var e,n,i,r,o;if(!this._callbacks)return this;for(t=t.split(a),i=[].slice.call(arguments,1);(e=t.shift())&&(n=this._callbacks[e]);)r=s(n.sync,this,[e].concat(i)),o=s(n.async,this,[e].concat(i)),r()&&c(o);return this}function s(t,e,n){function i(){for(var i,r=0,s=t.length;!i&&s>r;r+=1)i=t[r].apply(e,n)===!1;return!i}return i}function o(){var t;return t=window.setImmediate?function(t){setImmediate(function(){t()})}:function(t){setTimeout(function(){t()},0)}}function u(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}var a=/\s+/,c=o();return{onSync:n,onAsync:e,off:i,trigger:r}}(),s=function(t){"use strict";function n(t,n,i){for(var r,s=[],o=0,u=t.length;u>o;o++)s.push(e.escapeRegExChars(t[o]));return r=i?"\\b("+s.join("|")+")\\b":"("+s.join("|")+")",n?new RegExp(r):new RegExp(r,"i")}var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(r){function s(e){var n,i,s;return(n=u.exec(e.data))&&(s=t.createElement(r.tagName),r.className&&(s.className=r.className),i=e.splitText(n.index),i.splitText(n[0].length),s.appendChild(i.cloneNode(!0)),e.parentNode.replaceChild(s,i)),!!n}function o(t,e){for(var n,i=3,r=0;r<t.childNodes.length;r++)n=t.childNodes[r],n.nodeType===i?r+=e(n)?1:0:o(n,e)}var u;r=e.mixin({},i,r),r.node&&r.pattern&&(r.pattern=e.isArray(r.pattern)?r.pattern:[r.pattern],u=n(r.pattern,r.caseSensitive,r.wordsOnly),o(r.node,s))}}(window.document),o=function(){"use strict";function n(n,r){n=n||{},n.input||t.error("input is missing"),r.mixin(this),this.$hint=t(n.hint),this.$input=t(n.input),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=i(this.$input),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=e.noop)}function i(e){return t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)}function s(t,e){return n.normalizeQuery(t)===n.normalizeQuery(e)}function o(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}var u;return u={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(t){return e.toStr(t).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},e.mixin(n.prototype,r,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function(t){var e=u[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(t,e){var n;switch(t){case"up":case"down":n=!o(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){var n;switch(t){case"tab":n=!o(e);break;default:n=!0}return n},_checkLanguageDirection:function(){var t=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==t&&(this.dir=t,this.$hint.attr("dir",t),this.trigger("langDirChanged",t))},_setQuery:function(t,e){var n,i;n=s(t,this.query),i=!!n&&this.query.length!==t.length,this.query=t,e||n?!e&&i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},bind:function(){var t,n,i,r,s=this;return t=e.bind(this._onBlur,this),n=e.bind(this._onFocus,this),i=e.bind(this._onKeydown,this),r=e.bind(this._onInput,this),this.$input.on("blur.tt",t).on("focus.tt",n).on("keydown.tt",i),!e.isMsie()||e.isMsie()>9?this.$input.on("input.tt",r):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){u[t.which||t.keyCode]||e.defer(e.bind(s._onInput,s,t))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(t,e){this.setInputValue(t),this._setQuery(t,e)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(t){this.$input.val(t),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,n,i;t=this.getInputValue(),e=this.getHint(),n=t!==e&&0===e.indexOf(t),i=""!==t&&n&&!this.hasOverflow(),!i&&this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,n,i;return t=this.$input.val().length,n=this.$input[0].selectionStart,e.isNumber(n)?n===t:!document.selection||(i=document.selection.createRange(),i.moveStart("character",-t),t===i.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=t("<div>")}}),n}(),u=function(){"use strict";function n(n,r){n=n||{},n.templates=n.templates||{},n.templates.notFound=n.templates.notFound||n.templates.empty,n.source||t.error("missing source"),n.node||t.error("missing node"),n.name&&!u(n.name)&&t.error("invalid dataset name: "+n.name),r.mixin(this),this.highlight=!!n.highlight,this.name=n.name||c(),this.limit=n.limit||5,this.displayFn=i(n.display||n.displayKey),this.templates=o(n.templates,this.displayFn),this.source=n.source.__ttAdapter?n.source.__ttAdapter():n.source,this.async=e.isUndefined(n.async)?this.source.length>2:!!n.async,this._resetLastSuggestion(),this.$el=t(n.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function i(t){function n(e){return e[t]}return t=t||e.stringify,e.isFunction(t)?t:n}function o(n,i){function r(e){return t("<div>").text(i(e))}return{notFound:n.notFound&&e.templatify(n.notFound),pending:n.pending&&e.templatify(n.pending),header:n.header&&e.templatify(n.header),footer:n.footer&&e.templatify(n.footer),suggestion:n.suggestion||r}}function u(t){return/^[_a-zA-Z0-9-]+$/.test(t)}var a,c;return a={val:"tt-selectable-display",obj:"tt-selectable-object"},c=e.getIdGenerator(),n.extractData=function(e){var n=t(e);return n.data(a.obj)?{val:n.data(a.val)||"",obj:n.data(a.obj)||null}:null},e.mixin(n.prototype,r,{_overwrite:function(t,e){e=e||[],e.length?this._renderSuggestions(t,e):this.async&&this.templates.pending?this._renderPending(t):!this.async&&this.templates.notFound?this._renderNotFound(t):this._empty(),this.trigger("rendered",this.name,e,!1)},_append:function(t,e){e=e||[],e.length&&this.$lastSuggestion.length?this._appendSuggestions(t,e):e.length?this._renderSuggestions(t,e):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(t),this.trigger("rendered",this.name,e,!0)},_renderSuggestions:function(t,e){var n;n=this._getSuggestionsFragment(t,e),this.$lastSuggestion=n.children().last(),this.$el.html(n).prepend(this._getHeader(t,e)).append(this._getFooter(t,e))},_appendSuggestions:function(t,e){var n,i;n=this._getSuggestionsFragment(t,e),i=n.children().last(),this.$lastSuggestion.after(n),this.$lastSuggestion=i},_renderPending:function(t){var e=this.templates.pending;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_renderNotFound:function(t){var e=this.templates.notFound;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(n,i){var r,o=this;return r=document.createDocumentFragment(),e.each(i,function(e){var i,s;s=o._injectQuery(n,e),i=t(o.templates.suggestion(s)).data(a.obj,e).data(a.val,o.displayFn(e)).addClass(o.classes.suggestion+" "+o.classes.selectable),r.appendChild(i[0])}),this.highlight&&s({className:this.classes.highlight,node:r,pattern:n}),t(r)},_getFooter:function(t,e){return this.templates.footer?this.templates.footer({query:t,suggestions:e,dataset:this.name}):null},_getHeader:function(t,e){return this.templates.header?this.templates.header({query:t,suggestions:e,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=t()},_injectQuery:function(t,n){return e.isObject(n)?e.mixin({_query:t},n):n},update:function(e){function n(t){o||(o=!0,t=(t||[]).slice(0,r.limit),u=t.length,r._overwrite(e,t),u<r.limit&&r.async&&r.trigger("asyncRequested",e))}function i(n){n=n||[],!s&&u<r.limit&&(r.cancel=t.noop,u+=n.length,r._append(e,n.slice(0,r.limit-u)),r.async&&r.trigger("asyncReceived",e))}var r=this,s=!1,o=!1,u=0;this.cancel(),this.cancel=function(){s=!0,r.cancel=t.noop,r.async&&r.trigger("asyncCanceled",e)},this.source(e,n,i),!o&&n([])},cancel:t.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=t("<div>")}}),n}(),a=function(){"use strict";function n(n,i){function r(e){var n=s.$node.find(e.node).first();return e.node=n.length?n:t("<div>").appendTo(s.$node),new u(e,i)}var s=this;n=n||{},n.node||t.error("node is required"),i.mixin(this),this.$node=t(n.node),this.query=null,this.datasets=e.map(n.datasets,r)}return e.mixin(n.prototype,r,{_onSelectableClick:function(e){this.trigger("selectableClicked",t(e.currentTarget))},_onRendered:function(t,e,n,i){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",e,n,i)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){function t(t){return t.isEmpty()}return e.every(this.datasets,t)},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var t=this.getActiveSelectable();t&&t.removeClass(this.classes.cursor)},_ensureVisible:function(t){var e,n,i,r;e=t.position().top,n=e+t.outerHeight(!0),i=this.$node.scrollTop(),r=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),0>e?this.$node.scrollTop(i+e):n>r&&this.$node.scrollTop(i+(n-r))},bind:function(){var t,n=this;return t=e.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,t),e.each(this.datasets,function(t){t.onSync("asyncRequested",n._propagate,n).onSync("asyncCanceled",n._propagate,n).onSync("asyncReceived",n._propagate,n).onSync("rendered",n._onRendered,n).onSync("cleared",n._onCleared,n)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(t){this.$node.attr("dir",t)},selectableRelativeToCursor:function(t){var e,n,i,r;return n=this.getActiveSelectable(),e=this._getSelectables(),i=n?e.index(n):-1,r=i+t,r=(r+1)%(e.length+1)-1,r=-1>r?e.length-1:r,-1===r?null:e.eq(r)},setCursor:function(t){this._removeCursor(),(t=t&&t.first())&&(t.addClass(this.classes.cursor),this._ensureVisible(t))},getSelectableData:function(t){return t&&t.length?u.extractData(t):null},getActiveSelectable:function(){var t=this._getSelectables().filter(this.selectors.cursor).first();return t.length?t:null},getTopSelectable:function(){var t=this._getSelectables().first();return t.length?t:null},update:function(t){function n(e){e.update(t)}var i=t!==this.query;return i&&(this.query=t,e.each(this.datasets,n)),i},empty:function(){function t(t){t.clear()}e.each(this.datasets,t),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){function n(t){t.destroy()}this.$node.off(".tt"),this.$node=t("<div>"),e.each(this.datasets,n)}}),n}(),c=function(){"use strict";function t(){a.apply(this,[].slice.call(arguments,0))}var n=a.prototype;return e.mixin(t.prototype,a.prototype,{open:function(){return!this._allDatasetsEmpty()&&this._show(),n.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),n.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(t){return this.$node.css("ltr"===t?this.css.ltr:this.css.rtl),n.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),t}(),h=function(){"use strict";function n(n,r){var s,o,u,a,c,h,l,f,d,p,g;n=n||{},n.input||t.error("missing input"),n.menu||t.error("missing menu"),n.eventBus||t.error("missing event bus"),r.mixin(this),this.eventBus=n.eventBus,this.minLength=e.isNumber(n.minLength)?n.minLength:1,this.input=n.input,this.menu=n.menu,this.enabled=!0,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),s=i(this,"activate","open","_onFocused"),o=i(this,"deactivate","_onBlurred"),u=i(this,"isActive","isOpen","_onEnterKeyed"),a=i(this,"isActive","isOpen","_onTabKeyed"),c=i(this,"isActive","_onEscKeyed"),h=i(this,"isActive","open","_onUpKeyed"),l=i(this,"isActive","open","_onDownKeyed"),f=i(this,"isActive","isOpen","_onLeftKeyed"),d=i(this,"isActive","isOpen","_onRightKeyed"),p=i(this,"_openIfActive","_onQueryChanged"),g=i(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",s,this).onSync("blurred",o,this).onSync("enterKeyed",u,this).onSync("tabKeyed",a,this).onSync("escKeyed",c,this).onSync("upKeyed",h,this).onSync("downKeyed",l,this).onSync("leftKeyed",f,this).onSync("rightKeyed",d,this).onSync("queryChanged",p,this).onSync("whitespaceChanged",g,this).onSync("langDirChanged",this._onLangDirChanged,this)}function i(t){var n=[].slice.call(arguments,1);return function(){var i=[].slice.call(arguments);e.each(n,function(e){return t[e].apply(t,i)})}}return e.mixin(n.prototype,{_hacks:function(){var n,i;n=this.input.$input||t("<div>"),
i=this.menu.$node||t("<div>"),n.on("blur.tt",function(t){var r,s,o;r=document.activeElement,s=i.is(r),o=i.has(r).length>0,e.isMsie()&&(s||o)&&(t.preventDefault(),t.stopImmediatePropagation(),e.defer(function(){n.focus()}))}),i.on("mousedown.tt",function(t){t.preventDefault()})},_onSelectableClicked:function(t,e){this.select(e)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(t,e,n,i){this._updateHint(),this.eventBus.trigger("render",n,i,e)},_onAsyncRequested:function(t,e,n){this.eventBus.trigger("asyncrequest",n,e)},_onAsyncCanceled:function(t,e,n){this.eventBus.trigger("asynccancel",n,e)},_onAsyncReceived:function(t,e,n){this.eventBus.trigger("asyncreceive",n,e)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())&&this.select(n)&&e.preventDefault()},_onTabKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())?this.select(n)&&e.preventDefault():(n=this.menu.getTopSelectable())&&this.autocomplete(n)&&e.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(t,e){this._minLengthMet(e)?this.menu.update(e):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(t,e){this.dir!==e&&(this.dir=e,this.menu.setLanguageDirection(e))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(t){return t=e.isString(t)?t:this.input.getQuery()||"",t.length>=this.minLength},_updateHint:function(){var t,n,i,r,s,u,a;t=this.menu.getTopSelectable(),n=this.menu.getSelectableData(t),i=this.input.getInputValue(),!n||e.isBlankString(i)||this.input.hasOverflow()?this.input.clearHint():(r=o.normalizeQuery(i),s=e.escapeRegExChars(r),u=new RegExp("^(?:"+s+")(.+$)","i"),a=u.exec(n.val),a&&this.input.setHint(i+a[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return!!this.isActive()||!(!this.isEnabled()||this.eventBus.before("active"))&&(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return!this.isActive()||!this.eventBus.before("idle")&&(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0)},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(t){this.input.setQuery(e.toStr(t))},getVal:function(){return this.input.getQuery()},select:function(t){var e=this.menu.getSelectableData(t);return!(!e||this.eventBus.before("select",e.obj))&&(this.input.setQuery(e.val,!0),this.eventBus.trigger("select",e.obj),this.close(),!0)},autocomplete:function(t){var e,n,i;return e=this.input.getQuery(),n=this.menu.getSelectableData(t),i=n&&e!==n.val,!(!i||this.eventBus.before("autocomplete",n.obj))&&(this.input.setQuery(n.val),this.eventBus.trigger("autocomplete",n.obj),!0)},moveCursor:function(t){var e,n,i,r,s;return e=this.input.getQuery(),n=this.menu.selectableRelativeToCursor(t),i=this.menu.getSelectableData(n),r=i?i.obj:null,s=this._minLengthMet()&&this.menu.update(e),!s&&!this.eventBus.before("cursorchange",r)&&(this.menu.setCursor(n),i?this.input.setInputValue(i.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",r),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),n}();!function(){"use strict";function r(e,n){e.each(function(){var e,i=t(this);(e=i.data(g.typeahead))&&n(e,i)})}function s(t,e){return t.clone().addClass(e.classes.hint).removeData().css(e.css.hint).css(l(t)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function u(t,e){t.data(g.attrs,{dir:t.attr("dir"),autocomplete:t.attr("autocomplete"),spellcheck:t.attr("spellcheck"),style:t.attr("style")}),t.addClass(e.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!t.attr("dir")&&t.attr("dir","auto")}catch(n){}return t}function l(t){return{backgroundAttachment:t.css("background-attachment"),backgroundClip:t.css("background-clip"),backgroundColor:t.css("background-color"),backgroundImage:t.css("background-image"),backgroundOrigin:t.css("background-origin"),backgroundPosition:t.css("background-position"),backgroundRepeat:t.css("background-repeat"),backgroundSize:t.css("background-size")}}function f(t){var n,i;n=t.data(g.www),i=t.parent().filter(n.selectors.wrapper),e.each(t.data(g.attrs),function(n,i){e.isUndefined(n)?t.removeAttr(i):t.attr(i,n)}),t.removeData(g.typeahead).removeData(g.www).removeData(g.attr).removeClass(n.classes.input),i.length&&(t.detach().insertAfter(i),i.remove())}function d(n){var i,r;return i=e.isJQuery(n)||e.isElement(n),r=i?t(n).first():[],r.length?r:null}var p,g,m;p=t.fn.typeahead,g={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},m={initialize:function(r,l){function f(){var n,f,m,y,v,_,b,w,S,x,A;e.each(l,function(t){t.highlight=!!r.highlight}),n=t(this),f=t(p.html.wrapper),m=d(r.hint),y=d(r.menu),v=r.hint!==!1&&!m,_=r.menu!==!1&&!y,v&&(m=s(n,p)),_&&(y=t(p.html.menu).css(p.css.menu)),m&&m.val(""),n=u(n,p),(v||_)&&(f.css(p.css.wrapper),n.css(v?p.css.input:p.css.inputWithNoHint),n.wrap(f).parent().prepend(v?m:null).append(_?y:null)),A=_?c:a,b=new i({el:n}),w=new o({hint:m,input:n},p),S=new A({node:y,datasets:l},p),x=new h({input:w,menu:S,eventBus:b,minLength:r.minLength},p),n.data(g.www,p),n.data(g.typeahead,x)}var p;return l=e.isArray(l)?l:[].slice.call(arguments,1),r=r||{},p=n(r.classNames),this.each(f)},isEnabled:function(){var t;return r(this.first(),function(e){t=e.isEnabled()}),t},enable:function(){return r(this,function(t){t.enable()}),this},disable:function(){return r(this,function(t){t.disable()}),this},isActive:function(){var t;return r(this.first(),function(e){t=e.isActive()}),t},activate:function(){return r(this,function(t){t.activate()}),this},deactivate:function(){return r(this,function(t){t.deactivate()}),this},isOpen:function(){var t;return r(this.first(),function(e){t=e.isOpen()}),t},open:function(){return r(this,function(t){t.open()}),this},close:function(){return r(this,function(t){t.close()}),this},select:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.select(i)}),n},autocomplete:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.autocomplete(i)}),n},moveCursor:function(t){var e=!1;return r(this.first(),function(n){e=n.moveCursor(t)}),e},val:function(t){var e;return arguments.length?(r(this,function(e){e.setVal(t)}),this):(r(this.first(),function(t){e=t.getVal()}),e)},destroy:function(){return r(this,function(t,e){f(e),t.destroy()}),this}},t.fn.typeahead=function(t){return m[t]?m[t].apply(this,[].slice.call(arguments,1)):m.initialize.apply(this,arguments)},t.fn.typeahead.noConflict=function(){return t.fn.typeahead=p,this}}()});
!function(){"use strict";function t(t){if(t)c[0]=c[16]=c[1]=c[2]=c[3]=c[4]=c[5]=c[6]=c[7]=c[8]=c[9]=c[10]=c[11]=c[12]=c[13]=c[14]=c[15]=0,this.blocks=c,this.buffer8=i;else if(n){var r=new ArrayBuffer(68);this.buffer8=new Uint8Array(r),this.blocks=new Uint32Array(r)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=0,this.finalized=this.hashed=!1,this.first=!0}var r="object"==typeof window?window:{},e=!r.JS_MD5_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;e&&(r=global);var i,h=!r.JS_MD5_NO_COMMON_JS&&"object"==typeof module&&module.exports,s="function"==typeof define&&define.amd,n=!r.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,f="0123456789abcdef".split(""),o=[128,32768,8388608,-2147483648],a=[0,8,16,24],u=["hex","array","digest","buffer","arrayBuffer"],c=[];if(n){var p=new ArrayBuffer(68);i=new Uint8Array(p),c=new Uint32Array(p)}var d=function(r){return function(e){return new t((!0)).update(e)[r]()}},y=function(){var r=d("hex");e&&(r=l(r)),r.create=function(){return new t},r.update=function(t){return r.create().update(t)};for(var i=0;i<u.length;++i){var h=u[i];r[h]=d(h)}return r},l=function(t){var r=require("crypto"),e=require("buffer").Buffer,i=function(i){if("string"==typeof i)return r.createHash("md5").update(i,"utf8").digest("hex");if(i.constructor===ArrayBuffer)i=new Uint8Array(i);else if(void 0===i.length)return t(i);return r.createHash("md5").update(new e(i)).digest("hex")};return i};t.prototype.update=function(t){if(!this.finalized){var e="string"!=typeof t;e&&t.constructor==r.ArrayBuffer&&(t=new Uint8Array(t));for(var i,h,s=0,f=t.length||0,o=this.blocks,u=this.buffer8;f>s;){if(this.hashed&&(this.hashed=!1,o[0]=o[16],o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),e)if(n)for(h=this.start;f>s&&64>h;++s)u[h++]=t[s];else for(h=this.start;f>s&&64>h;++s)o[h>>2]|=t[s]<<a[3&h++];else if(n)for(h=this.start;f>s&&64>h;++s)i=t.charCodeAt(s),128>i?u[h++]=i:2048>i?(u[h++]=192|i>>6,u[h++]=128|63&i):55296>i||i>=57344?(u[h++]=224|i>>12,u[h++]=128|i>>6&63,u[h++]=128|63&i):(i=65536+((1023&i)<<10|1023&t.charCodeAt(++s)),u[h++]=240|i>>18,u[h++]=128|i>>12&63,u[h++]=128|i>>6&63,u[h++]=128|63&i);else for(h=this.start;f>s&&64>h;++s)i=t.charCodeAt(s),128>i?o[h>>2]|=i<<a[3&h++]:2048>i?(o[h>>2]|=(192|i>>6)<<a[3&h++],o[h>>2]|=(128|63&i)<<a[3&h++]):55296>i||i>=57344?(o[h>>2]|=(224|i>>12)<<a[3&h++],o[h>>2]|=(128|i>>6&63)<<a[3&h++],o[h>>2]|=(128|63&i)<<a[3&h++]):(i=65536+((1023&i)<<10|1023&t.charCodeAt(++s)),o[h>>2]|=(240|i>>18)<<a[3&h++],o[h>>2]|=(128|i>>12&63)<<a[3&h++],o[h>>2]|=(128|i>>6&63)<<a[3&h++],o[h>>2]|=(128|63&i)<<a[3&h++]);this.lastByteIndex=h,this.bytes+=h-this.start,h>=64?(this.start=h-64,this.hash(),this.hashed=!0):this.start=h}return this}},t.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,r=this.lastByteIndex;t[r>>2]|=o[3&r],r>=56&&(this.hashed||this.hash(),t[0]=t[16],t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.bytes<<3,this.hash()}},t.prototype.hash=function(){var t,r,e,i,h,s,n=this.blocks;this.first?(t=n[0]-680876937,t=(t<<7|t>>>25)-271733879<<0,i=(-1732584194^2004318071&t)+n[1]-117830708,i=(i<<12|i>>>20)+t<<0,e=(-271733879^i&(-271733879^t))+n[2]-1126478375,e=(e<<17|e>>>15)+i<<0,r=(t^e&(i^t))+n[3]-1316259209,r=(r<<22|r>>>10)+e<<0):(t=this.h0,r=this.h1,e=this.h2,i=this.h3,t+=(i^r&(e^i))+n[0]-680876936,t=(t<<7|t>>>25)+r<<0,i+=(e^t&(r^e))+n[1]-389564586,i=(i<<12|i>>>20)+t<<0,e+=(r^i&(t^r))+n[2]+606105819,e=(e<<17|e>>>15)+i<<0,r+=(t^e&(i^t))+n[3]-1044525330,r=(r<<22|r>>>10)+e<<0),t+=(i^r&(e^i))+n[4]-176418897,t=(t<<7|t>>>25)+r<<0,i+=(e^t&(r^e))+n[5]+1200080426,i=(i<<12|i>>>20)+t<<0,e+=(r^i&(t^r))+n[6]-1473231341,e=(e<<17|e>>>15)+i<<0,r+=(t^e&(i^t))+n[7]-45705983,r=(r<<22|r>>>10)+e<<0,t+=(i^r&(e^i))+n[8]+1770035416,t=(t<<7|t>>>25)+r<<0,i+=(e^t&(r^e))+n[9]-1958414417,i=(i<<12|i>>>20)+t<<0,e+=(r^i&(t^r))+n[10]-42063,e=(e<<17|e>>>15)+i<<0,r+=(t^e&(i^t))+n[11]-1990404162,r=(r<<22|r>>>10)+e<<0,t+=(i^r&(e^i))+n[12]+1804603682,t=(t<<7|t>>>25)+r<<0,i+=(e^t&(r^e))+n[13]-40341101,i=(i<<12|i>>>20)+t<<0,e+=(r^i&(t^r))+n[14]-1502002290,e=(e<<17|e>>>15)+i<<0,r+=(t^e&(i^t))+n[15]+1236535329,r=(r<<22|r>>>10)+e<<0,t+=(e^i&(r^e))+n[1]-165796510,t=(t<<5|t>>>27)+r<<0,i+=(r^e&(t^r))+n[6]-1069501632,i=(i<<9|i>>>23)+t<<0,e+=(t^r&(i^t))+n[11]+643717713,e=(e<<14|e>>>18)+i<<0,r+=(i^t&(e^i))+n[0]-373897302,r=(r<<20|r>>>12)+e<<0,t+=(e^i&(r^e))+n[5]-701558691,t=(t<<5|t>>>27)+r<<0,i+=(r^e&(t^r))+n[10]+38016083,i=(i<<9|i>>>23)+t<<0,e+=(t^r&(i^t))+n[15]-660478335,e=(e<<14|e>>>18)+i<<0,r+=(i^t&(e^i))+n[4]-405537848,r=(r<<20|r>>>12)+e<<0,t+=(e^i&(r^e))+n[9]+568446438,t=(t<<5|t>>>27)+r<<0,i+=(r^e&(t^r))+n[14]-1019803690,i=(i<<9|i>>>23)+t<<0,e+=(t^r&(i^t))+n[3]-187363961,e=(e<<14|e>>>18)+i<<0,r+=(i^t&(e^i))+n[8]+1163531501,r=(r<<20|r>>>12)+e<<0,t+=(e^i&(r^e))+n[13]-1444681467,t=(t<<5|t>>>27)+r<<0,i+=(r^e&(t^r))+n[2]-51403784,i=(i<<9|i>>>23)+t<<0,e+=(t^r&(i^t))+n[7]+1735328473,e=(e<<14|e>>>18)+i<<0,r+=(i^t&(e^i))+n[12]-1926607734,r=(r<<20|r>>>12)+e<<0,h=r^e,t+=(h^i)+n[5]-378558,t=(t<<4|t>>>28)+r<<0,i+=(h^t)+n[8]-2022574463,i=(i<<11|i>>>21)+t<<0,s=i^t,e+=(s^r)+n[11]+1839030562,e=(e<<16|e>>>16)+i<<0,r+=(s^e)+n[14]-35309556,r=(r<<23|r>>>9)+e<<0,h=r^e,t+=(h^i)+n[1]-1530992060,t=(t<<4|t>>>28)+r<<0,i+=(h^t)+n[4]+1272893353,i=(i<<11|i>>>21)+t<<0,s=i^t,e+=(s^r)+n[7]-155497632,e=(e<<16|e>>>16)+i<<0,r+=(s^e)+n[10]-1094730640,r=(r<<23|r>>>9)+e<<0,h=r^e,t+=(h^i)+n[13]+681279174,t=(t<<4|t>>>28)+r<<0,i+=(h^t)+n[0]-358537222,i=(i<<11|i>>>21)+t<<0,s=i^t,e+=(s^r)+n[3]-722521979,e=(e<<16|e>>>16)+i<<0,r+=(s^e)+n[6]+76029189,r=(r<<23|r>>>9)+e<<0,h=r^e,t+=(h^i)+n[9]-640364487,t=(t<<4|t>>>28)+r<<0,i+=(h^t)+n[12]-421815835,i=(i<<11|i>>>21)+t<<0,s=i^t,e+=(s^r)+n[15]+530742520,e=(e<<16|e>>>16)+i<<0,r+=(s^e)+n[2]-995338651,r=(r<<23|r>>>9)+e<<0,t+=(e^(r|~i))+n[0]-198630844,t=(t<<6|t>>>26)+r<<0,i+=(r^(t|~e))+n[7]+1126891415,i=(i<<10|i>>>22)+t<<0,e+=(t^(i|~r))+n[14]-1416354905,e=(e<<15|e>>>17)+i<<0,r+=(i^(e|~t))+n[5]-57434055,r=(r<<21|r>>>11)+e<<0,t+=(e^(r|~i))+n[12]+1700485571,t=(t<<6|t>>>26)+r<<0,i+=(r^(t|~e))+n[3]-1894986606,i=(i<<10|i>>>22)+t<<0,e+=(t^(i|~r))+n[10]-1051523,e=(e<<15|e>>>17)+i<<0,r+=(i^(e|~t))+n[1]-2054922799,r=(r<<21|r>>>11)+e<<0,t+=(e^(r|~i))+n[8]+1873313359,t=(t<<6|t>>>26)+r<<0,i+=(r^(t|~e))+n[15]-30611744,i=(i<<10|i>>>22)+t<<0,e+=(t^(i|~r))+n[6]-1560198380,e=(e<<15|e>>>17)+i<<0,r+=(i^(e|~t))+n[13]+1309151649,r=(r<<21|r>>>11)+e<<0,t+=(e^(r|~i))+n[4]-145523070,t=(t<<6|t>>>26)+r<<0,i+=(r^(t|~e))+n[11]-1120210379,i=(i<<10|i>>>22)+t<<0,e+=(t^(i|~r))+n[2]+718787259,e=(e<<15|e>>>17)+i<<0,r+=(i^(e|~t))+n[9]-343485551,r=(r<<21|r>>>11)+e<<0,this.first?(this.h0=t+1732584193<<0,this.h1=r-271733879<<0,this.h2=e-1732584194<<0,this.h3=i+271733878<<0,this.first=!1):(this.h0=this.h0+t<<0,this.h1=this.h1+r<<0,this.h2=this.h2+e<<0,this.h3=this.h3+i<<0)},t.prototype.hex=function(){this.finalize();var t=this.h0,r=this.h1,e=this.h2,i=this.h3;return f[t>>4&15]+f[15&t]+f[t>>12&15]+f[t>>8&15]+f[t>>20&15]+f[t>>16&15]+f[t>>28&15]+f[t>>24&15]+f[r>>4&15]+f[15&r]+f[r>>12&15]+f[r>>8&15]+f[r>>20&15]+f[r>>16&15]+f[r>>28&15]+f[r>>24&15]+f[e>>4&15]+f[15&e]+f[e>>12&15]+f[e>>8&15]+f[e>>20&15]+f[e>>16&15]+f[e>>28&15]+f[e>>24&15]+f[i>>4&15]+f[15&i]+f[i>>12&15]+f[i>>8&15]+f[i>>20&15]+f[i>>16&15]+f[i>>28&15]+f[i>>24&15]},t.prototype.toString=t.prototype.hex,t.prototype.digest=function(){this.finalize();var t=this.h0,r=this.h1,e=this.h2,i=this.h3;return[255&t,t>>8&255,t>>16&255,t>>24&255,255&r,r>>8&255,r>>16&255,r>>24&255,255&e,e>>8&255,e>>16&255,e>>24&255,255&i,i>>8&255,i>>16&255,i>>24&255]},t.prototype.array=t.prototype.digest,t.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(16),r=new Uint32Array(t);return r[0]=this.h0,r[1]=this.h1,r[2]=this.h2,r[3]=this.h3,t},t.prototype.buffer=t.prototype.arrayBuffer;var b=y();h?module.exports=b:(r.md5=b,s&&define(function(){return b}))}();